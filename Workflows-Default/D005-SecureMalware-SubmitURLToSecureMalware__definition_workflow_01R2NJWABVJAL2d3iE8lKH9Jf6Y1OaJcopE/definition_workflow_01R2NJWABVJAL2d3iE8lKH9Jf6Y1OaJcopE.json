{
  "workflow": {
    "unique_name": "definition_workflow_01R2NJWABVJAL2d3iE8lKH9Jf6Y1OaJcopE",
    "name": "Submit URL to Secure Malware Analytics",
    "title": "Submit URL to Secure Malware Analytics",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_type",
          "type": "datatype.string",
          "description": "The type of observable pivoted on",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01R2NJWAGNOCH1Ua6o36M5gVeO7IA5gs5Wc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_value",
          "type": "datatype.string",
          "description": "The value of the observable pivoted on",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01R2NJWAGNDQG3RfVaKOImSXxg7ZkhGA0bT",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "*****",
          "scope": "local",
          "name": "Secure Malware Analytics API Key",
          "type": "datatype.secure_string",
          "description": "The API key to use with Secure Malware Analytics. You can either set this here (and remove this variable from the Fetch Global Variables activity) or you can use the Fetch Global Variables activity to update this variable with an existing API key from a global variable",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01R2NJWAGNW5I7ZpgVZv5nGbsDxHNXMiepP",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow submits a URL to Cisco Secure Malware Analytics for analysis. Supported observable: url\n\nTarget Group: Default TargetGroup\n\nTargets: ThreatGrid_Target\n\nSteps:\n[] Make sure the observable is supported\n[] Submit the URL to Secure Malware Analytics\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/oob-05",
      "display_name": "Submit URL to Secure Malware Analytics",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "ThreatGrid_Target"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01R2NJWELFRAJ0FuQA5qyQzzgSKSIKecyGW",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch global variables",
          "skip_execution": true
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01R2NJWFGW1QX7FNLdXDbv2GCeBtqD9vrEr",
            "name": "Set Variables",
            "title": "Fetch global variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch global variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01R2NJWABVJAL2d3iE8lKH9Jf6Y1OaJcopE.local.variable_workflow_01R2NJWAGNW5I7ZpgVZv5nGbsDxHNXMiepP$"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01R2NJWG750XW401M1mbyUhkfU9MxcYutXE",
        "name": "Condition Block",
        "title": "Is the observable a URL?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Is the observable a URL?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01R2NJWGW8Q0D7UNpPOxjmYKiXNSwPPjvKI",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01R2NJWABVJAL2d3iE8lKH9Jf6Y1OaJcopE.input.variable_workflow_01R2NJWAGNOCH1Ua6o36M5gVeO7IA5gs5Wc$",
                "operator": "ne",
                "right_operand": "url"
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01R2NJWHNCD8K5Ly1HNoG0HBJtn9xQ6lwrl",
                "name": "Completed",
                "title": "Unsupported observable",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Unsupported observable",
                  "result_message": "This workflow does not support the observable type \"$workflow.definition_workflow_01R2NJWABVJAL2d3iE8lKH9Jf6Y1OaJcopE.input.variable_workflow_01R2NJWAGNOCH1Ua6o36M5gVeO7IA5gs5Wc$\"",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01R2NJWIW8SE40MmQUAHCLzfbAhKxBLjGZu",
        "name": "Secure Malware Analytics - Submit URL",
        "title": "Secure Malware Analytics - Submit URL",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Secure Malware Analytics - Submit URL",
          "input": {
            "variable_workflow_01PP78YVQL5PH0SroKbcStsP8tTzMD4VVxO": "securex",
            "variable_workflow_01PP78YVQLACW627A2oTA7Br1nBYufQEtkY": false,
            "variable_workflow_01PP78YVQLC4K2DLxGE2PQLKh5QPubd4lhW": "",
            "variable_workflow_01PP78YVQLDRB0ldfcZbpgUj4Uhw0RdwWzq": 5,
            "variable_workflow_01PP78YVQLINT4UiRyREjj9EqUiD4v7n5fu": true,
            "variable_workflow_01PP78YVQLK1045YAHrQBaZWCQHmH1uwzwX": "$workflow.definition_workflow_01R2NJWABVJAL2d3iE8lKH9Jf6Y1OaJcopE.input.variable_workflow_01R2NJWAGNDQG3RfVaKOImSXxg7ZkhGA0bT$",
            "variable_workflow_01PP78YVQLL6W2OruzCBYvANFECP22jB7YD": "default",
            "variable_workflow_01PP78YVQLMCJ2cxzg6yVKC2i3ZMIsEHFeL": "$workflow.definition_workflow_01R2NJWABVJAL2d3iE8lKH9Jf6Y1OaJcopE.local.variable_workflow_01R2NJWAGNW5I7ZpgVZv5nGbsDxHNXMiepP$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target_group": true
          },
          "workflow_id": "definition_workflow_01PP78YVWMXKI3jcrOGYocGMM3VaophGkkJ"
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
    ]
  },
  "categories": {
    "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
      "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "name": "response",
      "title": "response",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01PP78YVWMXKI3jcrOGYocGMM3VaophGkkJ"
  ]
}