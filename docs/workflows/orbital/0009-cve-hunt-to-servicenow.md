---
layout: page
title: CVE Hunt to ServiceNow Incident
permalink: /workflows/orbital/0009-cve-hunt-to-servicenow
redirect_from:
  - /workflows/0009-orbital-cve-servicenow
parent: Cisco Orbital
grand_parent: Workflows
---

# CVE Hunt to ServiceNow Incident
<div markdown="1">
Workflow #0009
{: .label }
</div>

This workflow uses Orbital to look for endpoints that are vulnerable for a given CVE. For demonstration purposes we use CVE-2020-0796 which has been added to Orbital as a catalog query. After the Orbital query is executed, we open a ServiceNow incident with the results.

[<i class="fa fa-video mr-1"></i> Overview](https://www.youtube.com/watch?v=OwGHPqG8h80&list=PLPFIie48Myg2tu2gHbgm-moYg8LDaXsSo&index=8){: .btn-cisco-outline .mr-2 } [<i class="fab fa-github mr-1"></i> GitHub]({{ site.github.repository_url }}/tree/Main/Workflows/0009-Orbital-CVEHuntToServiceNowIncident__definition_workflow_01FXZ5AS5EEEA4hWgDA7aGE0rSKFmygtRNc){: .btn-cisco-outline .mr-2 }

---

## Requirements
* The following atomic actions must be imported before you can import this workflow:
	* CTRGenerateAccessToken ([Github_Target_Atomics]({{ site.baseurl }}/default-repos))
	* Orbital - Query All Endpoints ([Github_Target_Atomics]({{ site.baseurl }}/default-repos))
	* ServiceNow - Create Incident ([Github_Target_Atomics]({{ site.baseurl }}/default-repos))
* Endpoints running AMP for Endpoints with Orbital enabled
* A ServiceNow instance and API account

---

## Workflow Steps
1. Get an API token for Orbital
1. Execute a catalog query for all endpoints using Orbital
1. Fetch the results of the Orbital query
1. Iterate through each result and build a table of vulnerable/not-vulnerable endpoints
1. Assemble the text for the ServiceNow incident
1. Create the ServiceNow incident ticket

---

## Configuration
* If you want the workflow to run on a schedule, you need to create a [schedule]({{ site.baseurl }}/schedules) and then add it as a [trigger]({{ site.baseurl }}/workflows/triggers) within the workflow
* Update the `ServiceNow User ID` local variable with the username you want incidents opened as. This can either match the username in your ServiceNow **Account Key** or, if the account has the appropriate permissions, can be a different user
* Update the `ServiceNow - Create Incident` activity towards the end of the workflow with any changes to the ticket properties you want

---

## Targets
Target Group: `Default TargetGroup`

| Target Name | Type | Details | Account Keys | Notes |
|:------------|:-----|:--------|:-------------|:------|
| [Orbital_For_Access_Token]({{ site.baseurl }}/targets/default#orbital_for_access_token) | HTTP Endpoint | _Protocol:_ `HTTPS`<br />_Host:_ `visibility.amp.cisco.com`<br />_Path:_ `/iroh` | Orbital_Credentials | Created by default |
| [Orbital_Target]({{ site.baseurl }}/targets/default#orbital_target) | HTTP Endpoint | _Protocol:_ `HTTPS`<br />_Host:_ `orbital.amp.cisco.com`<br />_Path:_ `/v0` | None | Created by default |
| ServiceNow | HTTP Endpoint | _Protocol:_ `HTTPS`<br />_Host:_ `<instance>.service-now.com`<br />_Path:_ `/api` | ServiceNow_Credentials | Be sure to use your instance URL |

---

## Account Keys

| Account Key Name | Type | Details | Notes |
|:-----------------|:-----|:--------|:------|
| [Orbital_Credentials]({{ site.baseurl }}/account-keys/default#orbital_credentials) | HTTP Basic Authentication | _Username:_ Client ID<br />_Password:_ Client Secret | Created by default |
| ServiceNow_Credentials | HTTP Basic Authentication | _Username:_ ServiceNow User ID<br />_Password:_ ServiceNow Password | |
