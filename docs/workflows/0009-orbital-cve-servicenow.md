---
layout: page
title: Orbital - CVE Hunt to ServiceNow Incident
permalink: /workflows/0009-orbital-cve-servicenow
parent: Workflows
---

# Orbital - CVE Hunt to ServiceNow Incident
<div markdown="1">
Workflow #0009
{: .label }
</div>

This workflow uses Orbital to look for endpoints that are vulnerable for a given CVE. For demonstration purposes we use CVE-2020-0796 which has been added to Orbital as a catalog query. After the Orbital query is executed, we open a ServiceNow incident with the results.

[Workflow Folder]({{ site.github.repository_url }}/tree/Main/Workflows/0009-Orbital-CVEHuntToServiceNowIncident__definition_workflow_01FXZ5AS5EEEA4hWgDA7aGE0rSKFmygtRNc){: .btn .btn-blue .mr-2 } [JSON]({{ site.github.repository_url }}/tree/Main/Workflows/0009-Orbital-CVEHuntToServiceNowIncident__definition_workflow_01FXZ5AS5EEEA4hWgDA7aGE0rSKFmygtRNc/definition_workflow_01FXZ5AS5EEEA4hWgDA7aGE0rSKFmygtRNc.json){: .btn .btn-blue }

---

## Requirements
* Endpoints running AMP for Endpoints with Orbital
* A ServiceNow instance

---

## Workflow Steps
1. Get an API token for Orbital
1. Execute a catalog query for all endpoints using Orbital
1. Fetch the results of the Orbital query
1. Iterate through each result and build a table of vulnerable/not-vulnerable endpoints
1. Assemble the text for the ServiceNow incident
1. Create the ServiceNow incident ticket

---

## Configuration
* If you want the workflow to run on a schedule, you need to create a **Schedule** and then add it as a **Trigger** within the workflow
* Update the `ServiceNow - Create Incident` activity with the `ServiceNow User ID` you want the incident opened as

---

## Targets
Target Group: `Default TargetGroup`

| Target Name | Type | Details | Account Keys | Notes |
|:------------|:-----|:--------|:-------------|:------|
| Orbital_For_Access_Token | HTTP Endpoint | _Protocol:_ `HTTPS`<br />_Host:_ `visibility.amp.cisco.com`<br />_Path:_ `/iroh` | Orbital_Credentials | Created by default |
| Orbital_Target | HTTP Endpoint | _Protocol:_ `HTTPS`<br />_Host:_ `orbital.amp.cisco.com`<br />_Path:_ `/v0` | None | Created by default |
| ServiceNow | HTTP Endpoint | _Protocol:_ `HTTPS`<br />_Host:_ `<instance>.service-now.com`<br />_Path:_ `/api` | ServiceNow_Credentials | Be sure to use your instance URL |

---

## Account Keys

| Account Key Name | Type | Details | Notes |
|:-----------------|:-----|:--------|:------|
| Orbital_Credentials | HTTP Basic Authentication | _Username:_ Client ID<br />_Password:_ Client Secret | Created by default |
| ServiceNow_Credentials | HTTP Basic Authentication | _Username:_ ServiceNow User ID<br />_Password:_ ServiceNow Password | |
