{
    "workflow": {
        "unique_name": "definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J",
        "name": "0052 - Fortinet - FortiGate - Request Threat Containment",
        "title": "0052 - Fortinet - FortiGate - Request Threat Containment",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "input",
                    "name": "observable_type",
                    "type": "datatype.string",
                    "description": "The type of observable pivoted on",
                    "is_required": true,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01S6BK8PJICEO1Sw0YZtdaQjtmobwyW8Tu9",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Policy Name",
                    "type": "datatype.string",
                    "description": "Name of the firewall policy to add objects to",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.secure_string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Access Token",
                    "type": "datatype.secure_string",
                    "description": "Access token for the FortiGate API. This can be generated by creating a new REST API Admin under System > Administrators",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Destination Address Name",
                    "type": "datatype.string",
                    "description": "Name to use for the destination address object. This will be populated automatically",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Service Name",
                    "type": "datatype.string",
                    "description": "Name to use for the service object. This will be populated automatically",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Destination Address Group Name",
                    "type": "datatype.string",
                    "description": "Name of the address group to add the rule's destination objects to",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Source Address Name",
                    "type": "datatype.string",
                    "description": "Name to use for the source address object. This will be populated automatically",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "SXo",
                    "scope": "local",
                    "name": "Name Prefix",
                    "type": "datatype.string",
                    "description": "A prefix that will be added to the address objects created by this workflow",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Source Address Group Name",
                    "type": "datatype.string",
                    "description": "Name of the address group to add the rule's source objects to",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "input",
                    "name": "observable_value",
                    "type": "datatype.string",
                    "description": "The value of the observable pivoted on",
                    "is_required": true,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01S6BKDUZAOOA57IxSfv5jb9bQXWEkREkVR",
                "object_type": "variable_workflow"
            },
            {
                "schema_id": "datatype.string",
                "properties": {
                    "value": "",
                    "scope": "local",
                    "name": "Service Group Name",
                    "type": "datatype.string",
                    "description": "Name of the service object group to add the rule's service objects to",
                    "is_required": false,
                    "is_invisible": false
                },
                "unique_name": "variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO",
                "object_type": "variable_workflow"
            }
        ],
        "properties": {
            "atomic": {
                "is_atomic": false
            },
            "delete_workflow_instance": false,
            "description": "This workflow is designed to be triggered by ServiceNow in response to a new Firewall Rule Task. When triggered, it gets data from ServiceNow which is used to update rules in Fortinet FortiGate. If an address or service object for the given input is not found, new objects are created.\n\nNote: You may need to use a SecureX orchestration remote to communicate with FortiGate if it's on-premises. See: https:\/\/cs.co\/SXO_remote\n\nDocumentation: https:\/\/ciscosecurity.github.io\/sxo-05-security-workflows\/workflows\/0052\n\nTarget Group: Default TargetGroup\n\nTargets: Fortinet FortiGate, ServiceNow",
            "display_name": "0052 - Fortinet - FortiGate - Request Threat Containment",
            "runtime_user": {
                "target_default": true
            },
            "target": {
                "execute_on_target_group": true,
                "target_group": {
                    "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
                    "run_on_all_targets": false,
                    "selected_target_types": [
                        "web-service.endpoint"
                    ],
                    "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                            {
                                "operator": "eqi",
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "right_operand": "Fortinet FortiGate"
                            }
                        ]
                    }
                }
            }
        },
        "object_type": "definition_workflow",
        "actions": [
            {
                "unique_name": "definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827",
                "name": "Execute Python Script",
                "title": "Parse input data",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                    "action_timeout": 180,
                    "continue_on_failure": false,
                    "display_name": "Parse input data",
                    "script": "import json\nimport sys\n\ndef read_possible_range_value(value):\n    value = [part.strip() for part in value.split('-')]\n    return '-'.join(value)\n\ndef read_protocol(protocol):\n    assert protocol in ('tcp', 'udp')\n    return protocol\n\ndef read_action(action):\n    action_mapping = {'allow': 'accept', 'block': 'deny'}\n    return action_mapping[action.lower()]\n#\ninput_data = json.loads(sys.argv[1])\ndestination_address = None\ndestination_address_type = None\nsource_address = None\ndestination_service = None\nprotocol = None\naction = None\nsn_task_id = None\nerror = None\nerror_mapping = {\n    KeyError: 'Input Data Error. Input JSON is not valid.',\n    AttributeError: \"Input Data Error. Destination port (port range) can't be empty.\",\n    AssertionError: \"Input Data Error. The protocol has to be one of TCP or UDP.\"\n}\ntry:\n    sn_task_id = input_data[\"ServiceNow Task ID\"]\n    destination_address = read_possible_range_value(input_data[\"Destination Host IP\"])\n    source_address = read_possible_range_value(input_data[\"Source Host IP\"])\n    destination_service = read_possible_range_value(input_data[\"Destination Port\"])\n    protocol = read_protocol(input_data[\"Protocol\"].lower())\n    action = read_action(input_data[\"Access Action\"])\nexcept tuple(error_mapping) as exception:\n    error = error_mapping[exception.__class__]",
                    "script_arguments": [
                        "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.input.variable_workflow_01S6BKDUZAOOA57IxSfv5jb9bQXWEkREkVR$"
                    ],
                    "script_queries": [
                        {
                            "script_query": "destination_address",
                            "script_query_name": "Destination Address",
                            "script_query_type": "string"
                        },
                        {
                            "script_query": "source_address",
                            "script_query_name": "Source Address",
                            "script_query_type": "string"
                        },
                        {
                            "script_query": "destination_service",
                            "script_query_name": "Destination Service",
                            "script_query_type": "string"
                        },
                        {
                            "script_query": "protocol",
                            "script_query_name": "Protocol",
                            "script_query_type": "string"
                        },
                        {
                            "script_query": "sn_task_id",
                            "script_query_name": "ServiceNow Task ID",
                            "script_query_type": "string"
                        },
                        {
                            "script_query": "action",
                            "script_query_name": "Action",
                            "script_query_type": "string"
                        },
                        {
                            "script_query": "error",
                            "script_query_name": "Error",
                            "script_query_type": "string"
                        }
                    ],
                    "skip_execution": false
                },
                "object_type": "definition_activity"
            },
            {
                "unique_name": "definition_activity_01SBJA5P5PVTH4udV0aPb4n5u3Y0gp9555f",
                "name": "Condition Block",
                "title": "Was the input data valid?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "Was the input data valid?",
                    "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                    {
                        "unique_name": "definition_activity_01SBJA5P5R7H03ssL4sm0b6oCdfiLEdHYUG",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Error$",
                                "operator": "ne",
                                "right_operand": "None"
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SBJA5P5VU9W0zXdEUTzHWVOjWQTLjINqG",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request:\n$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Error$",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                    },
                                    "runtime_user": {
                                        "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                            "run_on_all_targets": false,
                                            "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                    {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ServiceNow"
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SBJA5P5XNQS1YSna58lXqwSkBhcCEKgNd",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                    "completion_type": "failed-completed",
                                    "continue_on_failure": false,
                                    "display_name": "Failed",
                                    "result_message": "Failed to process Threat Containment Request:\n$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Error$",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity"
                            }
                        ]
                    }
                ]
            },
            {
                "unique_name": "definition_activity_01SPDKYM8L6VP0DwXUrehKwVYefF4t1Ovcf",
                "name": "Condition Block",
                "title": "Were the required object names provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "Were the required object names provided?",
                    "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                    {
                        "unique_name": "definition_activity_01SPDKYMT1I276w7vg6Bya8Cin96nQWJdNX",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": {
                                    "left_operand": {
                                        "left_operand": {
                                            "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                                            "operator": "eq",
                                            "right_operand": ""
                                        },
                                        "operator": "or",
                                        "right_operand": {
                                            "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                                            "operator": "eq",
                                            "right_operand": ""
                                        }
                                    },
                                    "operator": "or",
                                    "right_operand": {
                                        "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$",
                                        "operator": "eq",
                                        "right_operand": ""
                                    }
                                },
                                "operator": "or",
                                "right_operand": {
                                    "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                                    "operator": "eq",
                                    "right_operand": ""
                                }
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SPDLSQM4AJS68lNoeYtwcVMQyey2yjhTs",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. One or more required object names was missing. Please verify the following variables are provided:\n- Destination Address Group Name\n- Source Address Group Name\n- Service Group Name\n- Firewall Policy Name",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                    },
                                    "runtime_user": {
                                        "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                            "run_on_all_targets": false,
                                            "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                    {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ServiceNow"
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SPDLV84A0XT4sVTD2RjKL7ppiwQEzUWyy",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                    "completion_type": "failed-completed",
                                    "continue_on_failure": false,
                                    "display_name": "Failed",
                                    "result_message": "SecureX orchestration failed to process the threat containment request. One or more required object names was missing. Please verify the following variables are provided:\n- Destination Address Group Name\n- Source Address Group Name\n- Service Group Name\n- Firewall Policy Name",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity"
                            }
                        ]
                    }
                ]
            },
            {
                "unique_name": "definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U",
                "name": "Fortinet - FortiGate - Search Services by Port and Protocol",
                "title": "Fortinet - FortiGate - Search Services by Port and Protocol",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                    "continue_on_failure": true,
                    "display_name": "Fortinet - FortiGate - Search Services by Port and Protocol",
                    "input": {
                        "variable_workflow_01RZGRP01HV426OpM4AeePOPt4hqh6VJjlM": "root",
                        "variable_workflow_01RZGRP01IJ2E0mcgGdwPbpM54YuoYMtpJk": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Destination Service$",
                        "variable_workflow_01RZGRP01IT581rtrzoBzi2T8u0XQTTcAGB": "",
                        "variable_workflow_01RZGRP01JAME7VMCJTHkWlC5zKEdJeOWjW": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Protocol$",
                        "variable_workflow_01RZGRP01K29Q62g6JcSb2otssHL4HrpNjC": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                        "variable_workflow_01S170KOVU2T41ajc44gcKExByQulifdAcv": "0.0.0.0"
                    },
                    "runtime_user": {
                        "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                        "use_workflow_target_group": true
                    },
                    "workflow_id": "definition_workflow_01RZGROZT4HXO7Yzmi2GzZtLdMJTJ4MB2tQ",
                    "workflow_name": "Fortinet - FortiGate - Search Services by Port and Protocol"
                },
                "object_type": "definition_activity"
            },
            {
                "unique_name": "definition_activity_01SBJ2GU3H7YK00NahvLFjdpocMsyzu16Ut",
                "name": "Condition Block",
                "title": "Was a service found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "Was a service found?",
                    "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                    {
                        "unique_name": "definition_activity_01SBJ2GUCGG881AKoHx2jkDudDmhwlV4V7c",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                            },
                            "continue_on_failure": false,
                            "display_name": "Yes",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SBALMOLCCZG0sOP8wupnw4ze3rqP2hdPN",
                                "name": "Set Variables",
                                "title": "Set local service name",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Set local service name",
                                    "skip_execution": false,
                                    "variables_to_update": [
                                        {
                                            "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                                            "variable_value_new": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.variable_workflow_01RZGRP01JIRW4450N3QfWxouVF3G9PV3pf$"
                                        }
                                    ]
                                },
                                "object_type": "definition_activity"
                            }
                        ]
                    },
                    {
                        "unique_name": "definition_activity_01S6FSOKS4INE15iw4JVIPALAz5b8DLNQ9e",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SBAIHHJH6ZL4CLLx4C7ues1vZuEBME9lm",
                                "name": "Execute Python Script",
                                "title": "Generate timestamp to create unique name",
                                "type": "python3.script",
                                "base_type": "activity",
                                "properties": {
                                    "action_timeout": 180,
                                    "continue_on_failure": false,
                                    "display_name": "Generate timestamp to create unique name",
                                    "script": "from sys import argv\nimport time\n\nprefix = argv[1]\nservice_name = f\"{prefix}-Service-{int(time.time())}\"",
                                    "script_arguments": [
                                        "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj$"
                                    ],
                                    "script_queries": [
                                        {
                                            "script_query": "service_name",
                                            "script_query_name": "Service Name",
                                            "script_query_type": "string"
                                        }
                                    ],
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv",
                                "name": "Fortinet - FortiGate - Create Service",
                                "title": "Fortinet - FortiGate - Create Service",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                    "continue_on_failure": true,
                                    "display_name": "Fortinet - FortiGate - Create Service",
                                    "input": {
                                        "variable_workflow_01RV9ELI8N87P2dO8bXsq5JMJ7lwIk6Bssh": "root",
                                        "variable_workflow_01RV9ELI8NIER0waKCBzZuDb3FM4FzI4elf": "",
                                        "variable_workflow_01RV9ELI8NQTO1uehKtBKQV3hnw4CWmQTLq": "$activity.definition_activity_01SBAIHHJH6ZL4CLLx4C7ues1vZuEBME9lm.output.script_queries.Service Name$",
                                        "variable_workflow_01RV9ELI8O8HR62K8iBpbeDnZ48YQ4vlzHk": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                        "variable_workflow_01RV9ELI8OQLS5TZh6ew1C5NjUgZGjle74Z": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Destination Service$",
                                        "variable_workflow_01RVCONR8MAO93Mls3APBaJZNCLXo3FNjA9": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Protocol$",
                                        "variable_workflow_01RX3VZUMHVIZ4nkBLdR0kfxzMfJs2du86j": ""
                                    },
                                    "runtime_user": {
                                        "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                        "use_workflow_target_group": true
                                    },
                                    "workflow_id": "definition_workflow_01RV9ELI34NB13GBEHhAGy60bTaNtnkFOEM",
                                    "workflow_name": "Fortinet - FortiGate - Create Service"
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SBJYPYNDLZT5ER3xFZrkosEtoO77P0eIw",
                                "name": "Condition Block",
                                "title": "Was the service created?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Was the service created?",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                    {
                                        "unique_name": "definition_activity_01SBJYPYNEVG00El6aYPlthUSkaBB40xlMU",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                            "condition": {
                                                "left_operand": "$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                            },
                                            "continue_on_failure": false,
                                            "display_name": "No",
                                            "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                            {
                                                "unique_name": "definition_activity_01SBJYPYNJKV32YmDgHUBMXeCPqugImqnXG",
                                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                    "continue_on_failure": false,
                                                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                    "input": {
                                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to create new service object:\n$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.error.message$",
                                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                                    },
                                                    "runtime_user": {
                                                        "target_default": true
                                                    },
                                                    "skip_execution": false,
                                                    "target": {
                                                        "override_workflow_target_group_criteria": true,
                                                        "target_group": {
                                                            "run_on_all_targets": false,
                                                            "use_criteria": {
                                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                                "conditions": [
                                                                    {
                                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                                        "operator": "eqi",
                                                                        "right_operand": "ServiceNow"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    },
                                                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                                },
                                                "object_type": "definition_activity"
                                            },
                                            {
                                                "unique_name": "definition_activity_01SBJYPYNLB1V0FTMvrwJ0BC8JJvbJo4Enz",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                    "completion_type": "failed-completed",
                                                    "continue_on_failure": false,
                                                    "display_name": "Failed",
                                                    "result_message": "SecureX orchestration failed to process the threat containment request. Failed to create new service object:\n$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.error.message$",
                                                    "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "unique_name": "definition_activity_01SBALJ7Y5C544GmUc1MNraNzlmJnQpOlAs",
                                "name": "Set Variables",
                                "title": "Set local service name",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Set local service name",
                                    "skip_execution": false,
                                    "variables_to_update": [
                                        {
                                            "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                                            "variable_value_new": "$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.variable_workflow_01RV9ELI8NZ4915NkyamIyehm0DYNRO9s4Z$"
                                        }
                                    ]
                                },
                                "object_type": "definition_activity"
                            }
                        ]
                    }
                ]
            },
            {
                "unique_name": "definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX",
                "name": "Fortinet - FortiGate - Add Service to Service Group",
                "title": "Fortinet - FortiGate - Add Service to Service Group",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                    "continue_on_failure": true,
                    "display_name": "Fortinet - FortiGate - Add Service to Service Group",
                    "input": {
                        "variable_workflow_01S0C9RPKE1J41hHDROkolBsfyL1CjzNsMj": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                        "variable_workflow_01S0C9RPKEG560ccSdgHicX3AR3iN4DgQDD": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                        "variable_workflow_01S0C9RPKEORM6jFLBwq4BGHGq3E2NDuJwl": "root",
                        "variable_workflow_01S0C9RPKEXJT5H15bhEVzKRn2OiSTB3sqL": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$"
                    },
                    "runtime_user": {
                        "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                        "use_workflow_target_group": true
                    },
                    "workflow_id": "definition_workflow_01S0C9RPDQDWD5dweMu1XWDQeA4IU48SC1F",
                    "workflow_name": "Fortinet - FortiGate - Add Service to Service Group"
                },
                "object_type": "definition_activity"
            },
            {
                "unique_name": "definition_activity_01SBKBUNNZUE724JROkxphB6UP4vtkjEDdj",
                "name": "Condition Block",
                "title": "Was the group updated?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "Was the group updated?",
                    "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                    {
                        "unique_name": "definition_activity_01SBKBUNO0HIW7OmfAWlHwxHtNdxwJQooto",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": "$activity.definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SBKBUNO48N070xB3NW5nmERIKsPR4ddGd",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to add the service to the service group:\n$activity.definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX.output.error.message$",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                    },
                                    "runtime_user": {
                                        "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                            "run_on_all_targets": false,
                                            "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                    {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ServiceNow"
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SBKBUNO682Z5vlLLYcC9ESzOk1FhPMUOI",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                    "completion_type": "failed-completed",
                                    "continue_on_failure": false,
                                    "display_name": "Failed",
                                    "result_message": "SecureX orchestration failed to process the threat containment request. Failed to add the service to the service group:\n$activity.definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX.output.error.message$",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity"
                            }
                        ]
                    }
                ]
            },
            {
                "unique_name": "definition_activity_01S6FJ9PJJN9O0yu9owsj3SiBggfR16VvPO",
                "name": "Read Table from Text",
                "title": "Read Table from Text",
                "type": "core.read_table_from_text",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "delimiters": [
                        {
                            "delimiter": ","
                        }
                    ],
                    "display_name": "Read Table from Text",
                    "input_text": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Source Address$,source,$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$\n$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Destination Address$,destination,$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                    "persist_output": false,
                    "populate_columns": false,
                    "skip_execution": false,
                    "table_columns": [
                        {
                            "column_name": "ip",
                            "column_type": "string"
                        },
                        {
                            "column_name": "direction",
                            "column_type": "string"
                        },
                        {
                            "column_name": "group",
                            "column_type": "string"
                        }
                    ]
                },
                "object_type": "definition_activity"
            },
            {
                "unique_name": "definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz",
                "name": "For Each",
                "title": "For each address",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "For each address",
                    "skip_execution": false,
                    "source_array": "$activity.definition_activity_01S6FJ9PJJN9O0yu9owsj3SiBggfR16VvPO.output.read_table_from_text$"
                },
                "object_type": "definition_activity",
                "actions": [
                    {
                        "unique_name": "definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx",
                        "name": "Fortinet - FortiGate - Search for Address by Value",
                        "title": "Fortinet - FortiGate - Search for Address by Value",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                            "continue_on_failure": true,
                            "display_name": "Fortinet - FortiGate - Search for Address by Value",
                            "input": {
                                "variable_workflow_01QJMY7E7Z0IB2Ed7caVA90mExOvR277l2a": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].ip$",
                                "variable_workflow_01QJMY7E7Z34Y31xJWhl8psuGJq9nSwAGQA": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                "variable_workflow_01QJNP94KKPAD0OwFo8IB6b8carKE0VVqpl": "ip",
                                "variable_workflow_01QJQEPSZM3BE1GcmTTNciS5QqSczLq11G7": "root"
                            },
                            "runtime_user": {
                                "target_default": true
                            },
                            "skip_execution": false,
                            "target": {
                                "use_workflow_target_group": true
                            },
                            "workflow_id": "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05",
                            "workflow_name": "Fortinet - FortiGate - Search for Address by Value"
                        },
                        "object_type": "definition_activity"
                    },
                    {
                        "unique_name": "definition_activity_01S6FNXPIAE8C3WSBuo4977OnSQQUIazL0z",
                        "name": "Condition Block",
                        "title": "Was an address found?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                            "continue_on_failure": false,
                            "display_name": "Was an address found?",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                            {
                                "unique_name": "definition_activity_01S6FNXPV8R8O3NRVaL63wUofPS6VEYCnEC",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                    "condition": {
                                        "left_operand": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": true
                                    },
                                    "continue_on_failure": false,
                                    "display_name": "Yes",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                    {
                                        "unique_name": "definition_activity_01SB9YMO47LK80nYWlhH44vbkgn0DAcyM58",
                                        "name": "Condition Block",
                                        "title": "Object destination selection",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                            "continue_on_failure": false,
                                            "display_name": "Object destination selection",
                                            "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                            {
                                                "unique_name": "definition_activity_01SB9YMOIIX7S5wtdlmU1eZiLLV1I4MplTh",
                                                "name": "Condition Branch",
                                                "title": "Source",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                    "condition": {
                                                        "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                                        "operator": "eqi",
                                                        "right_operand": "source"
                                                    },
                                                    "continue_on_failure": false,
                                                    "display_name": "Source",
                                                    "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                    {
                                                        "unique_name": "definition_activity_01SB9XAPS589421friHEEjg5ztxc97HIoWo",
                                                        "name": "Set Variables",
                                                        "title": "Set address object name",
                                                        "type": "core.set_multiple_variables",
                                                        "base_type": "activity",
                                                        "properties": {
                                                            "continue_on_failure": false,
                                                            "display_name": "Set address object name",
                                                            "skip_execution": false,
                                                            "variables_to_update": [
                                                                {
                                                                    "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$",
                                                                    "variable_value_new": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$"
                                                                }
                                                            ]
                                                        },
                                                        "object_type": "definition_activity"
                                                    }
                                                ]
                                            },
                                            {
                                                "unique_name": "definition_activity_01SBA0W5J4XI56glaiORM3m4D9Hm3Ao0zMZ",
                                                "name": "Condition Branch",
                                                "title": "Destination",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                    "condition": {
                                                        "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                                        "operator": "eqi",
                                                        "right_operand": "destination"
                                                    },
                                                    "continue_on_failure": false,
                                                    "display_name": "Destination",
                                                    "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                    {
                                                        "unique_name": "definition_activity_01SBA0W5J5L5E1NusD4T1cOltEBcM93vJOH",
                                                        "name": "Set Variables",
                                                        "title": "Set address object name",
                                                        "type": "core.set_multiple_variables",
                                                        "base_type": "activity",
                                                        "properties": {
                                                            "continue_on_failure": false,
                                                            "display_name": "Set address object name",
                                                            "skip_execution": false,
                                                            "variables_to_update": [
                                                                {
                                                                    "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$",
                                                                    "variable_value_new": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$"
                                                                }
                                                            ]
                                                        },
                                                        "object_type": "definition_activity"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "unique_name": "definition_activity_01SB9VLY3WUYT4CuqdiTnH9pTVrnFZ3VS58",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                    "condition": {
                                        "left_operand": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                    },
                                    "continue_on_failure": false,
                                    "display_name": "No",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                    {
                                        "unique_name": "definition_activity_01SB9VLY3XH350SEGlusKDdZptKv2QD1ru7",
                                        "name": "Execute Python Script",
                                        "title": "Create object names",
                                        "type": "python3.script",
                                        "base_type": "activity",
                                        "properties": {
                                            "action_timeout": 180,
                                            "continue_on_failure": false,
                                            "display_name": "Create object names",
                                            "script": "import time\nfrom sys import argv\n\nprefix = argv[1]\naddress_name = f\"{prefix}-Address-{int(time.time())}\"",
                                            "script_arguments": [
                                                "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj$"
                                            ],
                                            "script_queries": [
                                                {
                                                    "script_query": "address_name",
                                                    "script_query_name": "Address Name",
                                                    "script_query_type": "string"
                                                }
                                            ],
                                            "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                    },
                                    {
                                        "unique_name": "definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf",
                                        "name": "Fortinet - FortiGate - Create Address",
                                        "title": "Fortinet - FortiGate - Create Address",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                            "continue_on_failure": true,
                                            "display_name": "Fortinet - FortiGate - Create Address",
                                            "input": {
                                                "variable_workflow_01Q8Q3G8HFBBV4bCgPNxr8tNZAdaRIhTchP": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.input.variable_workflow_01S6BK8PJICEO1Sw0YZtdaQjtmobwyW8Tu9$",
                                                "variable_workflow_01Q8QAOJCFJFX2aDEaoWMl8JIaBJeUoywL6": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].ip$",
                                                "variable_workflow_01QCRJI0NZEMB0Pm8zeCVQJSI6QGrjOyakn": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                                "variable_workflow_01QYDQME2SLKW7lJPgDsK0aMFMMODvnejqs": "$activity.definition_activity_01SB9VLY3XH350SEGlusKDdZptKv2QD1ru7.output.script_queries.Address Name$",
                                                "variable_workflow_01QYE15IBF6Q74dRiYe9StNFoRQ1cIEul1M": "root"
                                            },
                                            "runtime_user": {
                                                "target_default": true
                                            },
                                            "skip_execution": false,
                                            "target": {
                                                "use_workflow_target_group": true
                                            },
                                            "workflow_id": "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB",
                                            "workflow_name": "Fortinet - FortiGate - Create Address"
                                        },
                                        "object_type": "definition_activity"
                                    },
                                    {
                                        "unique_name": "definition_activity_01SBK0JO3VJ2H4SKbyyb8eZLlV98cebk8YS",
                                        "name": "Condition Block",
                                        "title": "Was the address object created?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                            "continue_on_failure": false,
                                            "display_name": "Was the address object created?",
                                            "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                            {
                                                "unique_name": "definition_activity_01SBK0JO3W3ID67U8YyFWiphRczkpkXSXC0",
                                                "name": "Condition Branch",
                                                "title": "No",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                    "condition": {
                                                        "left_operand": "$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.succeeded$",
                                                        "operator": "eq",
                                                        "right_operand": false
                                                    },
                                                    "continue_on_failure": false,
                                                    "display_name": "No",
                                                    "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                    {
                                                        "unique_name": "definition_activity_01SBK0JO3Z82D4VP7cmQYLhGAOot6yPiVPI",
                                                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                            "continue_on_failure": false,
                                                            "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                            "input": {
                                                                "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                                                "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to create a new address object:\n$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.error.message$",
                                                                "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                                            },
                                                            "runtime_user": {
                                                                "target_default": true
                                                            },
                                                            "skip_execution": false,
                                                            "target": {
                                                                "override_workflow_target_group_criteria": true,
                                                                "target_group": {
                                                                    "run_on_all_targets": false,
                                                                    "use_criteria": {
                                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                                        "conditions": [
                                                                            {
                                                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                                                "operator": "eqi",
                                                                                "right_operand": "ServiceNow"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            },
                                                            "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                                            "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                                        },
                                                        "object_type": "definition_activity"
                                                    },
                                                    {
                                                        "unique_name": "definition_activity_01SBK0JO4118I4kPhq8SifqkEQP8r4W4bfm",
                                                        "name": "Completed",
                                                        "title": "Failed",
                                                        "type": "logic.completed",
                                                        "base_type": "activity",
                                                        "properties": {
                                                            "completion_type": "failed-completed",
                                                            "continue_on_failure": false,
                                                            "display_name": "Failed",
                                                            "result_message": "SecureX orchestration failed to process the threat containment request. Failed to create a new address object:\n$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.error.message$",
                                                            "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "unique_name": "definition_activity_01SBA1YP1SBD15qhLY3ZeyYgeMT9lmc688D",
                                        "name": "Condition Block",
                                        "title": "Object destination selection",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                            "continue_on_failure": false,
                                            "display_name": "Object destination selection",
                                            "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                            {
                                                "unique_name": "definition_activity_01SBA1YP1SVXW1ITx9GqoJ0KeZKJE84suHg",
                                                "name": "Condition Branch",
                                                "title": "Source",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                    "condition": {
                                                        "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                                        "operator": "eqi",
                                                        "right_operand": "source"
                                                    },
                                                    "continue_on_failure": false,
                                                    "display_name": "Source",
                                                    "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                    {
                                                        "unique_name": "definition_activity_01SBA1YP1USF17bajqR040Gc0CtrEZwMj99",
                                                        "name": "Set Variables",
                                                        "title": "Set address object name",
                                                        "type": "core.set_multiple_variables",
                                                        "base_type": "activity",
                                                        "properties": {
                                                            "continue_on_failure": false,
                                                            "display_name": "Set address object name",
                                                            "skip_execution": false,
                                                            "variables_to_update": [
                                                                {
                                                                    "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$",
                                                                    "variable_value_new": "$activity.definition_activity_01SB9VLY3XH350SEGlusKDdZptKv2QD1ru7.output.script_queries.Address Name$"
                                                                }
                                                            ]
                                                        },
                                                        "object_type": "definition_activity"
                                                    }
                                                ]
                                            },
                                            {
                                                "unique_name": "definition_activity_01SBA1YP1XX9F0vED0JBSgpdXpj2WJ4b0Yr",
                                                "name": "Condition Branch",
                                                "title": "Destination",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                    "condition": {
                                                        "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                                        "operator": "eqi",
                                                        "right_operand": "destination"
                                                    },
                                                    "continue_on_failure": false,
                                                    "display_name": "Destination",
                                                    "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                    {
                                                        "unique_name": "definition_activity_01SBA1YP1YICW3wTeYk7aksD83d5CES0FIo",
                                                        "name": "Set Variables",
                                                        "title": "Set address object name",
                                                        "type": "core.set_multiple_variables",
                                                        "base_type": "activity",
                                                        "properties": {
                                                            "continue_on_failure": false,
                                                            "display_name": "Set address object name",
                                                            "skip_execution": false,
                                                            "variables_to_update": [
                                                                {
                                                                    "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$",
                                                                    "variable_value_new": "$activity.definition_activity_01SB9VLY3XH350SEGlusKDdZptKv2QD1ru7.output.script_queries.Address Name$"
                                                                }
                                                            ]
                                                        },
                                                        "object_type": "definition_activity"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "unique_name": "definition_activity_01SBLXA5VD2E018xRncuww9sDyvkaa6oQW2",
                        "name": "Execute Python Script",
                        "title": "Set temporary object name",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": false,
                            "display_name": "Set temporary object name",
                            "script": "from sys import argv\n\nobj_name = None\nif argv[1] == \"source\":\n    obj_name = argv[2]\nelse:\n    obj_name = argv[3]",
                            "script_arguments": [
                                "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$",
                                "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$"
                            ],
                            "script_queries": [
                                {
                                    "script_query": "obj_name",
                                    "script_query_name": "Object Name",
                                    "script_query_type": "string"
                                }
                            ],
                            "skip_execution": false
                        },
                        "object_type": "definition_activity"
                    },
                    {
                        "unique_name": "definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq",
                        "name": "Fortinet - FortiGate - Add Address to Address Group",
                        "title": "Fortinet - FortiGate - Add Address to Address Group",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                            "continue_on_failure": true,
                            "display_name": "Fortinet - FortiGate - Add Address to Address Group",
                            "input": {
                                "variable_workflow_01QKJSE0EFJ2W31BeDVMJrs1CFizp43DKQr": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                "variable_workflow_01QKJSE0EFMPQ4ZousJqguiEM0z7cVkN0z4": "$activity.definition_activity_01SBLXA5VD2E018xRncuww9sDyvkaa6oQW2.output.script_queries.Object Name$",
                                "variable_workflow_01QKJSE0EFQL61FRB1WLGyXTIRetH2ohsE4": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].group$",
                                "variable_workflow_01QKM1ZUG7X301PG75jm0VEKR1SrG6holTq": "root"
                            },
                            "runtime_user": {
                                "target_default": true
                            },
                            "skip_execution": false,
                            "target": {
                                "use_workflow_target_group": true
                            },
                            "workflow_id": "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV",
                            "workflow_name": "Fortinet - FortiGate - Add Address to Address Group"
                        },
                        "object_type": "definition_activity"
                    },
                    {
                        "unique_name": "definition_activity_01SBLD1F0YNY87fbIBxyNgHIyc4KRjunMec",
                        "name": "Condition Block",
                        "title": "Address group update successful?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                            "continue_on_failure": false,
                            "display_name": "Address group update successful?",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                            {
                                "unique_name": "definition_activity_01SBLD1F0Z64O3rVVHYcIBE23nL7m0UyX9T",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                    "condition": {
                                        "left_operand": "$activity.definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                    },
                                    "continue_on_failure": false,
                                    "display_name": "No",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                    {
                                        "unique_name": "definition_activity_01SBLD1F129C43IO5xhQv1pCHwNvxw9OePC",
                                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                            "continue_on_failure": false,
                                            "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                            "input": {
                                                "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                                "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to add $activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$ address object \"$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$\" to group \"$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].group$\":\n$activity.definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq.output.error.message$",
                                                "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                            },
                                            "runtime_user": {
                                                "target_default": true
                                            },
                                            "skip_execution": false,
                                            "target": {
                                                "override_workflow_target_group_criteria": true,
                                                "target_group": {
                                                    "run_on_all_targets": false,
                                                    "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                            {
                                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                                "operator": "eqi",
                                                                "right_operand": "ServiceNow"
                                                            }
                                                        ]
                                                    }
                                                }
                                            },
                                            "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                            "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                        },
                                        "object_type": "definition_activity"
                                    },
                                    {
                                        "unique_name": "definition_activity_01SBLD1F13Q6C1wCfdZH61oNrSB09y3lFNN",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                            "completion_type": "failed-completed",
                                            "continue_on_failure": false,
                                            "display_name": "Failed",
                                            "result_message": "SecureX orchestration failed to process the threat containment request. Failed to add $activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$ address object \"$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$\" to group \"$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].group$\":\n$activity.definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq.output.error.message$",
                                            "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "unique_name": "definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh",
                "name": "Fortinet - FortiGate - Get Policy by Name",
                "title": "Fortinet - FortiGate - Get Policy by Name",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                    "continue_on_failure": true,
                    "display_name": "Fortinet - FortiGate - Get Policy by Name",
                    "input": {
                        "variable_workflow_01QIUK02DI1IF4L5JSfJ1dW6v53vUb5sKrd": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                        "variable_workflow_01QIUK02DI2PR41Jf3FNKjTlsvabn7pRwAJ": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$",
                        "variable_workflow_01QZ7S20AIWUG4syV8kHuL1uInjCRVDLDJs": "root"
                    },
                    "runtime_user": {
                        "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                        "use_workflow_target_group": true
                    },
                    "workflow_id": "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf",
                    "workflow_name": "Fortinet - FortiGate - Get Policy by Name"
                },
                "object_type": "definition_activity"
            },
            {
                "unique_name": "definition_activity_01SBKJ43LBMO12DiEkgo45Bc7Vq2LjNYEnW",
                "name": "Condition Block",
                "title": "Policy found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "Policy found?",
                    "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                    {
                        "unique_name": "definition_activity_01SD3VR35MD1I673IxEuFngR9vJAVF4l6O6",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                            },
                            "continue_on_failure": false,
                            "display_name": "Yes",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R",
                                "name": "Fortinet - FortiGate - Update Firewall Policy",
                                "title": "Fortinet - FortiGate - Update Firewall Policy",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                    "continue_on_failure": true,
                                    "display_name": "Fortinet - FortiGate - Update Firewall Policy",
                                    "input": {
                                        "variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC": "",
                                        "variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.variable_workflow_01QIUK02DHUFV5m3AAJ9VSfPBXcC36ZMSTB$",
                                        "variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                                        "variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                        "variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK": "root",
                                        "variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                                        "variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB": "",
                                        "variable_workflow_01SOKPX0NFW0L464aL9t0vEyBowlnCQjman": "",
                                        "variable_workflow_01SOKQ5CWNBD70J1ywhGt6lYQlQmK7KVnDX": ""
                                    },
                                    "runtime_user": {
                                        "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                        "use_workflow_target_group": true
                                    },
                                    "workflow_id": "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO",
                                    "workflow_name": "Fortinet - FortiGate - Update Firewall Policy"
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SBKM3Y2CGBH3n0HAHKtzVgCTaR1Xcxgvm",
                                "name": "Condition Block",
                                "title": "Policy update succeeded?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Policy update succeeded?",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                    {
                                        "unique_name": "definition_activity_01SBKM3Y2D0PM7SyCAehvGG8RWuCyhdJrqw",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                            "condition": {
                                                "left_operand": "$activity.definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                            },
                                            "continue_on_failure": false,
                                            "display_name": "No",
                                            "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                            {
                                                "unique_name": "definition_activity_01SBKM3Y2IR2B6pjlXPGmyx9h3VkVKU9NZj",
                                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                    "continue_on_failure": false,
                                                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                                    "input": {
                                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to update firewall policy:\n$activity.definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R.output.error.message$",
                                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                                    },
                                                    "runtime_user": {
                                                        "target_default": true
                                                    },
                                                    "skip_execution": false,
                                                    "target": {
                                                        "override_workflow_target_group_criteria": true,
                                                        "target_group": {
                                                            "run_on_all_targets": false,
                                                            "use_criteria": {
                                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                                "conditions": [
                                                                    {
                                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                                        "operator": "eqi",
                                                                        "right_operand": "ServiceNow"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    },
                                                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                                },
                                                "object_type": "definition_activity"
                                            },
                                            {
                                                "unique_name": "definition_activity_01SBKM3Y2KIO74KJgd5CFoWpLEk3LzmTWhZ",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                    "completion_type": "failed-completed",
                                                    "continue_on_failure": false,
                                                    "display_name": "Failed",
                                                    "result_message": "SecureX orchestration failed to process the threat containment request. Failed to update firewall policy:\n$activity.definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R.output.error.message$",
                                                    "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "unique_name": "definition_activity_01SBKJ43LC5ZH4qQ1Mob4LXL3pm49U7dIqX",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SBKJ43LFX9H3HoZKWCMchsEuVaDVEKU3N",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to find firewall policy provided:\n$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.error.message$",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                    },
                                    "runtime_user": {
                                        "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                            "run_on_all_targets": false,
                                            "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                    {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ServiceNow"
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SBKJ43LHQZS14eOIdPOIoVBA6eC97vBaV",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                    "completion_type": "failed-completed",
                                    "continue_on_failure": false,
                                    "display_name": "Failed",
                                    "result_message": "SecureX orchestration failed to process the threat containment request. Failed to find firewall policy provided:\n$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.error.message$",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity"
                            }
                        ]
                    }
                ]
            },
            {
                "unique_name": "definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS",
                "name": "Fortinet - FortiGate - Move Policy To Top of Policy List",
                "title": "Fortinet - FortiGate - Move Policy To Top of Policy List",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                    "continue_on_failure": true,
                    "display_name": "Fortinet - FortiGate - Move Policy To Top of Policy List",
                    "input": {
                        "variable_workflow_01RL0ZYDSSTEA1H5YdUxbC5WZf3PGU31zBk": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$",
                        "variable_workflow_01RL0ZYDST2F13RUNFmIaNqBBtT4MtsXvlX": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                        "variable_workflow_01RL0ZYDST3YY33jZNgUsLBKnkFoRa7Vgcs": "root"
                    },
                    "runtime_user": {
                        "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                        "use_workflow_target_group": true
                    },
                    "workflow_id": "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX",
                    "workflow_name": "Fortinet - FortiGate - Move Policy To Top of Policy List"
                },
                "object_type": "definition_activity"
            },
            {
                "unique_name": "definition_activity_01SBKSD8HBQ6D4myA4aFCRKG4pWee5Nkv0c",
                "name": "Condition Block",
                "title": "Policy moved successfully?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "Policy moved successfully?",
                    "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                    {
                        "unique_name": "definition_activity_01SBKSD8HCA7E0HZQarE2nefn8wOV5GFJAN",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                            "condition": {
                                "left_operand": "$activity.definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                            {
                                "unique_name": "definition_activity_01SBKSD8HGAP45XG45OgTDlSVDdSZrqZrCn",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to move firewall policy to top of policy list:\n$activity.definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS.output.error.message$",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                    },
                                    "runtime_user": {
                                        "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                            "run_on_all_targets": false,
                                            "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                    {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ServiceNow"
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                                },
                                "object_type": "definition_activity"
                            },
                            {
                                "unique_name": "definition_activity_01SBKSD8HI3YM7Rvmx0CapnnvmL46ZcEcoI",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                    "completion_type": "failed-completed",
                                    "continue_on_failure": false,
                                    "display_name": "Failed",
                                    "result_message": "SecureX orchestration failed to process the threat containment request. Failed to move firewall policy to top of policy list:\n$activity.definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS.output.error.message$",
                                    "skip_execution": false
                                },
                                "object_type": "definition_activity"
                            }
                        ]
                    }
                ]
            },
            {
                "unique_name": "definition_activity_01SBKUM5YV8201BeIjyILW87qWdwyCXyiAv",
                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                    "continue_on_failure": false,
                    "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                    "input": {
                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration has updated the firewall policy \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$\" successfully!\n- Source group \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$\" updated with object \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$\"\n- Destination group \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$\" updated with object \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$\"\n- Service group \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$\" updated with object \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$\"",
                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                    },
                    "runtime_user": {
                        "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                            "run_on_all_targets": false,
                            "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                    {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "ServiceNow"
                                    }
                                ]
                            }
                        }
                    },
                    "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
                    "workflow_name": "ServiceNow - Add Work Note to Firewall Rule Task"
                },
                "object_type": "definition_activity"
            }
        ],
        "categories": [
            "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
        ]
    },
    "categories": {
        "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
            "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
            "name": "response",
            "title": "response",
            "type": "basic.category",
            "base_type": "category",
            "category_type": "custom",
            "object_type": "category"
        }
    },
    "target_groups": {
        "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
            "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
            "name": "Default TargetGroup",
            "title": "Default TargetGroup",
            "type": "generic.target_group",
            "base_type": "target_group",
            "version": "1.0.0",
            "targets": [
                {
                    "data_target_type": "web-service.endpoint",
                    "view_target_type": "web-service.endpoint",
                    "include_all_targets": true
                },
                {
                    "data_target_type": "email.smtp_endpoint",
                    "view_target_type": "email.smtp_endpoint",
                    "include_all_targets": true
                }
            ],
            "object_type": "target_group"
        }
    },
    "atomic_workflows": [
        "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV",
        "definition_workflow_01S0C9RPDQDWD5dweMu1XWDQeA4IU48SC1F",
        "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX",
        "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf",
        "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05",
        "definition_workflow_01RZGROZT4HXO7Yzmi2GzZtLdMJTJ4MB2tQ",
        "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB",
        "definition_workflow_01RV9ELI34NB13GBEHhAGy60bTaNtnkFOEM",
        "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
        "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO"
    ],
    "dependent_workflows": [
        "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
        "definition_workflow_01RZGROZT4HXO7Yzmi2GzZtLdMJTJ4MB2tQ",
        "definition_workflow_01RV9ELI34NB13GBEHhAGy60bTaNtnkFOEM",
        "definition_workflow_01S0C9RPDQDWD5dweMu1XWDQeA4IU48SC1F",
        "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05",
        "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB",
        "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV",
        "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf",
        "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO",
        "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX"
    ]
}