{
  "workflow": {
    "unique_name": "definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK",
    "name": "0013 - Secure Firewall - Impact Red Remediation",
    "title": "0013 - Secure Firewall - Impact Red Remediation",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Duo Secret Key",
          "type": "datatype.secure_string",
          "description": "The secret key key for your Duo Admin API integration. This can be found in the integration's information inyour Duo admin panel",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M951J0F6Z1W4DCbtjlBgBB2m1EWoRmWvG",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "ServiceNow Instance URL",
          "type": "datatype.string",
          "description": "The URL of your ServiceNow instance. For example: mycompany.service-now.com",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M93KC2SYFE94M0oH0ua9II7I1rNIjDFSo",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M957VHSG6C75E89EUjnSVVZNZ9gXC06Cb",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Room ID",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Secure Endpoint Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the Secure Endpoint environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M957Z78OZVQ1MvD22NE5E4hqMFypgaJrk",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "SecureX Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the SecureX environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M93JRIMFUY22gYuharF546AIT7wpumtq6",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Duo Username Suffix",
          "type": "datatype.string",
          "description": "Usernames are fetched using Orbital and often come back as something like \"bobjones.\" If your Duo usernames are email addresses, you may want to add a suffix of \"@mycompany.com\" using this variable. This is optional",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M9511A6UEHJ7M2f9emz2a2DymCR2xOOjU",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_01IM6TQ2VAES81TigWJDmN9aTwjMfRiIH6F",
        "properties": {
          "value": [
            {
              "column_data": {
                "action_data": "",
                "action_human": "",
                "action_name": ""
              }
            }
          ],
          "scope": "local",
          "name": "Remediation Tasks",
          "type": "datatype.table",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M8YO6NNHZTH4WbyBqMtwQndYYE3FmSf4x",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "User List",
          "type": "datatype.string",
          "description": "Placeholder for a list of users to be added to the Duo DENY group",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M8YO6NNHSK30za2HeRknjk7CY1q72uwl8",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "ServiceNow Text",
          "type": "datatype.string",
          "description": "Placeholder used to assemble text for a ServiceNow ticket",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Duo Hostname",
          "type": "datatype.string",
          "description": "The hostname for your Duo Admin API integration. This can be found in the integration's information inyour Duo admin panel",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M9543OD7MN8689ZEuuDpC6kBzzNkm1XNs",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Remediation Step Text",
          "type": "datatype.string",
          "description": "Placeholder used to assemble text for Webex messages",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Text",
          "type": "datatype.string",
          "description": "Placholder used to assemble text for Webex",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M975RRFM4FQ1wesR3Vxlu0q1zP4m6ekia",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Duo Integration Key",
          "type": "datatype.string",
          "description": "The integration key for your Duo Admin API integration. This can be found in the integration's information inyour Duo admin panel",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M951CD4SC3O1fAi8oqasNp0VbAoWd40oM",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Email Findings",
          "type": "datatype.string",
          "description": "Placeholder used to to store information about SMA module results",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M8YO6NNI3452IibgyQn7Do74JqnfVYM2Z",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Approval Task Text",
          "type": "datatype.string",
          "description": "Placeholder used to assemble text for the approval task",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Duo Deny User Group",
          "type": "datatype.string",
          "description": "The ID of the user group you want to add Duo users to when they're considered compromised by this workflow. You can get this ID from the URL of the group's page in the Duo admin panel. For example: DGWP6584D8PORPPC9H01",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M96DE3LC5DB6fnX6PEEkJwXf54GiTOKga",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Malicious IP",
          "type": "datatype.string",
          "description": "Placeholder used to store malicious IP addresses in",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M8YO6NNI20D6Sf5J6tn2Il6nQ0kcM6iGE",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow checks Cisco Threat Response for incidents generated by Cisco Secure Firewall Impact Red events every 10 minutes. If matching incidents are found, an investigation is performed to identify related observables including endpoints, domains, file hashes, and users. After investigation is complete, approval will be requested to perform automated remediation. If approved, the observables discovered will be remediated (remediation actions vary by observable type).\n\nNote: This workflow has been updated to support SecureX Token account keys. See the workflow documentation for more information.\n\nDocumentation: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0013\n\nTarget Group: Default TargetGroup\n\nTargets: CTR_API, Duo Security, Orbital_For_Access_Token, Orbital_Target, Private_CTIA_Target, ServiceNow, Webex Teams",
      "display_name": "0013 - Secure Firewall - Impact Red Remediation",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01M93I9O3Q0RX1XBCPjL8Fy9ZXMUvSaoRrR",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch global variables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01M93IS1KQ5H83ImqfsuoennmHuU79vOCA0",
            "name": "Set Variables",
            "title": "Fetch global variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch global variables",
              "skip_execution": true,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M951CD4SC3O1fAi8oqasNp0VbAoWd40oM$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M951J0F6Z1W4DCbtjlBgBB2m1EWoRmWvG$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9543OD7MN8689ZEuuDpC6kBzzNkm1XNs$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957VHSG6C75E89EUjnSVVZNZ9gXC06Cb$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01M93IJB8ROQR6HucZEmGIic5zFn7XB0mjH",
        "name": "Condition Block",
        "title": "Set the environment URL",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set the environment URL",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01M93IJX34XY32l9LYXO6PweaTOw9WpJvWK",
            "name": "Condition Branch",
            "title": "PROD-NAM",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-nam"
              },
              "continue_on_failure": false,
              "display_name": "PROD-NAM",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01M93J7GHEIO41ba6nDFYTVwjw3FpsdRzMJ",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93JRIMFUY22gYuharF546AIT7wpumtq6$",
                      "variable_value_new": "securex-ao.us.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$",
                      "variable_value_new": "amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M93L5ABFKKM2E2SmVBwsPbU4emH8YrP92",
            "name": "Condition Branch",
            "title": "PROD-EU",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-eu"
              },
              "continue_on_failure": false,
              "display_name": "PROD-EU",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01M93L5BDVNIV2aeg3rZ4A9Uh1q13HsGnvD",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93JRIMFUY22gYuharF546AIT7wpumtq6$",
                      "variable_value_new": "securex-ao.eu.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$",
                      "variable_value_new": "eu.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M93LDLOJQ515v9RX0TjHX7SgIrg0qD8Ku",
            "name": "Condition Branch",
            "title": "PROD-APJC",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-apjc"
              },
              "continue_on_failure": false,
              "display_name": "PROD-APJC",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01M93LDMOD7PE0BUZs4jkjmfW6u4xbhSyZy",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93JRIMFUY22gYuharF546AIT7wpumtq6$",
                      "variable_value_new": "securex-ao.apjc.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$",
                      "variable_value_new": "apjc.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01M9374NUZQXW3KS771TSVNl5ln9BwMZeRi",
        "name": "Group",
        "title": "Fetch access token and incident list",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch access token and incident list",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01M9VK71GJ6HH0PPVx8uavRzf9V2QpbmDcF",
            "name": "Calculate Date",
            "title": "Calculate time 10 minutes ago",
            "type": "core.calculate_date",
            "base_type": "activity",
            "properties": {
              "adjustment": -600,
              "continue_on_failure": false,
              "display_name": "Calculate time 10 minutes ago",
              "original_date": "$activity.definition_activity_01M93IJB8ROQR6HucZEmGIic5zFn7XB0mjH.output.end_time$",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01M8ZRPV1IPNV4PEITvgPaz5fucFePujlNK",
            "name": "HTTP Request",
            "title": "Fetch new firewall incidents",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "continue_on_error_status_code": true,
              "continue_on_failure": false,
              "display_name": "Fetch new firewall incidents",
              "method": "GET",
              "relative_url": "/ctia/incident/search?source=ngfw_ips_event_service\u0026query=description:impact_red\u0026status=New\u0026from=$activity.definition_activity_01M9VK71GJ6HH0PPVx8uavRzf9V2QpbmDcF.output.result$",
              "runtime_user": {
                "override_target_runtime_user": false,
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01M8ZTAOGDZ726d8RVmpdjiSCWuqnZvaG3S",
            "name": "Condition Block",
            "title": "Was the request successful?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Was the request successful?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01M8ZTBA4ZU082OR5Q0hb6lBMtagHGtPV22",
                "name": "Condition Branch",
                "title": "Anything else",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01M8ZRPV1IPNV4PEITvgPaz5fucFePujlNK.output.status_code$",
                    "operator": "ne",
                    "right_operand": 200
                  },
                  "continue_on_failure": false,
                  "display_name": "Anything else",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01M8ZTQVOJ3E50lNMCohD16sj9mcd85XedY",
                    "name": "Completed",
                    "title": "Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Failed",
                      "result_message": "Failed to fetch firewall incidents from Threat Response\n\nStatus code: $activity.definition_activity_01M8ZRPV1IPNV4PEITvgPaz5fucFePujlNK.output.status_code$\nResponse body: $activity.definition_activity_01M8ZRPV1IPNV4PEITvgPaz5fucFePujlNK.output.response_body$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M8ZUA04QAEH3gLKFBOUE1itndGVwv2zfP",
            "name": "Read Table from JSON",
            "title": "Convert list of incidents to table",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Convert list of incidents to table",
              "input_json": "$activity.definition_activity_01M8ZRPV1IPNV4PEITvgPaz5fucFePujlNK.output.response_body$",
              "jsonpath_query": "$.",
              "persist_output": false,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "description",
                  "column_type": "string"
                },
                {
                  "column_name": "short_description",
                  "column_type": "string"
                },
                {
                  "column_name": "incident_time",
                  "column_type": "string"
                },
                {
                  "column_name": "source_uri",
                  "column_type": "string"
                },
                {
                  "column_name": "id",
                  "column_type": "string"
                },
                {
                  "column_name": "title",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01M900E95UUTH484t4sZAUByFXAYDEV0CyS",
            "name": "Condition Block",
            "title": "Were there any incidents?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were there any incidents?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01M900FPCEG5V48lObRPOCN43a2df1qRNA3",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01M8ZUA04QAEH3gLKFBOUE1itndGVwv2zfP.output.row_count$",
                    "operator": "eq",
                    "right_operand": 0
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01M905JB3KKRZ5qSMUlCvoaMtJRmXsHFJcY",
                    "name": "Completed",
                    "title": "Completed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Completed",
                      "result_message": "No incidents to process were returned by Threat Response",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01M905Q7OGVYB4zY14rN750D6HZmO4jlnYf",
        "name": "For Each",
        "title": "For each incident",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For each incident",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01M8ZUA04QAEH3gLKFBOUE1itndGVwv2zfP.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01M8YP1HK5H8474zYpk5qrAN6d3Cl8KFrHR",
            "name": "Execute Python Script",
            "title": "Extract short incident ID",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Extract short incident ID",
              "script": "import sys, re\n\nlink = sys.argv[1]\n\nincident = re.findall(r\"(incident-[a-zA-Z0-9\\-]+)$\", link)\nincident = incident[0]",
              "script_arguments": [
                "$activity.definition_activity_01M905Q7OGVYB4zY14rN750D6HZmO4jlnYf.input.source_array[@].id$"
              ],
              "script_queries": [
                {
                  "script_query": "incident",
                  "script_query_name": "incidentId",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01M93LWYFJL814OUlXGYMjS1NV7PyyQ20Ye",
            "name": "Set Variables",
            "title": "Update/reset text placeholders",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Update/reset text placeholders",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$",
                  "variable_value_new": "\u003cstrong\u003eIncident Title: $activity.definition_activity_01M905Q7OGVYB4zY14rN750D6HZmO4jlnYf.input.source_array[@].title$\u003c/strong\u003e"
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI3452IibgyQn7Do74JqnfVYM2Z$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01M8YO8GL21UG1TAaVtDoVBfUZPoNEsSQpN",
            "name": "Group",
            "title": "Fetch and parse incident",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch and parse incident",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01M8YO8TA6AZA6juvBp13ocpKm62Pup62WD",
                "name": "HTTP Request",
                "title": "Get incident bundle",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "display_name": "Get incident bundle",
                  "method": "GET",
                  "relative_url": "/ctia/bundle/export?ids=$activity.definition_activity_01M905Q7OGVYB4zY14rN750D6HZmO4jlnYf.input.source_array[@].id$",
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "Private_CTIA_Target"
                          }
                        ]
                      }
                    }
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01M8YO95PKX8I5Lo36GMhQmcgx1fPTK5Gix",
                "name": "JSONPath Query",
                "title": "Extract incident fields",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Extract incident fields",
                  "input_json": "$activity.definition_activity_01M8YO8TA6AZA6juvBp13ocpKm62Pup62WD.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.incidents[0].description",
                      "jsonpath_query_name": "description",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.incidents[0].short_description",
                      "jsonpath_query_name": "shortDescription",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.incidents[0].timestamp",
                      "jsonpath_query_name": "timestamp",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01M8YOAI0MIRV2FTq5SzkjM85DQM19xe5aR",
                "name": "Read Table from JSON",
                "title": "Convert sightings to table",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Convert sightings to table",
                  "input_json": "$activity.definition_activity_01M8YO8TA6AZA6juvBp13ocpKm62Pup62WD.output.response_body$",
                  "jsonpath_query": "$.sightings",
                  "persist_output": false,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "relations",
                      "column_type": "string"
                    },
                    {
                      "column_name": "observables",
                      "column_type": "string"
                    },
                    {
                      "column_name": "targets",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M8YOAVOBIEY1mnTrLRy2witwGf9i273tA",
            "name": "For Each",
            "title": "For each sighting",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each sighting",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01M8YOAI0MIRV2FTq5SzkjM85DQM19xe5aR.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11",
                "name": "Execute Python Script",
                "title": "Process sightings",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Process sightings",
                  "script": "import sys,json,re\n\n# Get the script\"s input\nrelationships = sys.argv[1]\nobservables = sys.argv[2]\ntargets = sys.argv[3]\n\n# Parse the relationships (or default to an empty list)\nif len(relationships) \u003e 0:\n\trelationships = json.loads(relationships)\nelse:\n\trelationships = []\n\n# Parse the observables (or default to an empty list)\nif len(observables) \u003e 0:\n\tobservables = json.loads(observables)\nelse:\n\tobservables = []\n\n# Parse the targets (or default to an empty list)\nif len(targets) \u003e 0:\n\ttargets = json.loads(targets)\nelse:\n\ttargets = []\n\n# Placeholders\nobservablesOut = []\ninternalIp = \"\"\nresolvedDomainsOut = []\n\n# Appends an observable to our master list if it\"s not an RFC 1918 address\ndef appendObservable(observable):\n\tif observable[\"type\"] != \"ip\" or (observable[\"type\"] == \"ip\" and not re.match(r'(^127\\.)|(^10\\.)|(^172\\.1[6-9]\\.)|(^172\\.2[0-9]\\.)|(^172\\.3[0-1]\\.)|(^192\\.168\\.)', observable[\"value\"])):\n\t\tif observable not in observablesOut:\n\t\t\tobservablesOut.append( { \"type\" : observable[\"type\"], \"value\" : observable[\"value\"] })\n\n# For each relationship...\nfor relation in relationships:\n\t# Append its observables\n\tappendObservable(relation[\"source\"])\n\tappendObservable(relation[\"related\"])\n\t\n\t# Is this a domain resolution?\n\tif relation[\"relation\"] == \"Resolved_To\" and relation[\"related\"][\"type\"] == \"domain\":\n\t\tdomainObject = { \"domain\": relation[\"related\"][\"value\"] }\n\t\tif domainObject not in resolvedDomainsOut:\n\t\t\tresolvedDomainsOut.append(domainObject)\n\n# For each observable...\nfor observable in observables:\n\tappendObservable(observable)\n\n# For each target...\nfor target in targets:\n\t# Check its observables\n\tfor observable in target[\"observables\"]:\n\t\tappendObservable(observable)\n\t\t\n\t\t# Is this an internal IP?\n\t\tif observable[\"type\"] == \"ip\" and re.match(r'(^127\\.)|(^10\\.)|(^172\\.1[6-9]\\.)|(^172\\.2[0-9]\\.)|(^172\\.3[0-1]\\.)|(^192\\.168\\.)', observable[\"value\"]):\n\t\t\tinternalIp = observable[\"value\"]\n\n# Format the output JSON\nobservablesOut = json.dumps(observablesOut)\nresolvedDomainsOut = json.dumps(resolvedDomainsOut)",
                  "script_arguments": [
                    "$activity.definition_activity_01M8YOAVOBIEY1mnTrLRy2witwGf9i273tA.input.source_array[@].relations$",
                    "$activity.definition_activity_01M8YOAVOBIEY1mnTrLRy2witwGf9i273tA.input.source_array[@].observables$",
                    "$activity.definition_activity_01M8YOAVOBIEY1mnTrLRy2witwGf9i273tA.input.source_array[@].targets$"
                  ],
                  "script_queries": [
                    {
                      "script_query": "observablesOut",
                      "script_query_name": "observables",
                      "script_query_type": "string"
                    },
                    {
                      "script_query": "resolvedDomainsOut",
                      "script_query_name": "resolvedDomains",
                      "script_query_type": "string"
                    },
                    {
                      "script_query": "internalIp",
                      "script_query_name": "internalIp",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01M8YOBMA0MLP14fL8s3jIkLzj1JC0R5iVo",
                "name": "Condition Block",
                "title": "Do we need to block any domains?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Do we need to block any domains?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01M8YOBY67AKZ05vUdBBSgJcCH7kVT6otrq",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11.output.script_queries.resolvedDomains$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M8YOC0R9TSP2TNeqKxYL9Ll6JBb0UJ5JS",
                        "name": "Read Table from JSON",
                        "title": "Convert domains to table",
                        "type": "corejava.read_table_from_json",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Convert domains to table",
                          "input_json": "$activity.definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11.output.script_queries.resolvedDomains$",
                          "jsonpath_query": "$.*",
                          "persist_output": false,
                          "populate_columns": false,
                          "skip_execution": false,
                          "table_columns": [
                            {
                              "column_name": "domain",
                              "column_type": "string"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01M8YOCE6KIHB6DjEiQ75cktR1fPBLCUe68",
                        "name": "For Each",
                        "title": "For each domain",
                        "type": "logic.for_each",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "For each domain",
                          "skip_execution": false,
                          "source_array": "$activity.definition_activity_01M8YOC0R9TSP2TNeqKxYL9Ll6JBb0UJ5JS.output.read_table_from_json$"
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M94UIHSBL2Y7SNcMo08Wj6vY4mJeSr3M1",
                            "name": "Replace String",
                            "title": "Defang domain",
                            "type": "core.replacestring",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Defang domain",
                              "input_string": "$activity.definition_activity_01M8YOCE6KIHB6DjEiQ75cktR1fPBLCUe68.input.source_array[@].domain$",
                              "replace_list": [
                                {
                                  "replaced_string": ".",
                                  "replacement_string": "[.]"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M8YOCRYEKKJ71gVGusVNLdXKfsI47GItN",
                            "name": "Set Variables",
                            "title": "Log domain block action in Umbrella",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Log domain block action in Umbrella",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                  "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- Domain `$activity.definition_activity_01M94UIHSBL2Y7SNcMo08Wj6vY4mJeSr3M1.output.result_string$` will be blocked in Umbrella"
                                },
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux$",
                                  "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux$\n- Domain \"$activity.definition_activity_01M94UIHSBL2Y7SNcMo08Wj6vY4mJeSr3M1.output.result_string$\" will be blocked in Umbrella"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M8YOD4QS9XC0FZsMDlDFlAEPtupYMlDB5",
                            "name": "Add Row to Table",
                            "title": "Add action to table",
                            "type": "core.addrowtotable",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Add action to table",
                              "input_table": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHZTH4WbyBqMtwQndYYE3FmSf4x$",
                              "row": [
                                {
                                  "key": "action_name",
                                  "type": "string",
                                  "value": "umbrella_block_domain"
                                },
                                {
                                  "key": "action_data",
                                  "type": "string",
                                  "value": "$activity.definition_activity_01M8YOCE6KIHB6DjEiQ75cktR1fPBLCUe68.input.source_array[@].domain$"
                                },
                                {
                                  "key": "action_human",
                                  "type": "string",
                                  "value": "$activity.definition_activity_01M94UIHSBL2Y7SNcMo08Wj6vY4mJeSr3M1.output.result_string$"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01M8YODHQ1VJK4Ch9ocXgYFHh8AuvctnNuN",
                "name": "Read Table from JSON",
                "title": "Convert observables to table",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Convert observables to table",
                  "input_json": "$activity.definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11.output.script_queries.observables$",
                  "jsonpath_query": "$.*",
                  "persist_output": false,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "type",
                      "column_type": "string"
                    },
                    {
                      "column_name": "value",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM",
                "name": "For Each",
                "title": "For each obervable",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For each obervable",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_01M8YODHQ1VJK4Ch9ocXgYFHh8AuvctnNuN.output.read_table_from_json$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01M94VA8FDXC32lCKg1Qfl6VUMMCmgNuqxA",
                    "name": "Replace String",
                    "title": "Defang observable",
                    "type": "core.replacestring",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Defang observable",
                      "input_string": "$activity.definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM.input.source_array[@].value$",
                      "replace_list": [
                        {
                          "replaced_string": ".",
                          "replacement_string": "[.]"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M90XFJ6TJF56TbbtyZSQ2IaFWr5WmHkSL",
                    "name": "Threat Response - Deliberate Observable",
                    "title": "Threat Response - Deliberate Observable",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response - Deliberate Observable",
                      "input": {
                        "variable_workflow_01PP77MLJ2S465LuOvU8mlP8mbbcgy9uTXN": "$activity.definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM.input.source_array[@].type$",
                        "variable_workflow_01PP77MLJ2XIE1H3D67PjcsCuGBsKCCBxLI": "",
                        "variable_workflow_01PP77MLJ2ZVU1C4VxEfKYh2tlFk9iTx69p": "$activity.definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM.input.source_array[@].value$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target_group": true
                      },
                      "workflow_id": "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
                      "workflow_name": "Threat Response - Deliberate Observable"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M8YOEWPCKC440IFoDB9v104xDZV68b62t",
                    "name": "Condition Block",
                    "title": "Was this a malicious IP?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was this a malicious IP?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01M8YOF8ZKJW91QDQ8vaVWjWh7GcNGyipPW",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": {
                              "left_operand": "$activity.definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM.input.source_array[@].type$",
                              "operator": "eqi",
                              "right_operand": "ip"
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_01M90XFJ6TJF56TbbtyZSQ2IaFWr5WmHkSL.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$",
                              "operator": "eqi",
                              "right_operand": "Malicious"
                            }
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M8YOFBNWNUB48H2J5Iv69zE1eOdMCmQdW",
                            "name": "Set Variables",
                            "title": "Set malicious IP variable",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set malicious IP variable",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI20D6Sf5J6tn2Il6nQ0kcM6iGE$",
                                  "variable_value_new": "$activity.definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM.input.source_array[@].value$"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01M94KB2RP61T3deNII62g0XhNksUGSoktL",
                    "name": "Threat Response - Enrich Observable",
                    "title": "Threat Response - Enrich Observable",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response - Enrich Observable",
                      "input": {
                        "variable_workflow_01PP78TYDTQ2L5AWh7XpLPkXldkBYssq6SC": "$activity.definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM.input.source_array[@].value$",
                        "variable_workflow_01PP78TYDTTUQ6Qtv47uK5sgOFSbJ4b4Cno": "$activity.definition_activity_01M8YODV3ANKV6ygJB3jgaQSAJs4n88tpXM.input.source_array[@].type$",
                        "variable_workflow_01PP78TYDTV5R5JK6DtYaS5E95bWbZBstS5": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target_group": true
                      },
                      "workflow_id": "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
                      "workflow_name": "Threat Response - Enrich Observable"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M8YOGDDSXE26dlJEaUDPS0Lwu1sIBa1QD",
                    "name": "JSONPath Query",
                    "title": "Check for Secure Endpoint results",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Check for Secure Endpoint results",
                      "input_json": "$activity.definition_activity_01M94KB2RP61T3deNII62g0XhNksUGSoktL.output.variable_workflow_01PP78TYDTWG01QGHDq5uwDKdvEqS9CdcYg$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.data[?(@.module=='AMP for Endpoints')]",
                          "jsonpath_query_name": "ampModule",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M8YOGQ08P7X3dwkmx3DT4y194AlXIRhkS",
                    "name": "Condition Block",
                    "title": "Did we get Secure Endpoint results?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we get Secure Endpoint results?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01M8YOH1UPD443ipHIbm95tlCi5swG7XqIZ",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01M8YOGDDSXE26dlJEaUDPS0Lwu1sIBa1QD.output.succeeded$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "No",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M8YOH4M3KT75XJqP4mKSaU6SQdao1UEiC",
                            "name": "Continue",
                            "title": "Skip these results",
                            "type": "logic.continue",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Skip these results",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01M8YOHGD7KRD6CqSeXrtUR01d3t3cbnxGn",
                    "name": "Execute Python Script",
                    "title": "Extract file hashes",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Extract file hashes",
                      "script": "import sys,json\n\n# Get the module information\nampModule = json.loads(sys.argv[1])\n\n# Placeholders\nfileHashesOut = []\n\n# For each sighting...\nfor sighting in ampModule[\"data\"][\"sightings\"][\"docs\"]:\n\t# For each relationship...\n\tfor relation in sighting[\"relations\"]:\n\t\tsourceHash = { \"hash\": relation[\"source\"][\"value\"] }\n\t\tif relation[\"source\"][\"type\"] == \"sha256\" and sourceHash not in fileHashesOut:\n\t\t\tfileHashesOut.append(sourceHash)\n\t\t\n\t\trelatedHash = { \"hash\": relation[\"related\"][\"value\"] }\n\t\tif relation[\"related\"][\"type\"] == \"sha256\" and relatedHash not in fileHashesOut:\n\t\t\tfileHashesOut.append(relatedHash)\n\nfileHashesOut = json.dumps(fileHashesOut)",
                      "script_arguments": [
                        "$activity.definition_activity_01M8YOGDDSXE26dlJEaUDPS0Lwu1sIBa1QD.output.jsonpath_queries.ampModule$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "fileHashesOut",
                          "script_query_name": "fileHashes",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M8YOHSVQOV23kZsrhpSEkPG4iwXjr8Pf7",
                    "name": "Read Table from JSON",
                    "title": "Convert hashes to table",
                    "type": "corejava.read_table_from_json",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Convert hashes to table",
                      "input_json": "$activity.definition_activity_01M8YOHGD7KRD6CqSeXrtUR01d3t3cbnxGn.output.script_queries.fileHashes$",
                      "jsonpath_query": "$.*",
                      "persist_output": false,
                      "populate_columns": false,
                      "skip_execution": false,
                      "table_columns": [
                        {
                          "column_name": "hash",
                          "column_type": "string"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M8YOIL1KTL85IZw1086hqxqmtu6bqpjOT",
                    "name": "For Each",
                    "title": "For each hash",
                    "type": "logic.for_each",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "For each hash",
                      "skip_execution": false,
                      "source_array": "$activity.definition_activity_01M8YOHSVQOV23kZsrhpSEkPG4iwXjr8Pf7.output.read_table_from_json$"
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M92LEF2340L1LOiaPV8aeZ5kVWaQef87S",
                        "name": "Parallel Block",
                        "title": "Parallel Block",
                        "type": "logic.parallel",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Parallel Block",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01M92LF1L701C1s8V8wg43iGPEY7FehLfq0",
                            "name": "Parallel Branch",
                            "title": "Investigate if the hash was seen via email",
                            "type": "logic.parallel_block",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Investigate if the hash was seen via email",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01M94LP6JQGRT7NDscbGN2Ni16U47AnUMNJ",
                                "name": "Threat Response - Enrich Observable",
                                "title": "Threat Response - Enrich Observable",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Threat Response - Enrich Observable",
                                  "input": {
                                    "variable_workflow_01PP78TYDTQ2L5AWh7XpLPkXldkBYssq6SC": "$activity.definition_activity_01M8YOIL1KTL85IZw1086hqxqmtu6bqpjOT.input.source_array[@].hash$",
                                    "variable_workflow_01PP78TYDTTUQ6Qtv47uK5sgOFSbJ4b4Cno": "sha256",
                                    "variable_workflow_01PP78TYDTV5R5JK6DtYaS5E95bWbZBstS5": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
                                  "workflow_name": "Threat Response - Enrich Observable"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01M92LML87RFE5O4gLjGCMeC5F911pRplJ9",
                                "name": "JSONPath Query",
                                "title": "Check for SMA Email results",
                                "type": "corejava.jsonpathquery",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": true,
                                  "display_name": "Check for SMA Email results",
                                  "input_json": "$activity.definition_activity_01M94LP6JQGRT7NDscbGN2Ni16U47AnUMNJ.output.variable_workflow_01PP78TYDTWG01QGHDq5uwDKdvEqS9CdcYg$",
                                  "jsonpath_queries": [
                                    {
                                      "jsonpath_query": "$.data[?(@.module==\"SMA Email\")].data",
                                      "jsonpath_query_name": "smaCheck",
                                      "jsonpath_query_type": "string"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01M92LOKFJNGN39KeFj0cevpNSN4453cIzN",
                                "name": "Condition Block",
                                "title": "Did we get SMA results?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Did we get SMA results?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01M92LOVI9WA86N349xHNx5NFKowvqmS5Q3",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01M92LML87RFE5O4gLjGCMeC5F911pRplJ9.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": true
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01M92MARCTDZM0mifmVDBHuvTsNYW4kvnUo",
                                        "name": "Read Table from JSON",
                                        "title": "Convert SMA sightings to table",
                                        "type": "corejava.read_table_from_json",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "continue_on_failure": false,
                                          "display_name": "Convert SMA sightings to table",
                                          "input_json": "$activity.definition_activity_01M92LML87RFE5O4gLjGCMeC5F911pRplJ9.output.jsonpath_queries.smaCheck$",
                                          "jsonpath_query": "$.sightings.docs",
                                          "persist_output": false,
                                          "populate_columns": false,
                                          "skip_execution": false,
                                          "table_columns": [
                                            {
                                              "column_name": "relations",
                                              "column_type": "string"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01M92LRR0OY402A3NMKLEDN0vgdnA1Nu9QA",
                                        "name": "For Each",
                                        "title": "For each SMA result",
                                        "type": "logic.for_each",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "For each SMA result",
                                          "skip_execution": false,
                                          "source_array": "$activity.definition_activity_01M92MARCTDZM0mifmVDBHuvTsNYW4kvnUo.output.read_table_from_json$"
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01M92MMCIE8ZC00UOAmV4iC1Q2MyXTNh2YA",
                                            "name": "JSONPath Query",
                                            "title": "Extract email fields",
                                            "type": "corejava.jsonpathquery",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Extract email fields",
                                              "input_json": "$activity.definition_activity_01M92LRR0OY402A3NMKLEDN0vgdnA1Nu9QA.input.source_array[@].relations$",
                                              "jsonpath_queries": [
                                                {
                                                  "jsonpath_query": "$[?(@.source.type==\"email\")].source.value",
                                                  "jsonpath_query_name": "senderEmail",
                                                  "jsonpath_query_type": "string"
                                                },
                                                {
                                                  "jsonpath_query": "$[?(@.related.type==\"email_subject\")].related.value",
                                                  "jsonpath_query_name": "emailSubject",
                                                  "jsonpath_query_type": "string"
                                                },
                                                {
                                                  "jsonpath_query": "$.[?(@.relation==\"Sent_To\")].related.value",
                                                  "jsonpath_query_name": "recipientEmail",
                                                  "jsonpath_query_type": "string"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01M92MNXNJP1U7cXBNJJWlP0pRbjQrMboUy",
                                            "name": "Set Variables",
                                            "title": "Log email attributes",
                                            "type": "core.set_multiple_variables",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Log email attributes",
                                              "skip_execution": false,
                                              "variables_to_update": [
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI3452IibgyQn7Do74JqnfVYM2Z$",
                                                  "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI3452IibgyQn7Do74JqnfVYM2Z$\n\n**Source Information**\n- The file was delivered via email to: $activity.definition_activity_01M92MMCIE8ZC00UOAmV4iC1Q2MyXTNh2YA.output.jsonpath_queries.recipientEmail$\n- The subject of the message was: $activity.definition_activity_01M92MMCIE8ZC00UOAmV4iC1Q2MyXTNh2YA.output.jsonpath_queries.emailSubject$\n- The sender was: $activity.definition_activity_01M92MMCIE8ZC00UOAmV4iC1Q2MyXTNh2YA.output.jsonpath_queries.senderEmail$"
                                                }
                                              ]
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01M92LF29Y2H66BNYQLZMhJdr2lz9HXYgxv",
                            "name": "Parallel Branch",
                            "title": "Add hash to AMP SCD",
                            "type": "logic.parallel_block",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Add hash to AMP SCD",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01M8YOPUHFUHI0bdx1G4ssTiezyeugGPnbI",
                                "name": "Set Variables",
                                "title": "Log SHA256 file hash being added to AMP SCD",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Log SHA256 file hash being added to AMP SCD",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                      "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- File `$activity.definition_activity_01M8YOIL1KTL85IZw1086hqxqmtu6bqpjOT.input.source_array[@].hash$` will be added to Secure Endpoint simple custom detection list"
                                    },
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux$",
                                      "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux$\n- File \"$activity.definition_activity_01M8YOIL1KTL85IZw1086hqxqmtu6bqpjOT.input.source_array[@].hash$\" will be added to Secure Endpoint simple custom detection list"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01M8YOQ6NI2JZ0hTWlljlmA3T14FK5OYfx9",
                                "name": "Add Row to Table",
                                "title": "Add action to table",
                                "type": "core.addrowtotable",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": false,
                                  "display_name": "Add action to table",
                                  "input_table": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHZTH4WbyBqMtwQndYYE3FmSf4x$",
                                  "row": [
                                    {
                                      "key": "action_name",
                                      "type": "string",
                                      "value": "amp_scd"
                                    },
                                    {
                                      "key": "action_data",
                                      "type": "string",
                                      "value": "$activity.definition_activity_01M8YOIL1KTL85IZw1086hqxqmtu6bqpjOT.input.source_array[@].hash$"
                                    },
                                    {
                                      "key": "action_human",
                                      "type": "string",
                                      "value": "$activity.definition_activity_01M8YOIL1KTL85IZw1086hqxqmtu6bqpjOT.input.source_array[@].hash$"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01M8YOQKED78S6l3M36RhHAj4n4MC35CsSy",
                "name": "Secure Endpoint - Get Connector GUID",
                "title": "Secure Endpoint - Get Connector GUID",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Secure Endpoint - Get Connector GUID",
                  "input": {
                    "variable_workflow_01PP77C52C1JW5Pqd1VUdTlo0WKZ2UQbpgw": "$activity.definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11.output.script_queries.internalIp$",
                    "variable_workflow_01PP77C52C2RZ0GjYGmgf3zPv3tzU1zFjVM": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "AMP_Target"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01PP77C57P1EP5HkNX8Xjvr4GtJceSq4xxX",
                  "workflow_name": "Secure Endpoint - Get Connector GUID"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01M8YOR73BICL3pVqii0U7TpyIXlbLuMPOm",
                "name": "Condition Block",
                "title": "Did we get a connector GUID?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Did we get a connector GUID?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01M8YORJGRJUF3BhCNQ96tZzRCJqQofcdap",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01M8YOQKED78S6l3M36RhHAj4n4MC35CsSy.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M91219I4J5K1qQTCZH7WwxzZFQta95vaO",
                        "name": "Secure Endpoint - Get Computer by GUID",
                        "title": "Secure Endpoint - Get Computer by GUID",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Secure Endpoint - Get Computer by GUID",
                          "input": {
                            "variable_workflow_01PP74IOK1F8X1nh8wxcA1PbxvHFYsYvjdN": "$activity.definition_activity_01M8YOQKED78S6l3M36RhHAj4n4MC35CsSy.output.variable_workflow_01PP77C52C41N2AUHsNvtJ2LcGWFNMvqukW$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "AMP_Target"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP74IORHVRJ71OWWlueKVb5v2LMDNBZw1",
                          "workflow_name": "Secure Endpoint - Get Computer by GUID"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01M8YOSA0GY7T61GGUYHl05Mtif5RTaaBOD",
                        "name": "JSONPath Query",
                        "title": "Extract hostname",
                        "type": "corejava.jsonpathquery",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Extract hostname",
                          "input_json": "$activity.definition_activity_01M91219I4J5K1qQTCZH7WwxzZFQta95vaO.output.variable_workflow_01PP74IOK1ATU2Mr7s3J9OqyBQ8Zo5EGLZQ$",
                          "jsonpath_queries": [
                            {
                              "jsonpath_query": "$.hostname",
                              "jsonpath_query_name": "hostname",
                              "jsonpath_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01M8YOSMTWR2F1wAw8NNh9sfD0g65O0zVw6",
                        "name": "Set Variables",
                        "title": "Log host Isolation",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Log host Isolation",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                              "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- Endpoint `$activity.definition_activity_01M8YOSA0GY7T61GGUYHl05Mtif5RTaaBOD.output.jsonpath_queries.hostname$` will be isolated. [View Endpoint](https://console.$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$/computers/$activity.definition_activity_01M8YOQKED78S6l3M36RhHAj4n4MC35CsSy.output.variable_workflow_01PP77C52C41N2AUHsNvtJ2LcGWFNMvqukW$/trajectory2)"
                            },
                            {
                              "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux$",
                              "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux$\n- Endpoint \"$activity.definition_activity_01M8YOSA0GY7T61GGUYHl05Mtif5RTaaBOD.output.jsonpath_queries.hostname$\" will be isolated"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01M8YOSZV8SVV7ipJXH0XVsCt016mXB7MLt",
                        "name": "Add Row to Table",
                        "title": "Add action to table",
                        "type": "core.addrowtotable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Add action to table",
                          "input_table": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHZTH4WbyBqMtwQndYYE3FmSf4x$",
                          "row": [
                            {
                              "key": "action_data",
                              "type": "string",
                              "value": "$activity.definition_activity_01M8YOQKED78S6l3M36RhHAj4n4MC35CsSy.output.variable_workflow_01PP77C52C41N2AUHsNvtJ2LcGWFNMvqukW$"
                            },
                            {
                              "key": "action_human",
                              "type": "string",
                              "value": "$activity.definition_activity_01M8YOSA0GY7T61GGUYHl05Mtif5RTaaBOD.output.jsonpath_queries.hostname$"
                            },
                            {
                              "key": "action_name",
                              "type": "string",
                              "value": "amp_isolate"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01M8YOTCZQF1X6rxzOim8uMMTeCdHqPnVwa",
                "name": "Group",
                "title": "Execute Orbital queries",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Execute Orbital queries",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01M912WCI3YLC7aIWcGclangLKJGmA4BLH2",
                    "name": "Threat Response - Generate Access Token",
                    "title": "Threat Response - Generate Access Token",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response - Generate Access Token",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Orbital_For_Access_Token"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                      "workflow_name": "Threat Response - Generate Access Token"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M8YOUEPHZO03qGnkTXKbKWDutb1oV6qmi",
                    "name": "Orbital - Get logged in users",
                    "title": "Orbital - Get logged in users",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Orbital - Get logged in users",
                      "input": {
                        "variable_workflow_01PQ89Y78TFQW6l81VWArKdsXi6aTo6ttQ0": "logged_in_users",
                        "variable_workflow_01PQ89Y78TJW122COMKV4v5IaRfd0rHmKya": 2,
                        "variable_workflow_01PQ89Y78TL4S4gpTXEcizKNehfpT57GFfH": "",
                        "variable_workflow_01PQ89Y78TNHZ1ejIRsg03CgWYqamCUu6fr": "",
                        "variable_workflow_01PQ89Y78TQXF6sxdOzpuMy2ywJ5cfMO7tJ": "",
                        "variable_workflow_01PQ89Y78TS3M5dh6fdlDmbg7Le3dYWSgik": "$activity.definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11.output.script_queries.internalIp$",
                        "variable_workflow_01PQ89Y78TT7A5llxo9E9lASXTaGfke42en": "",
                        "variable_workflow_01PQ89Y78TUBI7FD5G2DozkMtabDoLrOKty": "Impact Red Workflow - Logged In User",
                        "variable_workflow_01PQ89Y78TVI01vdmVFTvVgvkyDjRy3dqcR": true,
                        "variable_workflow_01PQ89Y78TWRE5UDFeOBcXf0IXKBD4SMiNb": "",
                        "variable_workflow_01PQ89Y78TZDC3GfT8KI2vHAVvZgDEtWRpC": "$activity.definition_activity_01M912WCI3YLC7aIWcGclangLKJGmA4BLH2.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$",
                        "variable_workflow_01SW18ZLIVG2F3McJVhYbPQo4Zb3U6isvgV": "0",
                        "variable_workflow_01SW1C83X3NZY2YAbLNighlSpRdpMlD6Knq": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Orbital_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01PQ89Y7GHRYN1Po7FXaw3jvoMHv5VaAlG1",
                      "workflow_name": "Orbital - Query Endpoint"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M8YOV2PG6GX7ZEz59PmBlGpnLbbzLxCkQ",
                    "name": "Orbital - Forensic snapshot",
                    "title": "Orbital - Forensic snapshot",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Orbital - Forensic snapshot",
                      "input": {
                        "variable_workflow_01PQ89Y78TFQW6l81VWArKdsXi6aTo6ttQ0": "forensic-snapshot-windows-0.0.6",
                        "variable_workflow_01PQ89Y78TJW122COMKV4v5IaRfd0rHmKya": 2,
                        "variable_workflow_01PQ89Y78TL4S4gpTXEcizKNehfpT57GFfH": "",
                        "variable_workflow_01PQ89Y78TNHZ1ejIRsg03CgWYqamCUu6fr": "",
                        "variable_workflow_01PQ89Y78TQXF6sxdOzpuMy2ywJ5cfMO7tJ": "",
                        "variable_workflow_01PQ89Y78TS3M5dh6fdlDmbg7Le3dYWSgik": "$activity.definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11.output.script_queries.internalIp$",
                        "variable_workflow_01PQ89Y78TT7A5llxo9E9lASXTaGfke42en": "",
                        "variable_workflow_01PQ89Y78TUBI7FD5G2DozkMtabDoLrOKty": "Impact Red Workflow - Endpoint State",
                        "variable_workflow_01PQ89Y78TVI01vdmVFTvVgvkyDjRy3dqcR": false,
                        "variable_workflow_01PQ89Y78TWRE5UDFeOBcXf0IXKBD4SMiNb": "",
                        "variable_workflow_01PQ89Y78TZDC3GfT8KI2vHAVvZgDEtWRpC": "$activity.definition_activity_01M912WCI3YLC7aIWcGclangLKJGmA4BLH2.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$",
                        "variable_workflow_01SW18ZLIVG2F3McJVhYbPQo4Zb3U6isvgV": "0",
                        "variable_workflow_01SW1C83X3NZY2YAbLNighlSpRdpMlD6Knq": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Orbital_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01PQ89Y7GHRYN1Po7FXaw3jvoMHv5VaAlG1",
                      "workflow_name": "Orbital - Query Endpoint"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M976JLZFGFH206IwxbNPXBACMYuKN3rhr",
                    "name": "Condition Block",
                    "title": "Was a forensic snapshot taken?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was a forensic snapshot taken?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01M976K7DFAIO5EQFSoOvKw1dAbF162a98P",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01M8YOV2PG6GX7ZEz59PmBlGpnLbbzLxCkQ.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M975TZHBLTI4VAFKjETCrpcKvJJCmOEZM",
                            "name": "Set Variables",
                            "title": "Set Webex text",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set Webex text",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M975RRFM4FQ1wesR3Vxlu0q1zP4m6ekia$",
                                  "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M975RRFM4FQ1wesR3Vxlu0q1zP4m6ekia$\n- Endpoint state snapshot taken for `$activity.definition_activity_01M8YOB98YVW91WgiC4wd7Rdr2F7yjqXF11.output.script_queries.internalIp$`. [View Snapshot](https://orbital.$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$/jobs/$activity.definition_activity_01M8YOV2PG6GX7ZEz59PmBlGpnLbbzLxCkQ.output.variable_workflow_01PQ89Y78TPSC43P8fu58IulWhGduqgaJs1$)"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01M8YOVPSN21D2YFCdJDt2IdHzYiqFsL6uQ",
                "name": "Condition Block",
                "title": "Did the Orbital query for users work?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Did the Orbital query for users work?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01M8YOW29YAKL6zxB5IZ7iPzS20eL3zqg93",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01M8YOUEPHZO03qGnkTXKbKWDutb1oV6qmi.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M8YOW4OX0C42nLDZWOEZv7pPxaYmY68cP",
                        "name": "JSONPath Query",
                        "title": "Extract logged in user(s)",
                        "type": "corejava.jsonpathquery",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": true,
                          "display_name": "Extract logged in user(s)",
                          "input_json": "$activity.definition_activity_01M8YOUEPHZO03qGnkTXKbKWDutb1oV6qmi.output.variable_workflow_01PQ89Y78TOO45sTqV1zHz0gwOhAVGuospK$",
                          "jsonpath_queries": [
                            {
                              "jsonpath_query": "$.*.osQueryResult.*.values[0]",
                              "jsonpath_query_name": "usernames",
                              "jsonpath_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01M8YOWHNZDZX7PUqmYy6BMWRUJRQSgE0DD",
                        "name": "Condition Block",
                        "title": "Did we get any users?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Did we get any users?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01M8YOWTQ6E6R31B0ZotA0ZloZyJ6XPZfMH",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01M8YOW4OX0C42nLDZWOEZv7pPxaYmY68cP.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01M8YOWWC26HA402sb8hj6LU7asOlDbcxRP",
                                "name": "Set Variables",
                                "title": "Set user list variable",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set user list variable",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHSK30za2HeRknjk7CY1q72uwl8$",
                                      "variable_value_new": "$activity.definition_activity_01M8YOW4OX0C42nLDZWOEZv7pPxaYmY68cP.output.jsonpath_queries.usernames$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01M8YOX9BKYGK0gO937W0pYOWNudfvvD8mK",
                                "name": "Condition Block",
                                "title": "Did we get a single user or JSON?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Did we get a single user or JSON?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01M8YOXLL9U8B64xsiSvSjIVBp1aEMH8trm",
                                    "name": "Condition Branch",
                                    "title": "Single user",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHSK30za2HeRknjk7CY1q72uwl8$",
                                        "operator": "nmw",
                                        "right_operand": "*[*"
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Single user",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01M8YOXO102MY734IElSPQGXkvZE4zbTPQj",
                                        "name": "Set Variables",
                                        "title": "Convert single user list to JSON",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Convert single user list to JSON",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHSK30za2HeRknjk7CY1q72uwl8$",
                                              "variable_value_new": "[ \"$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHSK30za2HeRknjk7CY1q72uwl8$\" ]"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01M8YOY175FFH0HBfMfdCO9KzifESqSHlfb",
                                "name": "Read Table from JSON",
                                "title": "Convert users to table",
                                "type": "corejava.read_table_from_json",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": false,
                                  "display_name": "Convert users to table",
                                  "input_json": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHSK30za2HeRknjk7CY1q72uwl8$",
                                  "jsonpath_query": "$.*",
                                  "persist_output": false,
                                  "populate_columns": false,
                                  "skip_execution": false,
                                  "table_columns": [
                                    {
                                      "column_name": "username",
                                      "column_type": "string"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01M8YOYEE275X3QZD7p8VptZh97hOyNDHtJ",
                                "name": "For Each",
                                "title": "For each user",
                                "type": "logic.for_each",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "For each user",
                                  "skip_execution": false,
                                  "source_array": "$activity.definition_activity_01M8YOY175FFH0HBfMfdCO9KzifESqSHlfb.output.read_table_from_json$"
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01M8YOYSZ9F5U2oBltji9oYGk9sQio46QoL",
                                    "name": "Duo - Admin - Get User",
                                    "title": "Duo - Admin - Get User",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": true,
                                      "display_name": "Duo - Admin - Get User",
                                      "input": {
                                        "variable_workflow_01PP784U1V8FT1Cdr6lEXfiHwwbn6bsDUKT": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M951CD4SC3O1fAi8oqasNp0VbAoWd40oM$",
                                        "variable_workflow_01PP784U1V9TF27PYoY723j3qbJl7QRQOjK": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M951J0F6Z1W4DCbtjlBgBB2m1EWoRmWvG$",
                                        "variable_workflow_01PP784U1VCAA7c2VqwZKgU3scR51thmTMM": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9543OD7MN8689ZEuuDpC6kBzzNkm1XNs$",
                                        "variable_workflow_01PP784U1VDEE2cwX8GdChEsHknyHsgt6nw": "$activity.definition_activity_01M8YOYEE275X3QZD7p8VptZh97hOyNDHtJ.input.source_array[@].username$$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9511A6UEHJ7M2f9emz2a2DymCR2xOOjU$",
                                        "variable_workflow_01PP784U1VKO54wsLOPdERFQVYlMNFplLH1": "",
                                        "variable_workflow_01WGOVFD2R9IV3WHmt3FQv1oNBGz0UvRmxp": 100,
                                        "variable_workflow_01WGOVHPQYSDL02afSLQrZUEozvSAsaesyt": 0
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "Duo Security"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01PP784U9VGRC6ISP15eyRIQPnhZsDlJlJU",
                                      "workflow_name": "Duo - Admin - Get User"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01M8YOZI4XS9J5wJv5ru8a2QydIlRMy3R0G",
                                    "name": "Condition Block",
                                    "title": "Does a Duo user exist with the same username?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Does a Duo user exist with the same username?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01M8YOZU8YJ6P5rZ2RKwrGrN5g3mTCBd8LV",
                                        "name": "Condition Branch",
                                        "title": "Yes",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01M8YOYSZ9F5U2oBltji9oYGk9sQio46QoL.output.succeeded$",
                                            "operator": "eq",
                                            "right_operand": true
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "Yes",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01M8YOZXK1A3H5keObGHV3X4zzAZgrCajd4",
                                            "name": "Set Variables",
                                            "title": "Log Duo User Group change",
                                            "type": "core.set_multiple_variables",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Log Duo User Group change",
                                              "skip_execution": false,
                                              "variables_to_update": [
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                                  "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- Duo user `$activity.definition_activity_01M8YOYEE275X3QZD7p8VptZh97hOyNDHtJ.input.source_array[@].username$` will be added to the DENY group"
                                                }
                                              ]
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01M8YP0AQM6GA0JUHFWXrosHugQ311LhFCt",
                                            "name": "Add Row to Table",
                                            "title": "Add action to table",
                                            "type": "core.addrowtotable",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Add action to table",
                                              "input_table": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHZTH4WbyBqMtwQndYYE3FmSf4x$",
                                              "row": [
                                                {
                                                  "key": "action_data",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01M8YOYEE275X3QZD7p8VptZh97hOyNDHtJ.input.source_array[@].username$"
                                                },
                                                {
                                                  "key": "action_human",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01M8YOYEE275X3QZD7p8VptZh97hOyNDHtJ.input.source_array[@].username$"
                                                },
                                                {
                                                  "key": "action_name",
                                                  "type": "string",
                                                  "value": "duo_deny"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01M8YP0OXN0C36kNLDVH5Gjw20GM7jZXSTH",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01M8YOUEPHZO03qGnkTXKbKWDutb1oV6qmi.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M8YP0RTMKLY6HveZMqHMOj4XNKvWkTWUp",
                        "name": "Set Variables",
                        "title": "Log that something went wrong with Orbital",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Log that something went wrong with Orbital",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                              "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- Failed to get a list of logged in users from Orbital"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M92GL4HO2PC75b1saZoKvPQGssIs4PZDs",
            "name": "Group",
            "title": "Create approval task and send Webex message",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Create approval task and send Webex message",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01M8YP26QBAWZ3NTZLeJ7iPdrXNHPMel3Hp",
                "name": "Create Approval Request",
                "title": "Secure Firewall Impact Red remediation approval",
                "type": "task.approval_request",
                "base_type": "activity",
                "properties": {
                  "approval_choices": [
                    "Approve",
                    "Reject"
                  ],
                  "assignees": [
                    "assignee@company.com"
                  ],
                  "continue_on_failure": false,
                  "display_name": "Secure Firewall Impact Red remediation approval",
                  "due_date": {
                    "is_relative_time": true,
                    "is_specified_date": false,
                    "relative_time": {
                      "duration": 2,
                      "time_units": "hours"
                    },
                    "set_due_date": true
                  },
                  "expiration_date": {
                    "is_relative_time": true,
                    "is_specified_date": false,
                    "relative_time": {
                      "duration": 2,
                      "time_units": "hours"
                    }
                  },
                  "expiration_status": "Expired",
                  "minimum_approvals": 1,
                  "priority": "high",
                  "skip_execution": false,
                  "subject_line": "Firepower Impact Red - Remediation Approval",
                  "task_message": "Secure Firewall has created a Threat Response incident in response to an impact red event.  If you approve this task, the following actions will be taken:\n$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9794SKLYLK0uq6K5GiWE72VBppmiokux$",
                  "task_owner": "owner@company.com",
                  "task_requestor": "requestor@company.com"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01MGWAYUAITLW2gABeoaWMkkFGosC8oh4Xc",
                "name": "Condition Block",
                "title": "Was a Webex room provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was a Webex room provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01MGWAZG3886S75dCXKnUTbCcTBmNW43J34",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957Z78OZVQ1MvD22NE5E4hqMFypgaJrk$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M95APH4C13T4gCrfBOfXCPRv2DXel9b5I",
                        "name": "Webex - Search for Room",
                        "title": "Webex - Search for Room",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Webex - Search for Room",
                          "input": {
                            "variable_workflow_01PP790MCX1DN3EitpQebkUyJS65DbwS3nU": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957VHSG6C75E89EUjnSVVZNZ9gXC06Cb$",
                            "variable_workflow_01PP790MCXB392D3R8pxh9fgOTjTde2bcMW": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957Z78OZVQ1MvD22NE5E4hqMFypgaJrk$",
                            "variable_workflow_01PP790MCXHP55YE6ylOEITWsWbUFJeyWGv": "",
                            "variable_workflow_01PP790MCXM9W1MUwo85y8iNRCoQuQ4RGNa": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Webex Teams"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
                          "workflow_name": "Webex - Search for Room"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01M96XFYYJFCQ4cNLcP6eB3tkGVOmCO8T4m",
                        "name": "Condition Block",
                        "title": "Did we find the room?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Did we find the room?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01M96XGA9N6624VdV43XKQsXqOti0PFplwd",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01M95APH4C13T4gCrfBOfXCPRv2DXel9b5I.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01M96XJ9Q82GU77opWxJpYa5SSx8Qz1V929",
                                "name": "Set Variables",
                                "title": "Update the Webex room ID variable",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Update the Webex room ID variable",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                                      "variable_value_new": "$activity.definition_activity_01M95APH4C13T4gCrfBOfXCPRv2DXel9b5I.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01M95A426FKT13KUW3XBw7Kwd70wgkopU03",
                "name": "Condition Block",
                "title": "Were we able to resolve a room ID?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were we able to resolve a room ID?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01M95A4DBDWSU2SONbmJcrWp3xWugt5VaJv",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M8YP2JL99GW3lBIOxeOXxO0lIIUO3PpA8",
                        "name": "Webex - Post Message to Room",
                        "title": "Webex - Post Message to Room",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Webex - Post Message to Room",
                          "input": {
                            "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                            "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957VHSG6C75E89EUjnSVVZNZ9gXC06Cb$",
                            "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "⚠️ **APPROVAL REQUESTED FOR AUTOMATED RECOMMENDED ACTIONS**\nApproval is required for automated remediation in response to a HIGH severity security event.\n\n**Automated Investigation Results**\n- [Investigate in SecureX Threat Response](https://visibility.$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$/investigate?id=$activity.definition_activity_01M8YP1HK5H8474zYpk5qrAN6d3Cl8KFrHR.output.script_queries.incidentId$)\n- [View Workflow Run](https://$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93JRIMFUY22gYuharF546AIT7wpumtq6$/orch-ui/runs/$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.output.instance_id$) $workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M975RRFM4FQ1wesR3Vxlu0q1zP4m6ekia$\n\n**Recommended Remediation Steps**\n$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI3452IibgyQn7Do74JqnfVYM2Z$\n[Click here](https://$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93JRIMFUY22gYuharF546AIT7wpumtq6$/orch-ui/tasks/$activity.definition_activity_01M8YP26QBAWZ3NTZLeJ7iPdrXNHPMel3Hp.output.task_id$) to Approve or Deny automated remediation.",
                            "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                            "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Webex Teams"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                          "workflow_name": "Webex - Post Message to Room"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M8YP6DBNO926aKFkpKQW3ogh2hA8EhEf4",
            "name": "Wait For Event",
            "title": "Wait for approval",
            "type": "task.wait_for_event",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Wait for approval",
              "event_info": {
                "add_event": true,
                "event_definition": {
                  "conditions": {
                    "left_operand": "$output.task_id$",
                    "operator": "eq",
                    "right_operand": "$activity.definition_activity_01M8YP26QBAWZ3NTZLeJ7iPdrXNHPMel3Hp.output.task_id$"
                  }
                }
              },
              "event_timeout": 7200,
              "event_type": "approval_task.event",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01M8YP6QETH994qbQKMa8CZsY6Aglm7mfTQ",
            "name": "Condition Block",
            "title": "Was the request approved?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Was the request approved?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01M8YP72JFHGI483TLlPv4gUGdD7Zaw8dYz",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01M8YP6DBNO926aKFkpKQW3ogh2hA8EhEf4.output.response$",
                    "operator": "ne",
                    "right_operand": "Approve"
                  },
                  "continue_on_failure": true,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01M97PYB2GPSG5kRusNSFTR3VhUyoMW6Rkp",
                    "name": "Condition Block",
                    "title": "Were we able to resolve a room ID?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Were we able to resolve a room ID?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01M97PYWEV6AG4Hy1vrpSDrbWHGErRjbfBn",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M8YP7H0QZOY2BryrgjfaXPNhBuW5BgTK2",
                            "name": "Webex - Post Message to Room",
                            "title": "Webex - Post Message to Room",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Webex - Post Message to Room",
                              "input": {
                                "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                                "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957VHSG6C75E89EUjnSVVZNZ9gXC06Cb$",
                                "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "❌ **APPROVAL DENIED OR EXPIRED**\nAutomated remediation was not approved or the approval task expired.",
                                "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                                "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Webex Teams"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                              "workflow_name": "Webex - Post Message to Room"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01M95I2E3JBNK6smvMBgaDtIhq0CpOy2ML6",
                    "name": "Continue",
                    "title": "Continue",
                    "type": "logic.continue",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Continue",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M95IOAT1NXE42HIPmtHqjTWr2iIAh1rJe",
            "name": "Group",
            "title": "Handle remediation actions",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Handle remediation actions",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01M95RU21UJ3B6VhElyhSCgIsIg57ybl9Cj",
                "name": "Set Variables",
                "title": "Reset placeholder text",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Reset placeholder text",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                      "variable_value_new": ""
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01M97P6U000E21AEWhdpb9mwnqbao7z68MP",
                "name": "Condition Block",
                "title": "Were we able to resolve a room ID?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were we able to resolve a room ID?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01M97P7G9UD0Y1njcWHT0o0vLPjVSkj6P0e",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M8YP9R94TUJ2gl9r2DgzaOWUX7Gu9rsgn",
                        "name": "Webex - Post Message to Room",
                        "title": "Webex - Post Message to Room",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Webex - Post Message to Room",
                          "input": {
                            "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                            "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957VHSG6C75E89EUjnSVVZNZ9gXC06Cb$",
                            "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "✅ **APPROVAL GRANTED**\nAutomated remediation has been approved and will start now...",
                            "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                            "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Webex Teams"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                          "workflow_name": "Webex - Post Message to Room"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe",
                "name": "For Each",
                "title": "For each pending action",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For each pending action",
                  "skip_execution": false,
                  "source_array": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHZTH4WbyBqMtwQndYYE3FmSf4x$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01M8YPBT798WS7AQmWVRx2o1vjZ3SiFO33t",
                    "name": "Condition Block",
                    "title": "Which action is it?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Which action is it?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01M8YPC5FVTFR0uW66i31ZzxpeZEkgyntvi",
                        "name": "Condition Branch",
                        "title": "Umbrella block",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_name$",
                            "operator": "eqi",
                            "right_operand": "umbrella_block_domain"
                          },
                          "continue_on_failure": false,
                          "display_name": "Umbrella block",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M95LFQS406E5uTOn3kTCWuvuKnS8GrL8B",
                            "name": "Threat Response - List Response Actions",
                            "title": "Threat Response - List Response Actions",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response - List Response Actions",
                              "input": {
                                "variable_workflow_01PP74F8NFMVL1nunnh0tHmJ6q93eKENUIo": "",
                                "variable_workflow_01PP74F8NFSAR6gmDctGdu1ipiminc8zxQ9": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$",
                                "variable_workflow_01PP74F8NFTHL23oJ81CQyQ3RzEdWnabkIB": "domain"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
                              "workflow_name": "Threat Response - List Response Actions"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M95NPOCW4W06XUjNIlJckTIl3jyE2LyPo",
                            "name": "JSONPath Query",
                            "title": "Extract Umbrella actions",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Extract Umbrella actions",
                              "input_json": "$activity.definition_activity_01M95LFQS406E5uTOn3kTCWuvuKnS8GrL8B.output.variable_workflow_01PP74F8NFQWX7VN6IXaZIyIoHTzy3tJDxa$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "$.data[?(@.module==\"Umbrella\")]",
                                  "jsonpath_query_name": "trActions",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M95MFL6PBC05r30smxZYEV9TYgKeXWJGN",
                            "name": "Condition Block",
                            "title": "Were there Umbrella actions?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were there Umbrella actions?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01M95MG7416O34e7oY1daaaqWdVfKpS3NEP",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01M95NPOCW4W06XUjNIlJckTIl3jyE2LyPo.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01M960ULV5XP83T9jF8jcz3kDc2pEUgkJ3l",
                                    "name": "JSONPath Query",
                                    "title": "Extract the module ID",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Extract the module ID",
                                      "input_json": "$activity.definition_activity_01M95NPOCW4W06XUjNIlJckTIl3jyE2LyPo.output.jsonpath_queries.trActions$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[0].module_instance_id",
                                          "jsonpath_query_name": "moduleId",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01M95MN0OPXVX6AHGqlBnUKEmPz6CXtIjvo",
                                    "name": "Threat Response - Trigger Response Action",
                                    "title": "Threat Response - Trigger Response Action",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": true,
                                      "display_name": "Threat Response - Trigger Response Action",
                                      "input": {
                                        "variable_workflow_01PP78A5DV9V56KZdyeivoLTMkTbz5ekKij": "",
                                        "variable_workflow_01PP78A5DVEZD4w3lMF930OCo7g09iIEXaA": "domain",
                                        "variable_workflow_01PP78A5DVG8Z4DyPKNPwN8vRnZZjPMX6Kv": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$",
                                        "variable_workflow_01PP78A5DVHGO154mbjdWl8LrFNbWQh1BLW": "$activity.definition_activity_01M960ULV5XP83T9jF8jcz3kDc2pEUgkJ3l.output.jsonpath_queries.moduleId$",
                                        "variable_workflow_01PP78A5DVINP4cS0HN9ZngNtE0GuQBPVBv": "block"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "use_workflow_target_group": true
                                      },
                                      "workflow_id": "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
                                      "workflow_name": "Threat Response - Trigger Response Action"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01M8YPCM5ZYGW75spIKRX1acVNGPjhETBot",
                                    "name": "Set Variables",
                                    "title": "Log action taken",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Log action taken",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- Domain `$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$` blocked in Umbrella"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$\u003cbr /\u003e\n- Domain \u003ccode\u003e$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$\u003c/code\u003e blocked in Umbrella"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01M95TAID09MJ5Ttb7bvF6ou1XSipEaEvLS",
                        "name": "Condition Branch",
                        "title": "Add to Secure Endpoint SCD",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_name$",
                            "operator": "eqi",
                            "right_operand": "amp_scd"
                          },
                          "continue_on_failure": false,
                          "display_name": "Add to Secure Endpoint SCD",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M95TAJAZ0DR3G3b2MNaFoCiA8cW0dr8en",
                            "name": "Threat Response - List Response Actions",
                            "title": "Threat Response - List Response Actions",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response - List Response Actions",
                              "input": {
                                "variable_workflow_01PP74F8NFMVL1nunnh0tHmJ6q93eKENUIo": "",
                                "variable_workflow_01PP74F8NFSAR6gmDctGdu1ipiminc8zxQ9": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$",
                                "variable_workflow_01PP74F8NFTHL23oJ81CQyQ3RzEdWnabkIB": "sha256"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
                              "workflow_name": "Threat Response - List Response Actions"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M95TB472V3M7Lb35ziN372SSP5fzCippA",
                            "name": "JSONPath Query",
                            "title": "Extract Secure Endpoint SCD actions",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Extract Secure Endpoint SCD actions",
                              "input_json": "$activity.definition_activity_01M95TAJAZ0DR3G3b2MNaFoCiA8cW0dr8en.output.variable_workflow_01PP74F8NFQWX7VN6IXaZIyIoHTzy3tJDxa$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "$.data[?(@.id==\"amp-add-sha256-scd\")]",
                                  "jsonpath_query_name": "trActions",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M95TBF5H2EV4v8dXd989hlq61Sl1KN92N",
                            "name": "Condition Block",
                            "title": "Were there Secure Endpoint actions?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were there Secure Endpoint actions?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01M95TBYXML424UGQXCHfung1KGbIGaggpn",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01M95TB472V3M7Lb35ziN372SSP5fzCippA.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01M964VW00WPS0WPBjzLx2FilgLg8jDIqUM",
                                    "name": "JSONPath Query",
                                    "title": "Extract the action URL",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Extract the action URL",
                                      "input_json": "$activity.definition_activity_01M95TB472V3M7Lb35ziN372SSP5fzCippA.output.jsonpath_queries.trActions$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[0].url",
                                          "jsonpath_query_name": "actionUrl",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01M8YPD2JG2N74rDduPBjs7GH5qBfE7kAn0",
                                    "name": "HTTP Request",
                                    "title": "Add hash to simple custom detection",
                                    "type": "web-service.http_request",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "allow_auto_redirect": true,
                                      "allow_headers_redirect": false,
                                      "body": "{\n  \"type\": \"sha256\",\n  \"value\": \"$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$\"\n}",
                                      "content_type": "application/json",
                                      "continue_on_error_status_code": true,
                                      "continue_on_failure": false,
                                      "display_name": "Add hash to simple custom detection",
                                      "method": "POST",
                                      "relative_url": "iroh-response$activity.definition_activity_01M964VW00WPS0WPBjzLx2FilgLg8jDIqUM.output.jsonpath_queries.actionUrl$",
                                      "runtime_user": {
                                        "override_target_runtime_user": false,
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "use_workflow_target_group": true
                                      }
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01M8YPDG5JKTO4IFuI9bwiPob0JXEUC3fZS",
                                    "name": "Set Variables",
                                    "title": "Log action taken",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Log action taken",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- File  `$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$` added to Secure Endpoint simple custom detection list"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$\u003cbr /\u003e\n- File \u003ccode\u003e$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$\u003c/code\u003e added to Secure Endpoint simple custom detection list"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01M988BUXZY7C2oC8NVDCBjjqhLQLLsK0NJ",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01M95TB472V3M7Lb35ziN372SSP5fzCippA.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01M988CHT9OYS3Ub2tCfgoeGVvldGPoxrBd",
                                    "name": "Set Variables",
                                    "title": "Log action taken",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Log action taken",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- *ERROR:* Failed to add  `$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$` to Secure Endpoint simple custom detection list (It may already be in the list)"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$\u003cbr /\u003e\n- \u003cem\u003eERROR:\u003c/em\u003e Failed to add \u003ccode\u003e$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$\u003c/code\u003e to Secure Endpoint simple custom detection list (It may already be in the list)"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01M967E2V8TEI6VcK366mjVgDaiI2RiP7Y7",
                        "name": "Condition Branch",
                        "title": "Secure Endpoint host isolation",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_name$",
                            "operator": "eqi",
                            "right_operand": "amp_isolate"
                          },
                          "continue_on_failure": false,
                          "display_name": "Secure Endpoint host isolation",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M967E3SPMWL1GiJ0i6IKVSZScvNAwRDzc",
                            "name": "Threat Response - List Response Actions",
                            "title": "Threat Response - List Response Actions",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response - List Response Actions",
                              "input": {
                                "variable_workflow_01PP74F8NFMVL1nunnh0tHmJ6q93eKENUIo": "",
                                "variable_workflow_01PP74F8NFSAR6gmDctGdu1ipiminc8zxQ9": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$",
                                "variable_workflow_01PP74F8NFTHL23oJ81CQyQ3RzEdWnabkIB": "amp_computer_guid"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
                              "workflow_name": "Threat Response - List Response Actions"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M967F79QOP92eHx58Cj54JvHt9r1TnhQy",
                            "name": "JSONPath Query",
                            "title": "Extract Secure Endpoint isolation actions",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Extract Secure Endpoint isolation actions",
                              "input_json": "$activity.definition_activity_01M967E3SPMWL1GiJ0i6IKVSZScvNAwRDzc.output.variable_workflow_01PP74F8NFQWX7VN6IXaZIyIoHTzy3tJDxa$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "$.data[?(@.id==\"amp-start-isolation-amp-computer-guid\")]",
                                  "jsonpath_query_name": "trActions",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M967FR175X90oGpmwdUGi6UcIOYtF8qWz",
                            "name": "Condition Block",
                            "title": "Were there Secure Endpoint actions?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were there Secure Endpoint actions?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01M967G1VX7G14oNtdKOjnQBdupOnxBAK64",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01M967F79QOP92eHx58Cj54JvHt9r1TnhQy.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01M967G2OUWS76pi7Reagi5mOgy7DgsTisb",
                                    "name": "JSONPath Query",
                                    "title": "Extract the module ID",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Extract the module ID",
                                      "input_json": "$activity.definition_activity_01M967F79QOP92eHx58Cj54JvHt9r1TnhQy.output.jsonpath_queries.trActions$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[0].module_instance_id",
                                          "jsonpath_query_name": "moduleId",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01M96A4YSPBZC1HapYjgLAG4ZtOD4UQqZcq",
                                    "name": "Threat Response - Trigger Response Action",
                                    "title": "Threat Response - Trigger Response Action",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Threat Response - Trigger Response Action",
                                      "input": {
                                        "variable_workflow_01PP78A5DV9V56KZdyeivoLTMkTbz5ekKij": "",
                                        "variable_workflow_01PP78A5DVEZD4w3lMF930OCo7g09iIEXaA": "amp_computer_guid",
                                        "variable_workflow_01PP78A5DVG8Z4DyPKNPwN8vRnZZjPMX6Kv": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$",
                                        "variable_workflow_01PP78A5DVHGO154mbjdWl8LrFNbWQh1BLW": "$activity.definition_activity_01M967G2OUWS76pi7Reagi5mOgy7DgsTisb.output.jsonpath_queries.moduleId$",
                                        "variable_workflow_01PP78A5DVINP4cS0HN9ZngNtE0GuQBPVBv": "amp-start-isolation-amp-computer-guid"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "use_workflow_target_group": true
                                      },
                                      "workflow_id": "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
                                      "workflow_name": "Threat Response - Trigger Response Action"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01M8YPEKUFG5P7LPF1oMsp8221ENM11O5uQ",
                                    "name": "Set Variables",
                                    "title": "Log action taken",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Log action taken",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- Isolated host $activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$. [View Endpoint](https://console.$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$/computers/$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$/trajectory2)"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$\u003cbr /\u003e\n- Isolated host \u003ca href=\"https://console.$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$/computers/$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$/trajectory2\" target=\"_blank\"\u003e$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$\u003c/a\u003e"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01M989FYQUYL81B0vyNGtRVI41Qg0ddS0H3",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01M967F79QOP92eHx58Cj54JvHt9r1TnhQy.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01M989GVM91GL3k2Rd8JcEisuihC0pmrnIU",
                                    "name": "Set Variables",
                                    "title": "Log action taken",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Log action taken",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- *ERROR:* Could not isolate host $activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$. [View Endpoint](https://console.$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$/computers/$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$/trajectory2) (It may already be isolated)"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$",
                                          "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$\u003cbr /\u003e\n- \u003cem\u003eERROR:\u003c/em\u003e Could not isolate host \u003ca href=\"https://console.$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93K26MNY2G7I8eP6RBUygQC6PdWZWXeX$/computers/$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$/trajectory2\" target=\"_blank\"\u003e$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$\u003c/a\u003e (It may already be isolated)"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01M8YPEYECSVX7UZbPvniHq4BdnbF28Lgs0",
                        "name": "Condition Branch",
                        "title": "Duo move to DENY",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_name$",
                            "operator": "eq",
                            "right_operand": "duo_deny"
                          },
                          "continue_on_failure": false,
                          "display_name": "Duo move to DENY",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01M8YPF2C1DX97ACvotLDnNHKALvo3Bqr2d",
                            "name": "Duo - Admin - Add User to Group",
                            "title": "Duo - Admin - Add User to Group",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Duo - Admin - Add User to Group",
                              "input": {
                                "variable_workflow_01PP76HI9AZGF1NT9uSXRPPBsIFsNMg2021": "$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_data$",
                                "variable_workflow_01PP76HI9B62J0XruPcH0JljgczxK6FgDqf": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M96DE3LC5DB6fnX6PEEkJwXf54GiTOKga$",
                                "variable_workflow_01PP76HI9B79H4SCRvyaXohP09LU2Rw5JLk": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M951CD4SC3O1fAi8oqasNp0VbAoWd40oM$",
                                "variable_workflow_01PP76HI9B8ER5uvx2xW0oejzmz9Fx7tn48": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9543OD7MN8689ZEuuDpC6kBzzNkm1XNs$",
                                "variable_workflow_01PP76HI9BAV61iWqxBlc9XIIdE8u3yHG6V": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M951J0F6Z1W4DCbtjlBgBB2m1EWoRmWvG$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Duo Security"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PP76HIHLPVI6sMwWT6bvDrktdO4x5Gbc0",
                              "workflow_name": "Duo - Admin - Add User to Group"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01M8YPFPNA01V1A0YxC4Ddr1GTUL6AnNpv0",
                            "name": "Set Variables",
                            "title": "Log action taken",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Log action taken",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$",
                                  "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNHWAY327lqxtGQJ6eSh7YHSWeXC$\n- Moved user  `$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$` to [DENY group](https://$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9543OD7MN8689ZEuuDpC6kBzzNkm1XNs$/groups/$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M96DE3LC5DB6fnX6PEEkJwXf54GiTOKga$) in Duo"
                                },
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$",
                                  "variable_value_new": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$\u003cbr /\u003e\n- Moved user \u003ccode\u003e$activity.definition_activity_01M8YPBFLD0KI2WpSTK3G2BOedDOYI722Xe.input.source_array[@].action_human$\u003c/code\u003e to \u003ca href=\"https://$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M9543OD7MN8689ZEuuDpC6kBzzNkm1XNs$/groups/$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M96DE3LC5DB6fnX6PEEkJwXf54GiTOKga$\" target=\"_blank\"\u003eDENY group\u003c/a\u003e in Duo"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01M8YPG37KZV90r7VDXPr8vvfzjl3X50wGE",
                "name": "ServiceNow - Create Incident",
                "title": "ServiceNow - Create Incident",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "ServiceNow - Create Incident",
                  "input": {
                    "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "Secure Endpoint - Impact Red Remediation",
                    "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "Secure Endpoint - Impact Red Remediation",
                    "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 2,
                    "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 2,
                    "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "An approved automated investigation has completed with the following actions.\n\nThe recommendation is for IT Operations to check the machine with Enterprise approved tools per Standard Operating Procedure for a Malware Event.\n\nThe Malware Event seen by Cisco Firepower Network Security is $activity.definition_activity_01M8YO95PKX8I5Lo36GMhQmcgx1fPTK5Gix.output.jsonpath_queries.shortDescription$\n\n[code]$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M8YO6NNI0XB7j6VLFKa4PAssObiSVAckz$[/code]\n- [code]\u003ca href=\"https://$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M93JRIMFUY22gYuharF546AIT7wpumtq6$/orch-ui/runs/$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.output.instance_id$\" target=\"_blank\"\u003eView SecureX Orchestration Workflow\u003c/a\u003e[/code]",
                    "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "securex-orchestration",
                    "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "ServiceNow"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
                  "workflow_name": "ServiceNow - Create Incident"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01M97QCGKFJTY4PJvmQgf7sez4uAD3HWCo9",
                "name": "Condition Block",
                "title": "Were we able to resolve a room ID?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were we able to resolve a room ID?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01M97QD2WG9A95QgAtAimjtoE1FE85TIkDG",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M8YPGRMAYTS3vXIZ3oqUoUhbqVE5gZynh",
                        "name": "Webex - Post Message to Room",
                        "title": "Webex - Post Message to Room",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Webex - Post Message to Room",
                          "input": {
                            "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M95AVKWB2ZL6LEDAUP2P7QzXV2oXUBvtP$",
                            "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M957VHSG6C75E89EUjnSVVZNZ9gXC06Cb$",
                            "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "$workflow.definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK.local.variable_workflow_01M975RRFM4FQ1wesR3Vxlu0q1zP4m6ekia$",
                            "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                            "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Webex Teams"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                          "workflow_name": "Webex - Post Message to Room"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "triggers": {
    "triggerschedule_01M9VM6VPDFJ67T2ZU01iZunkwKNJGpRE4X": {
      "workflow_id": "definition_workflow_01M8YO6NV4TVT6c3JgFxA4BI7ZVhP3LToQK",
      "name": "Firepower Impact Red Incident Polling",
      "title": "",
      "lowercase_name": "schedule.firepower_impact_red_incident_polling",
      "type": "schedule",
      "base_type": "trigger",
      "ref_id": "schedule_01M9VLMMAYOS50nuKYP4IdhMSfubJYCi4dp",
      "version": "1.0.0",
      "disabled": true,
      "unique_name": "triggerschedule_01M9VM6VPDFJ67T2ZU01iZunkwKNJGpRE4X",
      "object_type": "triggerschedule"
    }
  },
  "schedules": {
    "schedule_01M9VLMMAYOS50nuKYP4IdhMSfubJYCi4dp": {
      "unique_name": "schedule_01M9VLMMAYOS50nuKYP4IdhMSfubJYCi4dp",
      "name": "0013 - Firepower - Impact Red Remediation",
      "description": "This schedule is used to check for new Firepower Impact Red incidents in Threat Response",
      "type": "basic.schedule",
      "base_type": "schedule",
      "properties": {
        "calendar": "calendar_recurring_1BMfMWvgiDhSjBQ7hTSyvz3NyVZ",
        "timezone": "Etc/GMT+0",
        "starttime": "00:00",
        "interval_hours": 0,
        "interval_minutes": 10,
        "number_of_times": 144,
        "display_name": "0013 - Firepower - Impact Red Remediation",
        "description": "This schedule is used to check for new Firepower Impact Red incidents in Threat Response"
      },
      "version": "1.0.0",
      "object_type": "schedule"
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "table_types": {
    "tabletype_01IM6TQ2VAES81TigWJDmN9aTwjMfRiIH6F": {
      "unique_name": "tabletype_01IM6TQ2VAES81TigWJDmN9aTwjMfRiIH6F",
      "data_type": "datatype.tabletype",
      "display_name": "Remediation Tasks",
      "columns": [
        {
          "name": "action_name",
          "title": "action_name",
          "type": "string"
        },
        {
          "name": "action_data",
          "title": "action_data",
          "type": "string"
        },
        {
          "name": "action_human",
          "title": "action_human",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
    "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
    "definition_workflow_01PP76HIHLPVI6sMwWT6bvDrktdO4x5Gbc0",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
    "definition_workflow_01PP74IORHVRJ71OWWlueKVb5v2LMDNBZw1",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
    "definition_workflow_01PQ89Y7GHRYN1Po7FXaw3jvoMHv5VaAlG1",
    "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
    "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
    "definition_workflow_01PP77C57P1EP5HkNX8Xjvr4GtJceSq4xxX",
    "definition_workflow_01PP784U9VGRC6ISP15eyRIQPnhZsDlJlJU",
    "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH"
  ],
  "dependent_workflows": [
    "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
    "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
    "definition_workflow_01PP77C57P1EP5HkNX8Xjvr4GtJceSq4xxX",
    "definition_workflow_01PP74IORHVRJ71OWWlueKVb5v2LMDNBZw1",
    "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
    "definition_workflow_01PQ89Y7GHRYN1Po7FXaw3jvoMHv5VaAlG1",
    "definition_workflow_01PP784U9VGRC6ISP15eyRIQPnhZsDlJlJU",
    "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
    "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
    "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
    "definition_workflow_01PP76HIHLPVI6sMwWT6bvDrktdO4x5Gbc0",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW"
  ]
}