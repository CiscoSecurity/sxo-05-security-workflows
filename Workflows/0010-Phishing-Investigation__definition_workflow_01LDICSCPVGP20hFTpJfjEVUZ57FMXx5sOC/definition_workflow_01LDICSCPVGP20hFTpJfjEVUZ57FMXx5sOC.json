{
  "workflow": {
    "unique_name": "definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC",
    "name": "0010 - Phishing Investigation",
    "title": "0010 - Phishing Investigation",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Threat Grid Threat Score",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.date",
        "properties": {
          "value": "0001-01-01T00:00:00+00:00",
          "scope": "local",
          "name": "Threat Response Token Time",
          "type": "datatype.date",
          "description": "The time at which the most recent access token was fetched from Threat Response",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LR9OX967DM22CD3q0QQKBsZKf9pReRVCc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Unknown",
          "scope": "local",
          "name": "Phish Recipients",
          "type": "datatype.string",
          "description": "The recipients of the email that was submitted for investigation. This is something we attempt to extract from the attachment headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LG4HDZ009225imFLWhsAxjpJBuXZ2RxHT",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Phishing Investigation Outgoing",
          "scope": "local",
          "name": "SMTP Target Name",
          "type": "datatype.string",
          "description": "The name of the SMTP target you want to use when sending outgoing mail",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LPOXBYCDKW02bO7NucoinbfQKdHJjLfRu",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Access Token",
          "type": "datatype.secure_string",
          "description": "The current Threat Response access token",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LR9OLL4JHL86LeCidHSI0HxRbuTgtisu1",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Malicious Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Malicious disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the Threat Response environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Clean Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Clean disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LGYIGNL764O6e6Ge5cmuGi0m766DQgdTC",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Ticket Text",
          "type": "datatype.string",
          "description": "Placeholder used throughout the workflow to compile information for Threat Response casebooks and incidents",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "SecureX Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the SecureX environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLKUF7R3TFDHTFVtSJMW1Pb0w9D",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_01KXKQ1CSRGVL7ZpP6ogcjNI0ADUjMVnIl5",
        "properties": {
          "scope": "local",
          "name": "Observables Table",
          "type": "datatype.table",
          "description": "A table containing observables found during the investigation",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Unknown Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Unknown disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LGYM9HYUS0T5tnd0alUn2JbXGhc0RxCID",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Teams Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex Teams API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLJRV47QVDw1J8FWKogMqJWCDk6",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Suspicious Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Suspicious disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Consolidated Headers",
          "type": "datatype.string",
          "description": "Placeholder uses to compile a list of email headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLEQ84yY8NaZt1Oy244ZApGAcJj",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "someone@domain.com",
          "scope": "local",
          "name": "Notification Email Addresses",
          "type": "datatype.string",
          "description": "List of email addresses to send investigation notifications to. The email addresses should either be comma separated or each on their own line",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LEI57J5RYLC77T77OWmjwU64kDd6EuDDp",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Grid API Key",
          "type": "datatype.secure_string",
          "description": "The API key to use with Threat Grid. You can either set this here (and remove this variable from the Fetch Global Variables activity) or you can use the Fetch Global Variables activity to update this variable with an existing API key from a global variable",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLD3P2rqquAOD3fcHB0KFKvPYvO",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Unknown",
          "scope": "local",
          "name": "Phish Sender",
          "type": "datatype.string",
          "description": "The sender of the email that was submitted for investigation. This is something we attempt to extract from the attachment headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LG3GJ9F9M5S2Qxe4US0DM83k8vstM2cye",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Threat Grid Submissions",
          "type": "datatype.integer",
          "description": "How many files and URLs were submitted to Threat Grid for analysis during the investigation",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LGYMI6C66CI2DaD7QJ5OOD7FVtwPeaPCe",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "SecureX Orchestration",
          "scope": "local",
          "name": "Webex Teams Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex Teams room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLLPMP7MNZ3m0TsDTLgF2JcMe5uS",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Unknown",
          "scope": "local",
          "name": "Phish Subject",
          "type": "datatype.string",
          "description": "The subject of the email that was submitted for investigation. This is something we attempt to extract from the attachment headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LG4CXZB1PS85vMbaUCSTf8j02SCyIImgV",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Has Email Attachment",
          "type": "datatype.boolean",
          "description": "Whether or not the email sent for investigation has an email attached to it. Since we want users to forward the suspicious email as an attachment, we check to make sure this is true after the attachments are processed",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LNOZTJ31BEI0MEzcHHscPBKxGKtR7fAJE",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Observables JSON",
          "type": "datatype.string",
          "description": "Placeholder used to build a JSON list of observables found during the investigation",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LDICSBLL7DK7UYAjRXpksRudsOQVn67Hs",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Grid Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the Threat Grid environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LWAHHD506RJ7C8r17PWhETuCv94RscDrJ",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow monitors a mailbox for incoming suspicious email reports. When an email is received, the workflow investigates its attachments and attempts to determine if anything in the email (or its attachments) was suspicious or malicious. If anything suspicious or malicious is found, the user is told to delete the email, a casebook and incident are created in Threat Response, a Webex Teams message is posted, and an email is sent to a \"SOC\" email address.\n\nTarget Group: Default TargetGroup\n\nTargets: CTR_API, CTR_For_Access_Token, Phishing Investigation Mailbox, Phishing Investigation Outgoing, Private_CTIA_Target, ThreatGrid_Target, Webex Teams\n\nSteps:\nPlease see: https://cs.co/SXO_docs",
      "display_name": "0010 - Phishing Investigation",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint",
            "email.smtp_endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01LDICU4XL9O756jHuQf6aSx06F1W450nfI",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch global variables",
          "skip_execution": true
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LDICUDWY9AV7TOWzPuYKJOnv7lYGXIHMn",
            "name": "Set Variables",
            "title": "Fetch global variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch global variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLJRV47QVDw1J8FWKogMqJWCDk6$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLD3P2rqquAOD3fcHB0KFKvPYvO$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LELBL1QBA3P7Sblcwt9qyy4QBQILpMgl4",
        "name": "Condition Block",
        "title": "Set the environment URLs",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set the environment URLs",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LELBL7PQBQN3rKtCICeHBTngyQS3z3YNh",
            "name": "Condition Branch",
            "title": "Prod NAM",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-nam"
              },
              "continue_on_failure": false,
              "display_name": "Prod NAM",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LELC33QMIVS6DUX2g8LTA1L07yjnCkIqE",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLKUF7R3TFDHTFVtSJMW1Pb0w9D$",
                      "variable_value_new": "securex-ao.us.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe$",
                      "variable_value_new": "visibility.amp.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LWAHHD506RJ7C8r17PWhETuCv94RscDrJ$",
                      "variable_value_new": "panacea.threatgrid.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LELCF63S21L4A7U8mktcJIp4PzHadpc4H",
            "name": "Condition Branch",
            "title": "Prod EU",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-eu"
              },
              "continue_on_failure": false,
              "display_name": "Prod EU",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LELCF902AYU1MYCydjdNLSBkS7CjaKTzU",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLKUF7R3TFDHTFVtSJMW1Pb0w9D$",
                      "variable_value_new": "securex-ao.eu.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe$",
                      "variable_value_new": "visibility.eu.amp.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LWAHHD506RJ7C8r17PWhETuCv94RscDrJ$",
                      "variable_value_new": "panacea.threatgrid.eu"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LELCLUQIUB54YYk4spXgVQRIZFCAtALCP",
            "name": "Condition Branch",
            "title": "Prod APJC",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-apjc"
              },
              "continue_on_failure": false,
              "display_name": "Prod APJC",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LELCLXBOUV35oM9jGlIveDI5BVmlHhzKX",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLKUF7R3TFDHTFVtSJMW1Pb0w9D$",
                      "variable_value_new": "securex-ao.apjc.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe$",
                      "variable_value_new": "visibility.apjc.amp.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LWAHHD506RJ7C8r17PWhETuCv94RscDrJ$",
                      "variable_value_new": "panacea.threatgrid.eu"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LNOZVXZLAYB3weSX7ZEdhpPoypus8bmgc",
        "name": "For Each",
        "title": "For each attachment",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For each attachment",
          "skip_execution": false,
          "source_array": "$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.attachments$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LNP03EQFLC04Ev7mYxdDnUYl5JwRofhEc",
            "name": "Condition Block",
            "title": "Is this attachment an email?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is this attachment an email?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LNP03I4D7J4064d4VhiKjELtZWbd6Wm1a",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01LNOZVXZLAYB3weSX7ZEdhpPoypus8bmgc.input.source_array[@].is_email_type$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LNP05ERPIXD6wDdpRk3uXOefSxWbw3Bnr",
                    "name": "Set Variables",
                    "title": "Set local variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LNOZTJ31BEI0MEzcHHscPBKxGKtR7fAJE$",
                          "variable_value_new": true
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LDICV9DG0C37St1z9kejoEnCPEnvU4oEy",
        "name": "Condition Block",
        "title": "Does the email have an email attachment",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Does the email have an email attachment",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LDICVG0QNT02YsGBDJqd11upfehZZwpNU",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LNOZTJ31BEI0MEzcHHscPBKxGKtR7fAJE$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LDICW0WP2UR5Cs1cmHM3xTnGVrQMr1VqY",
                "name": "Send Email",
                "title": "Send user confirmation of receipt",
                "type": "email.smtp_send_email",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "body": "Hello!\n\nThe email you submitted for review with the subject \"$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.subject$\" is being processed.\n\nWhile we investigate, please do not open or share the message. Once we determine whether or not the email is safe, we will get back to you.\n\n\nReference ID: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.instance_id$",
                  "continue_if_one_address_valid": false,
                  "continue_on_failure": true,
                  "display_name": "Send user confirmation of receipt",
                  "html": false,
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "subject": "Suspicious email submission received",
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LPOXBYCDKW02bO7NucoinbfQKdHJjLfRu$"
                          }
                        ]
                      }
                    }
                  },
                  "to": "$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.sender$"
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LDICWBCYWKK4MysI8WHiANMmBeozfxG4y",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LNOZTJ31BEI0MEzcHHscPBKxGKtR7fAJE$",
                "operator": "eq",
                "right_operand": false
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LDICWVW3VN30eZgDGjJQBX6eXCT3mG1bg",
                "name": "Send Email",
                "title": "Reply to user asking for attachment",
                "type": "email.smtp_send_email",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "body": "Hello!\n\nThe email you submitted for review with the subject \"$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.subject$\" did not contain any email attachments.\n\nPlease re-submit the suspicious email by forwarding it as an attachment or, if available, by using the \"Report Suspicious Email\" button in your email client.\n\n\nReference ID: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.instance_id$",
                  "continue_if_one_address_valid": false,
                  "continue_on_failure": false,
                  "display_name": "Reply to user asking for attachment",
                  "html": false,
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "subject": "Suspicious email submission rejected",
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LPOXBYCDKW02bO7NucoinbfQKdHJjLfRu$"
                          }
                        ]
                      }
                    }
                  },
                  "to": "$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.sender$"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LGA0JXLLA6U38KUW45EZxvHVqYiWNnrk0",
                "name": "Group",
                "title": "Update statistics table",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Update statistics table",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LGZT8H2M8GL0uWIBzY5VxIw04fhbUDkiG",
                    "name": "Add Row to Table",
                    "title": "Add row to statistics table",
                    "type": "core.addrowtotable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Add row to statistics table",
                      "input_table": "$global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ.global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ$",
                      "row": [
                        {
                          "key": "observables_clean",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYIGNL764O6e6Ge5cmuGi0m766DQgdTC$"
                        },
                        {
                          "key": "observables_suspicious",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$"
                        },
                        {
                          "key": "observables_malicious",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$"
                        },
                        {
                          "key": "observables_unknown",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYM9HYUS0T5tnd0alUn2JbXGhc0RxCID$"
                        },
                        {
                          "key": "threatgrid_submissions",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYMI6C66CI2DaD7QJ5OOD7FVtwPeaPCe$"
                        },
                        {
                          "key": "start_time",
                          "type": "date",
                          "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.start_time$"
                        },
                        {
                          "key": "end_time",
                          "type": "date",
                          "value": "$activity.definition_activity_01LDICWVW3VN30eZgDGjJQBX6eXCT3mG1bg.output.end_time$"
                        },
                        {
                          "key": "num_attachments",
                          "type": "integer",
                          "value": "$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.attachments_count$"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LDICXQKB8OX5bozCeX2UY3rReSOdzYcdx",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LKK9DDNL03D2AGM1ETS7WtSuKl4bLhvDR",
        "name": "Set Variables",
        "title": "Add the workflow instance ID to the ticket text",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Add the workflow instance ID to the ticket text",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
              "variable_value_new": "Workflow Instance ID: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.instance_id$"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01LDICXX3CGK752opyzMjy8Xa9tUXjfD536",
        "name": "Group",
        "title": "Inspect attachments",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Inspect attachments",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt",
            "name": "For Each",
            "title": "For each attachment",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each attachment",
              "skip_execution": false,
              "source_array": "$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.attachments$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LDICYHJ8NPJ2EihmODHpE14mYouDh8Cql",
                "name": "Set Variables",
                "title": "Update ticket text and reset consolidated headers",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Update ticket text and reset consolidated headers",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                      "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n\n**Processing attachment \"$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_name$\"**\n* Attachment hash: $activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLEQ84yY8NaZt1Oy244ZApGAcJj$",
                      "variable_value_new": ""
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LDICYUDFR1Q1l5lZ9g6lFtD59Gv5ViTH6",
                "name": "Threat Response v2 - Generate Access Token",
                "title": "Threat Response v2 - Generate Access Token",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response v2 - Generate Access Token",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "CTR_For_Access_Token"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LR9PJCH86ES1MAqlQoo26TfNj3rfNdLCx",
                "name": "Set Variables",
                "title": "Update token variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Update token variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OLL4JHL86LeCidHSI0HxRbuTgtisu1$",
                      "variable_value_new": "$activity.definition_activity_01LDICYUDFR1Q1l5lZ9g6lFtD59Gv5ViTH6.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OX967DM22CD3q0QQKBsZKf9pReRVCc$",
                      "variable_value_new": "$activity.definition_activity_01LDICYUDFR1Q1l5lZ9g6lFtD59Gv5ViTH6.output.end_time$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LDICZ3KM0U50V2sJLGmsGBVa9cKPPSmaw",
                "name": "Condition Block",
                "title": "Is this attachment an email?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Is this attachment an email?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LDICZA3NAOL44gCSyDZVTwZWGHLa1thzL",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].is_email_type$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LDICZIFV59J5ltJKq87CPERo121DPqTCB",
                        "name": "Group",
                        "title": "Inspect email content",
                        "type": "logic.group",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Inspect email content",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LDICZRA17IC0CPyp1WFhrhzJEUIsInfxX",
                            "name": "Read Table from JSON",
                            "title": "Parse headers to table",
                            "type": "corejava.read_table_from_json",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Parse headers to table",
                              "input_json": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].attachment_headers$",
                              "jsonpath_query": "$.",
                              "persist_output": false,
                              "populate_columns": false,
                              "skip_execution": false,
                              "table_columns": [
                                {
                                  "column_name": "header_name",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "header_value",
                                  "column_type": "string"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LDID02XU9XV0uVf1XztO5t75TxWvcZg0Z",
                            "name": "For Each",
                            "title": "For each header",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "For each header",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01LDICZRA17IC0CPyp1WFhrhzJEUIsInfxX.output.read_table_from_json$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LDID0G248MZ3pKxRiLx4g3bgfdQUvq64J",
                                "name": "Set Variables",
                                "title": "Add this header's value to local variable",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Add this header's value to local variable",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLEQ84yY8NaZt1Oy244ZApGAcJj$",
                                      "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLEQ84yY8NaZt1Oy244ZApGAcJj$ $activity.definition_activity_01LDID02XU9XV0uVf1XztO5t75TxWvcZg0Z.input.source_array[@].header_value$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LDID0SXXY9M0AbO4m7SeKnQ2XNUo30xgd",
                            "name": "Threat Response v2 - Inspect for Observables",
                            "title": "Threat Response v2 - Inspect for Observables",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response v2 - Inspect for Observables",
                              "input": {
                                "variable_workflow_01KXGKYZX7V1M2gr9pVGA5BZoTbgEQPSzF1": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OLL4JHL86LeCidHSI0HxRbuTgtisu1$",
                                "variable_workflow_01KXGKYZX7ZLN1hoeZeh7hwWyjoEUkSJCbg": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].attachment_raw_body$ $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLEQ84yY8NaZt1Oy244ZApGAcJj$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01KXGKZ0JA96P0p7omD4IdS6zKdw5ECiofU"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LDID13KIM8R0X2yNUrLfRJcTgbGAD45t5",
                            "name": "Read Table from JSON",
                            "title": "Convert observables to table",
                            "type": "corejava.read_table_from_json",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Convert observables to table",
                              "input_json": "$activity.definition_activity_01LDID0SXXY9M0AbO4m7SeKnQ2XNUo30xgd.output.variable_workflow_01KXGKYZX80T50ocjT0xlIvdikhoR0AGB5u$",
                              "jsonpath_query": "$.",
                              "persist_output": false,
                              "populate_columns": false,
                              "skip_execution": false,
                              "table_columns": [
                                {
                                  "column_name": "type",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "value",
                                  "column_type": "string"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LDPFUGT6EEM6wUBVy5ooDw6AGGPQ9nzUl",
                            "name": "Set Variables",
                            "title": "Update ticket text",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Update ticket text",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                  "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Parsing attachment as an email\n* $activity.definition_activity_01LDICZRA17IC0CPyp1WFhrhzJEUIsInfxX.output.row_count$ email headers will be inspected\n* $activity.definition_activity_01LDID13KIM8R0X2yNUrLfRJcTgbGAD45t5.output.row_count$ observables were extracted using Threat Response"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07",
                            "name": "JSONPath Query",
                            "title": "Extract information about the email",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Extract information about the email",
                              "input_json": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].attachment_headers$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "$.[?(@.header_name==\"From\")].header_value",
                                  "jsonpath_query_name": "sender_raw",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "$.[?(@.header_name==\"Subject\")].header_value",
                                  "jsonpath_query_name": "subject",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "$.[?(@.header_name==\"To\")].header_value",
                                  "jsonpath_query_name": "recipients",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LG3J1SFXC0U1qXbavmoaVRyv4gautcHeE",
                            "name": "Condition Block",
                            "title": "Were we able to extract the values?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were we able to extract the values?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01LG3J1XUFZWO3MImhbRM4Yskw1auRaQaCA",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01LG3JJYE5R4P2VUJZSVGmidyGNomUKqZ3W",
                                    "name": "Match Regex",
                                    "title": "Match email regex",
                                    "type": "core.matchregex",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Match email regex",
                                      "input_regex": "(?:[a-z0-9!#$%&'*+\\/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+\\/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])",
                                      "input_string": "$activity.definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07.output.jsonpath_queries.sender_raw$",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01LG3JMNPP7FY76PVSZGJQG3D87H1RSl908",
                                    "name": "Set Variables",
                                    "title": "Set local variables",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set local variables",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG3GJ9F9M5S2Qxe4US0DM83k8vstM2cye$",
                                          "variable_value_new": "$activity.definition_activity_01LG3JJYE5R4P2VUJZSVGmidyGNomUKqZ3W.output.matching_strings[0]$"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4CXZB1PS85vMbaUCSTf8j02SCyIImgV$",
                                          "variable_value_new": "$activity.definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07.output.jsonpath_queries.subject$"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                          "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Sender: $activity.definition_activity_01LG3JJYE5R4P2VUJZSVGmidyGNomUKqZ3W.output.matching_strings[0]$\n* Subject: $activity.definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07.output.jsonpath_queries.subject$\n* Recipients: $activity.definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07.output.jsonpath_queries.recipients$"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4HDZ009225imFLWhsAxjpJBuXZ2RxHT$",
                                          "variable_value_new": "$activity.definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07.output.jsonpath_queries.recipients$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MJ6QHJMF5YD3iYee5CY50xF20pME7AsLK",
                                    "name": "Add Row to Table",
                                    "title": "Add email subject to observable table",
                                    "type": "core.addrowtotable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Add email subject to observable table",
                                      "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                      "row": [
                                        {
                                          "key": "value",
                                          "type": "string",
                                          "value": "$activity.definition_activity_01LG3I6Y61OCB1jzerLI7QAeX5cv49taP07.output.jsonpath_queries.subject$"
                                        },
                                        {
                                          "key": "disposition",
                                          "type": "string",
                                          "value": "Unknown"
                                        },
                                        {
                                          "key": "type",
                                          "type": "string",
                                          "value": "email_subject"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MJE3BHIEDP92fL2iR02X0iPuuoXhNo1el",
                                    "name": "Add Row to Table",
                                    "title": "Add email sender to observable table",
                                    "type": "core.addrowtotable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Add email sender to observable table",
                                      "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                      "row": [
                                        {
                                          "key": "value",
                                          "type": "string",
                                          "value": "$activity.definition_activity_01LG3JJYE5R4P2VUJZSVGmidyGNomUKqZ3W.output.matching_strings[0]$"
                                        },
                                        {
                                          "key": "disposition",
                                          "type": "string",
                                          "value": "Unknown"
                                        },
                                        {
                                          "key": "type",
                                          "type": "string",
                                          "value": "email"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw",
                            "name": "For Each",
                            "title": "For each observable",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "For each observable",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01LDID13KIM8R0X2yNUrLfRJcTgbGAD45t5.output.read_table_from_json$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LDPAYG56L445i6IyR2dC398pgse1zCEz8",
                                "name": "Select from Table",
                                "title": "Check if this observable already in table",
                                "type": "core.selectfromtable",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "columns": [
                                    {
                                      "column_name": "type",
                                      "column_type": "string"
                                    },
                                    {
                                      "column_name": "value",
                                      "column_type": "string"
                                    },
                                    {
                                      "column_name": "disposition",
                                      "column_type": "string"
                                    }
                                  ],
                                  "continue_on_failure": false,
                                  "display_name": "Check if this observable already in table",
                                  "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                  "number_of_rows": {
                                    "all_rows": true,
                                    "at_most": false
                                  },
                                  "persist_output": false,
                                  "skip_execution": false,
                                  "sorting": {
                                    "no_sort": true,
                                    "sort_by": false
                                  },
                                  "where_clause": "value == '$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$' AND type == '$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].type$'"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LDPB0TJDOGN4K4bYHI5ajr1yDJuMrxnS5",
                                "name": "Condition Block",
                                "title": "Is the observable already in the table?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Is the observable already in the table?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LDPB0XYNV5S7kxAFMJgTb56okgDoR7Tsi",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LDPAYG56L445i6IyR2dC398pgse1zCEz8.output.row_count$",
                                        "operator": "eq",
                                        "right_operand": 0
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LRA0F1SQBEU1xqwVQyCy3J45WNueo7VX2",
                                        "name": "Calculate Date Time Difference",
                                        "title": "Calculate Threat Response token age",
                                        "type": "core.calculate_date_time_difference",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Calculate Threat Response token age",
                                          "original_date": "$activity.definition_activity_01LDPAYG56L445i6IyR2dC398pgse1zCEz8.output.end_time$",
                                          "skip_execution": false,
                                          "subtract_date": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OX967DM22CD3q0QQKBsZKf9pReRVCc$"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LRA0CRYHSA25MQpqV4Afmhqf0bydUURiQ",
                                        "name": "Condition Block",
                                        "title": "Does the token need to be renewed?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Does the token need to be renewed?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01LRA0CWO99WF6b0K5uzmEbpGeRuLrjge01",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01LRA0F1SQBEU1xqwVQyCy3J45WNueo7VX2.output.total_minutes$",
                                                "operator": "gt",
                                                "right_operand": 8
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LRA0K5KGZCH5uLtcBvqRfnwlIjv4ZX4dq",
                                                "name": "Threat Response v2 - Generate Access Token",
                                                "title": "Threat Response v2 - Generate Access Token",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Threat Response v2 - Generate Access Token",
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "CTR_For_Access_Token"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01LRA0QE4V9CO47caDhHviafQtNQ0BF1u7m",
                                                "name": "Set Variables",
                                                "title": "Update token variables",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Update token variables",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OLL4JHL86LeCidHSI0HxRbuTgtisu1$",
                                                      "variable_value_new": "$activity.definition_activity_01LRA0K5KGZCH5uLtcBvqRfnwlIjv4ZX4dq.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                                                    },
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OX967DM22CD3q0QQKBsZKf9pReRVCc$",
                                                      "variable_value_new": "$activity.definition_activity_01LRA0K5KGZCH5uLtcBvqRfnwlIjv4ZX4dq.output.end_time$"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "unique_name": "definition_activity_01LDID21CDWBE2ED1xJBjk7hEsXBeysDs2k",
                                        "name": "Threat Response v2 - Get Deliberate Verdict",
                                        "title": "Threat Response v2 - Get Deliberate Verdict",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Threat Response v2 - Get Deliberate Verdict",
                                          "input": {
                                            "variable_workflow_01KXGQWL4TDTE02Mxh65PHxstnnK3wTcCF2": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OLL4JHL86LeCidHSI0HxRbuTgtisu1$",
                                            "variable_workflow_01KXGQWL4THYI5hexa4Ip4LW0UZIJhk4ejv": "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].type$",
                                            "variable_workflow_01KXGQWL4TLPV5NbUAlHHHQUcco57lEijh9": "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LDID2DHG5IZ4i8x7O29FlCAssu0zTE8JB",
                                        "name": "Add Row to Table",
                                        "title": "Add observable to table",
                                        "type": "core.addrowtotable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "continue_on_failure": false,
                                          "display_name": "Add observable to table",
                                          "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                          "row": [
                                            {
                                              "key": "type",
                                              "type": "string",
                                              "value": "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].type$"
                                            },
                                            {
                                              "key": "value",
                                              "type": "string",
                                              "value": "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$"
                                            },
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "$activity.definition_activity_01LDID21CDWBE2ED1xJBjk7hEsXBeysDs2k.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                                            }
                                          ],
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LKKCKNT59XN20QTQBTxOquHjkwBJwp1pW",
                                        "name": "Replace String",
                                        "title": "Clean the observable",
                                        "type": "core.replacestring",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Clean the observable",
                                          "input_string": "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$",
                                          "replace_list": [
                                            {
                                              "replaced_string": ".",
                                              "replacement_string": "[.]"
                                            }
                                          ],
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LDID3R80JYJ6Tvq0zKNJpQMMilOz8NSao",
                                        "name": "Set Variables",
                                        "title": "Update ticket text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update ticket text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Observable \"$activity.definition_activity_01LKKCKNT59XN20QTQBTxOquHjkwBJwp1pW.output.result_string$\" ($activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].type$) disposition: $activity.definition_activity_01LDID21CDWBE2ED1xJBjk7hEsXBeysDs2k.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LKL4L7NE7ZL1TVpSHUBAiFsunOjo3b8VG",
                                        "name": "Condition Block",
                                        "title": "Is the observable a URL with a 2 character TLD?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Is the observable a URL with a 2 character TLD?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01LKL4LGDELFH6wsGN3UjBodyDG3iOSYh2X",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": {
                                                  "left_operand": "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].type$",
                                                  "operator": "eqi",
                                                  "right_operand": "url"
                                                },
                                                "operator": "and",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$",
                                                  "operator": "mregex",
                                                  "right_operand": "^http(s)?:\\/\\/(www\\.)?[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2}(\\/.*)?$"
                                                }
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LKOYKBT0CY46MsKbSVX288arziBzzUDHD",
                                                "name": "Execute Python Script",
                                                "title": "Execute GET request to the URL",
                                                "type": "python3.script",
                                                "base_type": "activity",
                                                "properties": {
                                                  "action_timeout": 180,
                                                  "continue_on_failure": false,
                                                  "display_name": "Execute GET request to the URL",
                                                  "script": "import sys,requests,re\n\n# Get the URL to request\ntestUrl = sys.argv[1]\n\n# Make sure there's no trailing HTML\nif testUrl.find(\"<\") >= 0:\n\ttestUrl = testUrl[0:testUrl.find(\"<\")]\n\n# Request the content of the URL\nurlRequest = requests.get(testUrl, headers={ 'User-Agent': 'SecureX/definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC:003' }, allow_redirects=False)\n\n# Check if the response was a redirect\nstatusCode = urlRequest.status_code\nredirected = False\nif statusCode in [301, 302, 303, 307, 308]:\n\tredirected = True",
                                                  "script_arguments": [
                                                    "$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$"
                                                  ],
                                                  "script_queries": [
                                                    {
                                                      "script_query": "redirected",
                                                      "script_query_name": "redirected",
                                                      "script_query_type": "boolean"
                                                    },
                                                    {
                                                      "script_query": "statusCode",
                                                      "script_query_name": "statusCode",
                                                      "script_query_type": "integer"
                                                    },
                                                    {
                                                      "script_query": "testUrl",
                                                      "script_query_name": "testUrl",
                                                      "script_query_type": "string"
                                                    }
                                                  ],
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01LKP59V6XS8G6aOMvl8EZnRk1SfVqYFP9u",
                                                "name": "Condition Block",
                                                "title": "Was there a redirect?",
                                                "type": "logic.if_else",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Was there a redirect?",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "blocks": [
                                                  {
                                                    "unique_name": "definition_activity_01LKP5A45CKC22t7wshDOq6GDSTROzEVBco",
                                                    "name": "Condition Branch",
                                                    "title": "Yes",
                                                    "type": "logic.condition_block",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "condition": {
                                                        "left_operand": "$activity.definition_activity_01LKOYKBT0CY46MsKbSVX288arziBzzUDHD.output.script_queries.redirected$",
                                                        "operator": "eq",
                                                        "right_operand": true
                                                      },
                                                      "continue_on_failure": false,
                                                      "display_name": "Yes",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "actions": [
                                                      {
                                                        "unique_name": "definition_activity_01LKPE4PFOHQQ2zPJP0S0J6rKByb5aHaGr9",
                                                        "name": "Threat Grid v2 - Submit URL",
                                                        "title": "Threat Grid v2 - Submit URL",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": true,
                                                          "display_name": "Threat Grid v2 - Submit URL",
                                                          "input": {
                                                            "variable_workflow_01LKD7G2HMOG67VpVMWoGsGcDEi1SCYRyXh": "phishing,securex",
                                                            "variable_workflow_01LKD7G2HMRDR1Ac8bwIgGBtX9gL0UTokzl": true,
                                                            "variable_workflow_01LKD7G2HMV1S0J19LT31xAaJAkyRHFamj4": "",
                                                            "variable_workflow_01LKD7G2HMXCX3wcYatNwgUBPxLVNpT9A7K": "default",
                                                            "variable_workflow_01LKD7G2HMYI30L207he58XwfKF0NM5sIg0": true,
                                                            "variable_workflow_01LKD7G2HMZMI1JebIHwlcekUAKTtjwcc0B": 2,
                                                            "variable_workflow_01LKD7G2HN0OK1KBmsakMpLSN2QPo4CbnZ3": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLD3P2rqquAOD3fcHB0KFKvPYvO$",
                                                            "variable_workflow_01LKDCRJFFFMU1yA1NdnPyw8MrMQgJYbBir": "$activity.definition_activity_01LKOYKBT0CY46MsKbSVX288arziBzzUDHD.output.script_queries.testUrl$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target_group_criteria": true,
                                                            "target_group": {
                                                              "run_on_all_targets": false,
                                                              "use_criteria": {
                                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                                "conditions": [
                                                                  {
                                                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                                    "operator": "eqi",
                                                                    "right_operand": "ThreatGrid_Target"
                                                                  }
                                                                ]
                                                              }
                                                            }
                                                          },
                                                          "workflow_id": "definition_workflow_01LKD7G2VQ44P3jhvJ6wDFa1EXSJdJPmv1j"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01LLBDEX898O07GTQoQYAKawrdjK5hyDPvv",
                                                        "name": "Set Variables",
                                                        "title": "Update ticket text",
                                                        "type": "core.set_multiple_variables",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Update ticket text",
                                                          "skip_execution": false,
                                                          "variables_to_update": [
                                                            {
                                                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Observable was a URL, had a 2 character TLD, and responded to an HTTP GET with a 3xx redirect. Submitted to Threat Grid with sample ID: [$activity.definition_activity_01LKPE4PFOHQQ2zPJP0S0J6rKByb5aHaGr9.output.variable_workflow_01LKD7G2HMTT745KhzahqI9gFLGtN1JLDIV$](https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LWAHHD506RJ7C8r17PWhETuCv94RscDrJ$/mask/samples/$activity.definition_activity_01LKPE4PFOHQQ2zPJP0S0J6rKByb5aHaGr9.output.variable_workflow_01LKD7G2HMTT745KhzahqI9gFLGtN1JLDIV$)"
                                                            },
                                                            {
                                                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYMI6C66CI2DaD7QJ5OOD7FVtwPeaPCe$",
                                                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYMI6C66CI2DaD7QJ5OOD7FVtwPeaPCe$+1"
                                                            }
                                                          ]
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01LKPFGQNE8YK2TLGWvzhHIUEl20HXkqS6K",
                                                        "name": "Condition Block",
                                                        "title": "Was the URL analyzed successfully?",
                                                        "type": "logic.if_else",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Was the URL analyzed successfully?",
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity",
                                                        "blocks": [
                                                          {
                                                            "unique_name": "definition_activity_01LKPFGTU7WQU0WwcYnsbCDFlCiu2nWH7ub",
                                                            "name": "Condition Branch",
                                                            "title": "Yes",
                                                            "type": "logic.condition_block",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "condition": {
                                                                "left_operand": "$activity.definition_activity_01LKPE4PFOHQQ2zPJP0S0J6rKByb5aHaGr9.output.succeeded$",
                                                                "operator": "eq",
                                                                "right_operand": true
                                                              },
                                                              "continue_on_failure": false,
                                                              "display_name": "Yes",
                                                              "skip_execution": false
                                                            },
                                                            "object_type": "definition_activity",
                                                            "actions": [
                                                              {
                                                                "unique_name": "definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ",
                                                                "name": "JSONPath Query",
                                                                "title": "Extract the threat score",
                                                                "type": "corejava.jsonpathquery",
                                                                "base_type": "activity",
                                                                "properties": {
                                                                  "action_timeout": 180,
                                                                  "continue_on_failure": true,
                                                                  "display_name": "Extract the threat score",
                                                                  "input_json": "$activity.definition_activity_01LKPE4PFOHQQ2zPJP0S0J6rKByb5aHaGr9.output.variable_workflow_01LKD7G2HN1TN7U91elihiN8Ygg2xHE7neU$",
                                                                  "jsonpath_queries": [
                                                                    {
                                                                      "jsonpath_query": "$.threat.threat_score",
                                                                      "jsonpath_query_name": "threat_score",
                                                                      "jsonpath_query_type": "integer"
                                                                    }
                                                                  ],
                                                                  "skip_execution": false
                                                                },
                                                                "object_type": "definition_activity"
                                                              },
                                                              {
                                                                "unique_name": "definition_activity_01LKPHEXCNWQJ7Hx1EHyoWZRnOjJDzKImS1",
                                                                "name": "Condition Block",
                                                                "title": "Were we able to get a threat score?",
                                                                "type": "logic.if_else",
                                                                "base_type": "activity",
                                                                "properties": {
                                                                  "continue_on_failure": false,
                                                                  "display_name": "Were we able to get a threat score?",
                                                                  "skip_execution": false
                                                                },
                                                                "object_type": "definition_activity",
                                                                "blocks": [
                                                                  {
                                                                    "unique_name": "definition_activity_01LKPHF0LZC780rDIlDZgz3Pyej2GJNuqTc",
                                                                    "name": "Condition Branch",
                                                                    "title": "Yes",
                                                                    "type": "logic.condition_block",
                                                                    "base_type": "activity",
                                                                    "properties": {
                                                                      "condition": {
                                                                        "left_operand": "$activity.definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ.output.succeeded$",
                                                                        "operator": "eq",
                                                                        "right_operand": true
                                                                      },
                                                                      "continue_on_failure": false,
                                                                      "display_name": "Yes",
                                                                      "skip_execution": false
                                                                    },
                                                                    "object_type": "definition_activity",
                                                                    "actions": [
                                                                      {
                                                                        "unique_name": "definition_activity_01LQC1IQW7CE97lojfnqhiNN3KAGg8JLe5d",
                                                                        "name": "Set Variables",
                                                                        "title": "Update ticket text",
                                                                        "type": "core.set_multiple_variables",
                                                                        "base_type": "activity",
                                                                        "properties": {
                                                                          "continue_on_failure": false,
                                                                          "display_name": "Update ticket text",
                                                                          "skip_execution": false,
                                                                          "variables_to_update": [
                                                                            {
                                                                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* URL threat score: $activity.definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ.output.jsonpath_queries.threat_score$"
                                                                            }
                                                                          ]
                                                                        },
                                                                        "object_type": "definition_activity"
                                                                      },
                                                                      {
                                                                        "unique_name": "definition_activity_01LKPI2WD86EB7Y9xRIshhySmkMr0jtB5B0",
                                                                        "name": "Condition Block",
                                                                        "title": "Was the file a threat?",
                                                                        "type": "logic.if_else",
                                                                        "base_type": "activity",
                                                                        "properties": {
                                                                          "continue_on_failure": false,
                                                                          "display_name": "Was the file a threat?",
                                                                          "skip_execution": false
                                                                        },
                                                                        "object_type": "definition_activity",
                                                                        "blocks": [
                                                                          {
                                                                            "unique_name": "definition_activity_01LKPI2Z6SXA51MiDDf1YgAKeMcAFMW29bo",
                                                                            "name": "Condition Branch",
                                                                            "title": "Less than 70",
                                                                            "type": "logic.condition_block",
                                                                            "base_type": "activity",
                                                                            "properties": {
                                                                              "condition": {
                                                                                "left_operand": "$activity.definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ.output.jsonpath_queries.threat_score$",
                                                                                "operator": "lt",
                                                                                "right_operand": 70
                                                                              },
                                                                              "continue_on_failure": false,
                                                                              "display_name": "Less than 70",
                                                                              "skip_execution": false
                                                                            },
                                                                            "object_type": "definition_activity",
                                                                            "actions": [
                                                                              {
                                                                                "unique_name": "definition_activity_01LKPI315H1OD3MF7JDv2fQAGDjCAlRyezc",
                                                                                "name": "Update Row in Table",
                                                                                "title": "Update hash disposition in table",
                                                                                "type": "core.updaterowintable",
                                                                                "base_type": "activity",
                                                                                "properties": {
                                                                                  "action_timeout": 180,
                                                                                  "columns": [
                                                                                    {
                                                                                      "column_name": "disposition",
                                                                                      "column_type": "string"
                                                                                    }
                                                                                  ],
                                                                                  "continue_on_failure": false,
                                                                                  "display_name": "Update hash disposition in table",
                                                                                  "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                                                                  "row": [
                                                                                    {
                                                                                      "key": "disposition",
                                                                                      "type": "string",
                                                                                      "value": "Unknown"
                                                                                    }
                                                                                  ],
                                                                                  "rows": {
                                                                                    "rows_matching_criteria": true,
                                                                                    "where_clause": "type == 'url' AND value == '$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$'"
                                                                                  },
                                                                                  "skip_execution": false
                                                                                },
                                                                                "object_type": "definition_activity"
                                                                              }
                                                                            ]
                                                                          },
                                                                          {
                                                                            "unique_name": "definition_activity_01LKPI331ESG44WIZRSgg4BSobcFUyvvLhY",
                                                                            "name": "Condition Branch",
                                                                            "title": "Suspicious (70-89)",
                                                                            "type": "logic.condition_block",
                                                                            "base_type": "activity",
                                                                            "properties": {
                                                                              "condition": {
                                                                                "left_operand": {
                                                                                  "left_operand": "$activity.definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ.output.jsonpath_queries.threat_score$",
                                                                                  "operator": "gte",
                                                                                  "right_operand": 70
                                                                                },
                                                                                "operator": "and",
                                                                                "right_operand": {
                                                                                  "left_operand": "$activity.definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ.output.jsonpath_queries.threat_score$",
                                                                                  "operator": "lt",
                                                                                  "right_operand": 90
                                                                                }
                                                                              },
                                                                              "continue_on_failure": false,
                                                                              "display_name": "Suspicious (70-89)",
                                                                              "skip_execution": false
                                                                            },
                                                                            "object_type": "definition_activity",
                                                                            "actions": [
                                                                              {
                                                                                "unique_name": "definition_activity_01LKPI35017AZ5hJjUfAvxrjNPcfxm2qvw5",
                                                                                "name": "Update Row in Table",
                                                                                "title": "Update hash disposition in table",
                                                                                "type": "core.updaterowintable",
                                                                                "base_type": "activity",
                                                                                "properties": {
                                                                                  "action_timeout": 180,
                                                                                  "columns": [
                                                                                    {
                                                                                      "column_name": "disposition",
                                                                                      "column_type": "string"
                                                                                    }
                                                                                  ],
                                                                                  "continue_on_failure": false,
                                                                                  "display_name": "Update hash disposition in table",
                                                                                  "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                                                                  "row": [
                                                                                    {
                                                                                      "key": "disposition",
                                                                                      "type": "string",
                                                                                      "value": "Suspicious"
                                                                                    }
                                                                                  ],
                                                                                  "rows": {
                                                                                    "rows_matching_criteria": true,
                                                                                    "where_clause": "type == 'url' AND value == '$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$'"
                                                                                  },
                                                                                  "skip_execution": false
                                                                                },
                                                                                "object_type": "definition_activity"
                                                                              }
                                                                            ]
                                                                          },
                                                                          {
                                                                            "unique_name": "definition_activity_01LKPI36Y4SN32bDJQb7ltY581LTPUd8JIX",
                                                                            "name": "Condition Branch",
                                                                            "title": "Malicious (90 or more)",
                                                                            "type": "logic.condition_block",
                                                                            "base_type": "activity",
                                                                            "properties": {
                                                                              "condition": {
                                                                                "left_operand": "$activity.definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ.output.jsonpath_queries.threat_score$",
                                                                                "operator": "gte",
                                                                                "right_operand": 90
                                                                              },
                                                                              "continue_on_failure": false,
                                                                              "display_name": "Malicious (90 or more)",
                                                                              "skip_execution": false
                                                                            },
                                                                            "object_type": "definition_activity",
                                                                            "actions": [
                                                                              {
                                                                                "unique_name": "definition_activity_01LKPI38XX4YU3SxUQ2UhtGJPowcab6xBCC",
                                                                                "name": "Update Row in Table",
                                                                                "title": "Update hash disposition in table",
                                                                                "type": "core.updaterowintable",
                                                                                "base_type": "activity",
                                                                                "properties": {
                                                                                  "action_timeout": 180,
                                                                                  "columns": [
                                                                                    {
                                                                                      "column_name": "disposition",
                                                                                      "column_type": "string"
                                                                                    }
                                                                                  ],
                                                                                  "continue_on_failure": false,
                                                                                  "display_name": "Update hash disposition in table",
                                                                                  "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                                                                  "row": [
                                                                                    {
                                                                                      "key": "disposition",
                                                                                      "type": "string",
                                                                                      "value": "Malicious"
                                                                                    }
                                                                                  ],
                                                                                  "rows": {
                                                                                    "rows_matching_criteria": true,
                                                                                    "where_clause": "type == 'url' AND value == '$activity.definition_activity_01LDID1EL1BQ95tGvzG554dT7BANjLOqQkw.input.source_array[@].value$'"
                                                                                  },
                                                                                  "skip_execution": false
                                                                                },
                                                                                "object_type": "definition_activity"
                                                                              }
                                                                            ]
                                                                          }
                                                                        ]
                                                                      }
                                                                    ]
                                                                  },
                                                                  {
                                                                    "unique_name": "definition_activity_01LKPHF2JBIMG2sz2fvxCwWRnH4dfdkE2YX",
                                                                    "name": "Condition Branch",
                                                                    "title": "No",
                                                                    "type": "logic.condition_block",
                                                                    "base_type": "activity",
                                                                    "properties": {
                                                                      "condition": {
                                                                        "left_operand": "$activity.definition_activity_01LKPGREAB1A35SE9SJPv3RllaBC0mJF4AJ.output.succeeded$",
                                                                        "operator": "eq",
                                                                        "right_operand": false
                                                                      },
                                                                      "continue_on_failure": false,
                                                                      "display_name": "No",
                                                                      "skip_execution": false
                                                                    },
                                                                    "object_type": "definition_activity",
                                                                    "actions": [
                                                                      {
                                                                        "unique_name": "definition_activity_01LLBDPSCKUI05N4Donk2EoWv4JAkyX5Ixm",
                                                                        "name": "Set Variables",
                                                                        "title": "Update ticket text",
                                                                        "type": "core.set_multiple_variables",
                                                                        "base_type": "activity",
                                                                        "properties": {
                                                                          "continue_on_failure": false,
                                                                          "display_name": "Update ticket text",
                                                                          "skip_execution": false,
                                                                          "variables_to_update": [
                                                                            {
                                                                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Failed to extract threat score from analysis results"
                                                                            }
                                                                          ]
                                                                        },
                                                                        "object_type": "definition_activity"
                                                                      }
                                                                    ]
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          },
                                                          {
                                                            "unique_name": "definition_activity_01LKPFGVOVVDQ4Bg6cmH2MVWcUeCXLD4sB0",
                                                            "name": "Condition Branch",
                                                            "title": "No",
                                                            "type": "logic.condition_block",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "condition": {
                                                                "left_operand": "$activity.definition_activity_01LKPE4PFOHQQ2zPJP0S0J6rKByb5aHaGr9.output.succeeded$",
                                                                "operator": "eq",
                                                                "right_operand": false
                                                              },
                                                              "continue_on_failure": false,
                                                              "display_name": "No",
                                                              "skip_execution": false
                                                            },
                                                            "object_type": "definition_activity",
                                                            "actions": [
                                                              {
                                                                "unique_name": "definition_activity_01LLBE6446HBB3iWVGLaU9rJV2nooOJX359",
                                                                "name": "Set Variables",
                                                                "title": "Update ticket text",
                                                                "type": "core.set_multiple_variables",
                                                                "base_type": "activity",
                                                                "properties": {
                                                                  "continue_on_failure": false,
                                                                  "display_name": "Update ticket text",
                                                                  "skip_execution": false,
                                                                  "variables_to_update": [
                                                                    {
                                                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                                      "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Failed to submit URL to Threat Grid for analysis"
                                                                    }
                                                                  ]
                                                                },
                                                                "object_type": "definition_activity"
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LDID41QPVIP7E8ABmqDqZgjN9mwH8a2V9",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].is_email_type$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LDID4KYZSXO0mtRHyYRoNxFIPagaqnd7w",
                        "name": "Threat Response v2 - Get Deliberate Verdict",
                        "title": "Threat Response v2 - Get Deliberate Verdict",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Threat Response v2 - Get Deliberate Verdict",
                          "input": {
                            "variable_workflow_01KXGQWL4TDTE02Mxh65PHxstnnK3wTcCF2": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LR9OLL4JHL86LeCidHSI0HxRbuTgtisu1$",
                            "variable_workflow_01KXGQWL4THYI5hexa4Ip4LW0UZIJhk4ejv": "sha256",
                            "variable_workflow_01KXGQWL4TLPV5NbUAlHHHQUcco57lEijh9": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LDID4WCQ4AH2dopYuXrkZ4ZGvLVKNd6XF",
                        "name": "Add Row to Table",
                        "title": "Add hash to observable table",
                        "type": "core.addrowtotable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Add hash to observable table",
                          "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                          "row": [
                            {
                              "key": "type",
                              "type": "string",
                              "value": "sha256"
                            },
                            {
                              "key": "value",
                              "type": "string",
                              "value": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$"
                            },
                            {
                              "key": "disposition",
                              "type": "string",
                              "value": "$activity.definition_activity_01LDID4KYZSXO0mtRHyYRoNxFIPagaqnd7w.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LDID57FYT3S3A1JXdbgG5f2d3jKfN6vgG",
                        "name": "Set Variables",
                        "title": "Update ticket text",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Update ticket text",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Parsing attachment as a file\n* Threat Response disposition for attachment file hash: $activity.definition_activity_01LDID4KYZSXO0mtRHyYRoNxFIPagaqnd7w.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LDID760X6B504FRYZqvwQ8Dw7cxDpfWKO",
                        "name": "Condition Block",
                        "title": "What was the disposition?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "What was the disposition?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01LDID7D44RTV1MIZxan6mMTXOdsb2mWkzQ",
                            "name": "Condition Branch",
                            "title": "Unknown",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LDID4KYZSXO0mtRHyYRoNxFIPagaqnd7w.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$",
                                "operator": "eqi",
                                "right_operand": "Unknown"
                              },
                              "continue_on_failure": false,
                              "display_name": "Unknown",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LDID5GYPS210jbfRNdCPStQNQhF4UN3xR",
                                "name": "Execute Python Script",
                                "title": "Check file type",
                                "type": "python3.script",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": false,
                                  "display_name": "Check file type",
                                  "script": "import sys,re\n\nfileName = sys.argv[1]\n\nfileSupported = False\n\nmatches = re.search(r\"\\.(DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|PDF|XML|XPS)$\", fileName, re.IGNORECASE)\n\nif matches:\n\tfileSupported = True",
                                  "script_arguments": [
                                    "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_name$"
                                  ],
                                  "script_queries": [
                                    {
                                      "script_query": "fileSupported",
                                      "script_query_name": "fileSupported",
                                      "script_query_type": "boolean"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LDID5PYAVXO1bm5hMqeEj4yFtYKGiNCYZ",
                                "name": "Condition Block",
                                "title": "Is this file type supported for Threat Grid?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Is this file type supported for Threat Grid?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LDID5WGVWA11dLYsv3xFSYc6KrCghoLpY",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LDID5GYPS210jbfRNdCPStQNQhF4UN3xR.output.script_queries.fileSupported$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LDID655N8TS0kj6yqwspx1eh2an7t8x4F",
                                        "name": "Set Variables",
                                        "title": "Update ticket text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update ticket text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Unable to inspect attachment with Threat Grid (file type not supported)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LDID6ZBUBNQ6SmENZKI0cMbzI1Xgo2D63",
                                        "name": "Continue",
                                        "title": "Skip this attachment",
                                        "type": "logic.continue",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Skip this attachment",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01LG7ITL1QCBU6W5fjZu8lQAxF7gOtp7Yok",
                                "name": "Threat Grid v2 - Get Samples by File Hash",
                                "title": "Threat Grid v2 - Get Samples by File Hash",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Threat Grid v2 - Get Samples by File Hash",
                                  "input": {
                                    "variable_workflow_01LG728NFQQ1B0w73ofaVTY1j0eCchHiq1a": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLD3P2rqquAOD3fcHB0KFKvPYvO$",
                                    "variable_workflow_01LG728NFQWKU0AByukUVhxy7ZUnFvl1nBb": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$",
                                    "variable_workflow_01LG7E6RQ83DA2DnhaNSD0oBmf0W9Krw48A": "desc",
                                    "variable_workflow_01LG7FHHK92RR24Gzv0zeE3oIzT3GvwVfa8": "submitted_at",
                                    "variable_workflow_01LG8AGPD0UJ63Hi2sWL9MogjQUw2y0xOQA": "state=succ",
                                    "variable_workflow_01LG8DIBRB3070jvTPUFY95yOVUqsJoeXjI": 0,
                                    "variable_workflow_01LG8DQLC65NP0ZIA4V8zRiKvfTARgxPBWZ": 1
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ThreatGrid_Target"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01LG728NY19RR7dSxgZ5Pjjk6kyokjflhvJ"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LKCK9M8I35P0B2d4lvLpdPidXmO2gRVVo",
                                "name": "Condition Block",
                                "title": "Was this file submitted previously?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Was this file submitted previously?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LKCK9PAIQ661uhONslbzViyXrBfC5CHM4",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LG7ITL1QCBU6W5fjZu8lQAxF7gOtp7Yok.output.variable_workflow_01LG7GH2NBMMW0caH58Nq48w9uZxFcLysdB$",
                                        "operator": "gt",
                                        "right_operand": 0
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LKCK9RHL6I17TsT9AfvhvaCNAvgPktKhS",
                                        "name": "JSONPath Query",
                                        "title": "Extract the most recent threat score",
                                        "type": "corejava.jsonpathquery",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "continue_on_failure": true,
                                          "display_name": "Extract the most recent threat score",
                                          "input_json": "$activity.definition_activity_01LG7ITL1QCBU6W5fjZu8lQAxF7gOtp7Yok.output.variable_workflow_01LG728NFQXQK0Yx9wvpzftcQyJBmQ9gD6k$",
                                          "jsonpath_queries": [
                                            {
                                              "jsonpath_query": "$.data.items[0].item.analysis.threat_score",
                                              "jsonpath_query_name": "threat_score",
                                              "jsonpath_query_type": "integer"
                                            }
                                          ],
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LKCMGS8FQD72tyAhow4Qx8XSOsbJGYWk1",
                                        "name": "Condition Block",
                                        "title": "Were we able to get a threat score?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Were we able to get a threat score?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01LKCMGVJVBN52gKeGzyoh0vmTEtbYioLoe",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01LKCK9RHL6I17TsT9AfvhvaCNAvgPktKhS.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": true
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LKCMSU714651smraeQq06safbJHJKbmpp",
                                                "name": "Set Variables",
                                                "title": "Set local variable",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Set local variable",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM$",
                                                      "variable_value_new": "$activity.definition_activity_01LKCK9RHL6I17TsT9AfvhvaCNAvgPktKhS.output.jsonpath_queries.threat_score$"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          },
                                          {
                                            "unique_name": "definition_activity_01LKCMGXQF3ND5QaJdoqG9rpWgyMJo1hM7N",
                                            "name": "Condition Branch",
                                            "title": "No",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01LKCK9RHL6I17TsT9AfvhvaCNAvgPktKhS.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "No",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LKCWVW6R7V14w0cMz2iK7bee4l1TuMRIK",
                                                "name": "Set Variables",
                                                "title": "Update ticket text",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Update ticket text",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                      "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Failed to extract threat score from analysis results"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01LKD4HDOW4XI3XGBjracufmI6O7z5pxdVP",
                                                "name": "Continue",
                                                "title": "Continue",
                                                "type": "logic.continue",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Continue",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LKCKA3KT2CZ3YTbLfSAyagiChVh0oNKYZ",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LG7ITL1QCBU6W5fjZu8lQAxF7gOtp7Yok.output.variable_workflow_01LG7GH2NBMMW0caH58Nq48w9uZxFcLysdB$",
                                        "operator": "eq",
                                        "right_operand": 0
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LKCKA5S7L0303Q8BWUxr3rJGZSNH3gFYD",
                                        "name": "Group",
                                        "title": "Send file to Threat Grid for analysis",
                                        "type": "logic.group",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Send file to Threat Grid for analysis",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01LKCKA9Y3GOR4CayA3C31zvcwWOpjN47Xq",
                                            "name": "Threat Grid v2 - Submit File",
                                            "title": "Threat Grid v2 - Submit File",
                                            "type": "workflow.atomic_workflow",
                                            "base_type": "subworkflow",
                                            "properties": {
                                              "continue_on_failure": true,
                                              "display_name": "Threat Grid v2 - Submit File",
                                              "input": {
                                                "variable_workflow_01KXH6AHLNG5E2StV8uxZASafbfe8mYXeRR": "$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_path$",
                                                "variable_workflow_01KXH6TVT5XLK7DzxlR3iNSC9LSlGmrin10": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLD3P2rqquAOD3fcHB0KFKvPYvO$",
                                                "variable_workflow_01KXH7QUEDAJC6KvdIWyuQ6Kt5Ua7KlhROv": "phishing,securex",
                                                "variable_workflow_01LEFJ8WY85LM6va7vryqG1SDZFBY27gWay": true,
                                                "variable_workflow_01LEHUVZUJIVG1z5EfrfjDHEX8IL7q5k1Hd": true,
                                                "variable_workflow_01LEHY1S38QYK7ObKJLB8KnKUlYvPWTANta": "default",
                                                "variable_workflow_01LEHZ5BA9I8Z1pQhnpLgTw4pO7zNB7LEme": "",
                                                "variable_workflow_01LEI08N0GUTB23y2Jc45PTVMqNJRnJEKZV": 2
                                              },
                                              "runtime_user": {
                                                "target_default": true
                                              },
                                              "skip_execution": false,
                                              "target": {
                                                "override_workflow_target_group_criteria": true,
                                                "target_group": {
                                                  "run_on_all_targets": false,
                                                  "use_criteria": {
                                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                    "conditions": [
                                                      {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ThreatGrid_Target"
                                                      }
                                                    ]
                                                  }
                                                }
                                              },
                                              "workflow_id": "definition_workflow_01KXH2YWVULRP7kaaTT7ATl62qbAEXE5cpn"
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01LKCKAJN8Y1G1DbYZEGU0XiKrmqTMszmFU",
                                            "name": "Set Variables",
                                            "title": "Update ticket text",
                                            "type": "core.set_multiple_variables",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Update ticket text",
                                              "skip_execution": false,
                                              "variables_to_update": [
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                  "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* File submitted to Threat Grid with sample ID: [$activity.definition_activity_01LKCKA9Y3GOR4CayA3C31zvcwWOpjN47Xq.output.variable_workflow_01KXHAWJ5E4BA21ZS32fdAN6IeawizRgPN8$](https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LWAHHD506RJ7C8r17PWhETuCv94RscDrJ$/mask/samples/$activity.definition_activity_01LKCKA9Y3GOR4CayA3C31zvcwWOpjN47Xq.output.variable_workflow_01KXHAWJ5E4BA21ZS32fdAN6IeawizRgPN8$)"
                                                },
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYMI6C66CI2DaD7QJ5OOD7FVtwPeaPCe$",
                                                  "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYMI6C66CI2DaD7QJ5OOD7FVtwPeaPCe$+1"
                                                }
                                              ]
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01LKCKAFEYY5511POpZ1iiw1Vl6dZX2zn1s",
                                            "name": "Condition Block",
                                            "title": "Was the file analyzed successfully?",
                                            "type": "logic.if_else",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Was the file analyzed successfully?",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01LKCKAHGV75E5nJxHDJvlRNVGJQFvui8Cs",
                                                "name": "Condition Branch",
                                                "title": "Yes",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LKCKA9Y3GOR4CayA3C31zvcwWOpjN47Xq.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": true
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "Yes",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LKCKALO5N2Q3VtYGCpdTbWjLMCEf7ksHp",
                                                    "name": "JSONPath Query",
                                                    "title": "Extract the threat score",
                                                    "type": "corejava.jsonpathquery",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "action_timeout": 180,
                                                      "continue_on_failure": true,
                                                      "display_name": "Extract the threat score",
                                                      "input_json": "$activity.definition_activity_01LKCKA9Y3GOR4CayA3C31zvcwWOpjN47Xq.output.variable_workflow_01LEFKI6ZT38G6ATipS7OfdT2qS41jpF2Lx$",
                                                      "jsonpath_queries": [
                                                        {
                                                          "jsonpath_query": "$.threat.threat_score",
                                                          "jsonpath_query_name": "threat_score",
                                                          "jsonpath_query_type": "integer"
                                                        }
                                                      ],
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01LKD0PW96GM76O5XxNHVIP8WBtvWdompMb",
                                                    "name": "Condition Block",
                                                    "title": "Were we able to get a threat score?",
                                                    "type": "logic.if_else",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Were we able to get a threat score?",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "blocks": [
                                                      {
                                                        "unique_name": "definition_activity_01LKD0PYZKQ7F2uDgy0fRCwRko4E2ddAbez",
                                                        "name": "Condition Branch",
                                                        "title": "Yes",
                                                        "type": "logic.condition_block",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "condition": {
                                                            "left_operand": "$activity.definition_activity_01LKCKALO5N2Q3VtYGCpdTbWjLMCEf7ksHp.output.succeeded$",
                                                            "operator": "eq",
                                                            "right_operand": true
                                                          },
                                                          "continue_on_failure": false,
                                                          "display_name": "Yes",
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity",
                                                        "actions": [
                                                          {
                                                            "unique_name": "definition_activity_01LKD0Q0WIM177PGSR2dJJv4hfwyZrlzBJr",
                                                            "name": "Set Variables",
                                                            "title": "Set local variable",
                                                            "type": "core.set_multiple_variables",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "continue_on_failure": false,
                                                              "display_name": "Set local variable",
                                                              "skip_execution": false,
                                                              "variables_to_update": [
                                                                {
                                                                  "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM$",
                                                                  "variable_value_new": "$activity.definition_activity_01LKCKALO5N2Q3VtYGCpdTbWjLMCEf7ksHp.output.jsonpath_queries.threat_score$"
                                                                }
                                                              ]
                                                            },
                                                            "object_type": "definition_activity"
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01LKD0Q2ROHPN4OuTnmwB2Npas7DPK6EQUU",
                                                        "name": "Condition Branch",
                                                        "title": "No",
                                                        "type": "logic.condition_block",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "condition": {
                                                            "left_operand": "$activity.definition_activity_01LKCKALO5N2Q3VtYGCpdTbWjLMCEf7ksHp.output.succeeded$",
                                                            "operator": "eq",
                                                            "right_operand": false
                                                          },
                                                          "continue_on_failure": false,
                                                          "display_name": "No",
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity",
                                                        "actions": [
                                                          {
                                                            "unique_name": "definition_activity_01LKD0Q4Q3SLQ2kgORhgoWEWXA1vL9ZUzHP",
                                                            "name": "Set Variables",
                                                            "title": "Update ticket text",
                                                            "type": "core.set_multiple_variables",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "continue_on_failure": false,
                                                              "display_name": "Update ticket text",
                                                              "skip_execution": false,
                                                              "variables_to_update": [
                                                                {
                                                                  "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                                  "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Failed to extract threat score from analysis results"
                                                                }
                                                              ]
                                                            },
                                                            "object_type": "definition_activity"
                                                          },
                                                          {
                                                            "unique_name": "definition_activity_01LKD4NJ4FFCQ3NxOg0ptBHIVkCeXB6Rcjg",
                                                            "name": "Continue",
                                                            "title": "Continue",
                                                            "type": "logic.continue",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "continue_on_failure": false,
                                                              "display_name": "Continue",
                                                              "skip_execution": false
                                                            },
                                                            "object_type": "definition_activity"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01LKCKBEK8QKT0SCtwQMciX4A0RRi62fb0x",
                                                "name": "Condition Branch",
                                                "title": "No",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LKCKA9Y3GOR4CayA3C31zvcwWOpjN47Xq.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": false
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "No",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LKCKBGPJ7ZH6faZHshyOoUDpUCARD4z9R",
                                                    "name": "Set Variables",
                                                    "title": "Update ticket text",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Update ticket text",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                                          "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* Failed to submit file to Threat Grid for analysis"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01LKD4Q027WB23WsUw1wl5yhTiWkUkiz3H9",
                                                    "name": "Continue",
                                                    "title": "Continue",
                                                    "type": "logic.continue",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Continue",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01LKCKAT4BV1M43kPGeAj0vu5eQhzpdHcVh",
                                "name": "Set Variables",
                                "title": "Update ticket text",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Update ticket text",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                                      "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$\n* File threat score: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LKCKAVE7QEM2w1xG859onMAuRdVBpcavC",
                                "name": "Condition Block",
                                "title": "Was the file a threat?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Was the file a threat?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LKCKB6ZLGOZ6lhyoor8vn90llTIEX2rqB",
                                    "name": "Condition Branch",
                                    "title": "Less than 70",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM$",
                                        "operator": "lt",
                                        "right_operand": 70
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Less than 70",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LKCKB8VVQ3831uHlrj6Hqao0CmA19z1de",
                                        "name": "Update Row in Table",
                                        "title": "Update hash disposition in table",
                                        "type": "core.updaterowintable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "columns": [
                                            {
                                              "column_name": "disposition",
                                              "column_type": "string"
                                            }
                                          ],
                                          "continue_on_failure": false,
                                          "display_name": "Update hash disposition in table",
                                          "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                          "row": [
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "Unknown"
                                            }
                                          ],
                                          "rows": {
                                            "rows_matching_criteria": true,
                                            "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$'"
                                          },
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LKCKAXR8C2O4DpCmg8jMZI709ggs68mhx",
                                    "name": "Condition Branch",
                                    "title": "Suspicious (70-89)",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": {
                                          "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM$",
                                          "operator": "gte",
                                          "right_operand": 70
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM$",
                                          "operator": "lt",
                                          "right_operand": 90
                                        }
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Suspicious (70-89)",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LKCKB08HP433Gg5v33FmIHe13cmrFPXdO",
                                        "name": "Update Row in Table",
                                        "title": "Update hash disposition in table",
                                        "type": "core.updaterowintable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "columns": [
                                            {
                                              "column_name": "disposition",
                                              "column_type": "string"
                                            }
                                          ],
                                          "continue_on_failure": false,
                                          "display_name": "Update hash disposition in table",
                                          "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                          "row": [
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "Suspicious"
                                            }
                                          ],
                                          "rows": {
                                            "rows_matching_criteria": true,
                                            "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$'"
                                          },
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LKCKB2Q4M740unxkZ2YqJfofqV8HgGYG8",
                                    "name": "Condition Branch",
                                    "title": "Malicious (90 or more)",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LKCO2ILYJX85BRkQksWGGjJd8umqT8nXM$",
                                        "operator": "gte",
                                        "right_operand": 90
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Malicious (90 or more)",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LKCKB4PEGBS666RYaGn1lKWWM4SyOVVhJ",
                                        "name": "Update Row in Table",
                                        "title": "Update hash disposition in table",
                                        "type": "core.updaterowintable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "columns": [
                                            {
                                              "column_name": "disposition",
                                              "column_type": "string"
                                            }
                                          ],
                                          "continue_on_failure": false,
                                          "display_name": "Update hash disposition in table",
                                          "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                          "row": [
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "Malicious"
                                            }
                                          ],
                                          "rows": {
                                            "rows_matching_criteria": true,
                                            "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$'"
                                          },
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LGYOMUMX7V80kHy8M7akNbnatJWOLACgp",
                            "name": "Condition Branch",
                            "title": "Anything besides unknown",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LDID4KYZSXO0mtRHyYRoNxFIPagaqnd7w.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$",
                                "operator": "ne",
                                "right_operand": "Unknown"
                              },
                              "continue_on_failure": false,
                              "display_name": "Anything besides unknown",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LGZ3FMXXOXC0DZRDdABlVx9FsMYVFaqie",
                                "name": "Update Row in Table",
                                "title": "Update hash disposition in table",
                                "type": "core.updaterowintable",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "columns": [
                                    {
                                      "column_name": "disposition",
                                      "column_type": "string"
                                    }
                                  ],
                                  "continue_on_failure": false,
                                  "display_name": "Update hash disposition in table",
                                  "input_table": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$",
                                  "row": [
                                    {
                                      "key": "disposition",
                                      "type": "string",
                                      "value": "$activity.definition_activity_01LDID4KYZSXO0mtRHyYRoNxFIPagaqnd7w.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                                    }
                                  ],
                                  "rows": {
                                    "rows_matching_criteria": true,
                                    "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LDICY5T1D183Zvjig4gnJK0GTlrBVztAt.input.source_array[@].file_hash$'"
                                  },
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LGZ1MSY9O247VxzvbsnyL6kM7DuPfI4gT",
        "name": "Group",
        "title": "Build the observable statistics",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Build the observable statistics",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LGZ1SSKDDHE2iati1C0HEE55OE8XNVy4O",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LGZ1UVLZHII6lQTwZVKvWqc8SxP6UoJUa",
                "name": "Condition Block",
                "title": "What was the disposition?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "What was the disposition?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LGZ1UYNWGAC1zNs9BMIhDl8EqPe3PSARl",
                    "name": "Condition Branch",
                    "title": "Suspicious",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LGZ1SSKDDHE2iati1C0HEE55OE8XNVy4O.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Suspicious"
                      },
                      "continue_on_failure": false,
                      "display_name": "Suspicious",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LGZ1V0HGG4H20Bj93FI9gZeGEm0frBMPf",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$",
                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LGZ1V26GTFI6FlC7L7NhOrIZeYDsSSUUa",
                    "name": "Condition Branch",
                    "title": "Malicious",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LGZ1SSKDDHE2iati1C0HEE55OE8XNVy4O.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Malicious"
                      },
                      "continue_on_failure": false,
                      "display_name": "Malicious",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LGZ1V405TOV6kv7XY61NEU9rv89B2Xqki",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$",
                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LGZ1V5P0FG10JZE9holMXMo3c5vjT6qiB",
                    "name": "Condition Branch",
                    "title": "Unknown",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LGZ1SSKDDHE2iati1C0HEE55OE8XNVy4O.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Unknown"
                      },
                      "continue_on_failure": false,
                      "display_name": "Unknown",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LGZ1V7JZK5W7b2PfpxQdVcES1B87cqD02",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYM9HYUS0T5tnd0alUn2JbXGhc0RxCID$",
                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYM9HYUS0T5tnd0alUn2JbXGhc0RxCID$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LGZ1V9AXCU03sHKXiuAN3OQJO1OWqBN9d",
                    "name": "Condition Branch",
                    "title": "Clean",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LGZ1SSKDDHE2iati1C0HEE55OE8XNVy4O.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "Clean",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LGZ1VB7WEVH5qzikXYWS5LMo5iLIhlmcj",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYIGNL764O6e6Ge5cmuGi0m766DQgdTC$",
                              "variable_value_new": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYIGNL764O6e6Ge5cmuGi0m766DQgdTC$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LDIDK0852VR39z9jjHuK7Ps7b2Ptsgwvu",
        "name": "Condition Block",
        "title": "Was there anything suspicious or malicious?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Was there anything suspicious or malicious?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LDIDK6Y5YAF2WaUXMyvSxTkAcvNErIyM6",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$",
                  "operator": "gt",
                  "right_operand": 0
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$",
                  "operator": "gt",
                  "right_operand": 0
                }
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQBZJ02U9SH2twKTKc3Eigv1IIl6r1MEl",
                "name": "Group",
                "title": "Truncate the ticket text if needed",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Truncate the ticket text if needed",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQBZ57U9V1B3VdveV93D78Pbge6FA9i82",
                    "name": "Execute Python Script",
                    "title": "Truncate the ticket text",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Truncate the ticket text",
                      "script": "import sys\n\n# Placeholder for the output text\ntrimmedText = \"\"\n\n# Check if we need to truncate\nif len(sys.argv[1]) <= 4200:\n\ttrimmedText = sys.argv[1]\nelse:\n\t# Loop through each line of input\n\tfor line in sys.argv[1].split(\"\\n\"):\n\t\t# Is the message too long?\n\t\tif len(trimmedText) > 4200:\n\t\t\t# Yes, so add a warning and stop the look\n\t\t\ttrimmedText = trimmedText + \"\\nNOTE: Additional investigation information was truncated due to message length limits\"\n\t\t\tbreak\n\t\telse:\n\t\t\t# No, so keep appending\n\t\t\ttrimmedText = trimmedText + \"\\n\" + line",
                      "script_arguments": [
                        "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "trimmedText",
                          "script_query_name": "trimmedText",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LQC0S6NZ5VU4jVUAmchZchhE7743Uv2IO",
                    "name": "Set Variables",
                    "title": "Set local variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                          "variable_value_new": "$activity.definition_activity_01LQBZ57U9V1B3VdveV93D78Pbge6FA9i82.output.script_queries.trimmedText$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LDIDKEAEXTJ2ONttAEWnQXOi68W2gaWnn",
                "name": "Group",
                "title": "Generate Threat Response objects",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Generate Threat Response objects",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LDIDKP42Z4T0hGz0qVKv6nVCSvogJXewT",
                    "name": "Threat Response v2 - Generate Access Token",
                    "title": "Threat Response v2 - Generate Access Token",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Generate Access Token",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "CTR_For_Access_Token"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LDIDKY0MGD33xIGg1ofZeooz83Z9pxOkw",
                    "name": "For Each",
                    "title": "For each observable",
                    "type": "logic.for_each",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "For each observable",
                      "skip_execution": false,
                      "source_array": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLLZT06hOstShsFs2WLumhqAto4$"
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LDIDL9UZUH56WRcnMVcnI4xqkRvMill0V",
                        "name": "Condition Block",
                        "title": "What is its disposition?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "What is its disposition?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01LDIDLGQQXRN34DXGKi15vKvxDyG2T1fyT",
                            "name": "Condition Branch",
                            "title": "Clean",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LDIDKY0MGD33xIGg1ofZeooz83Z9pxOkw.input.source_array[@].disposition$",
                                "operator": "eqi",
                                "right_operand": "Clean"
                              },
                              "continue_on_failure": false,
                              "display_name": "Clean",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LDIDLPFVFJM4LM7iqmWxrmpX5GBhv27KZ",
                                "name": "Continue",
                                "title": "Skip this observable",
                                "type": "logic.continue",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Skip this observable",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LDIDLWGIRFF38pct4tOYJy71PZiR5MepR",
                            "name": "Condition Branch",
                            "title": "Not Clean",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LDIDKY0MGD33xIGg1ofZeooz83Z9pxOkw.input.source_array[@].disposition$",
                                "operator": "ne",
                                "right_operand": "Clean"
                              },
                              "continue_on_failure": false,
                              "display_name": "Not Clean",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LDIDM50XQR11KNkWpEUuB7FqOGjydYmjI",
                                "name": "Execute Python Script",
                                "title": "Add observable to JSON list",
                                "type": "python3.script",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": false,
                                  "display_name": "Add observable to JSON list",
                                  "script": "import sys, json\n\nexistingObservables = json.loads(sys.argv[1])\nobservableType = sys.argv[2]\nobservableValue = sys.argv[3]\n\nexistingObservables.append({ \"type\": observableType, \"value\": observableValue })\n\nobservableJson = json.dumps(existingObservables)",
                                  "script_arguments": [
                                    "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLL7DK7UYAjRXpksRudsOQVn67Hs$",
                                    "$activity.definition_activity_01LDIDKY0MGD33xIGg1ofZeooz83Z9pxOkw.input.source_array[@].type$",
                                    "$activity.definition_activity_01LDIDKY0MGD33xIGg1ofZeooz83Z9pxOkw.input.source_array[@].value$"
                                  ],
                                  "script_queries": [
                                    {
                                      "script_query": "observableJson",
                                      "script_query_name": "observableJson",
                                      "script_query_type": "string"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LDIDMEA8MPW28FdP3g1X60dmX4X4LJd3Y",
                                "name": "Set Variables",
                                "title": "Set observable variable with output",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set observable variable with output",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLL7DK7UYAjRXpksRudsOQVn67Hs$",
                                      "variable_value_new": "$activity.definition_activity_01LDIDM50XQR11KNkWpEUuB7FqOGjydYmjI.output.script_queries.observableJson$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LDIDMPCNF4I3mnNTAAESN9mn022Fh1JKb",
                    "name": "Threat Response v2 - Create Casebook",
                    "title": "Threat Response v2 - Create Casebook",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Casebook",
                      "input": {
                        "variable_workflow_01KVOGF4J481T6SCd7uh5fW7n47Q712nleJ": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLL7DK7UYAjRXpksRudsOQVn67Hs$",
                        "variable_workflow_01KVOGF4J4FZC0jmaR42b1FbIzVZA19KbYL": "An investigation was conducted in response to an email arriving in the investigation mailbox.\n\nObservable statistics:\n* Clean: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYIGNL764O6e6Ge5cmuGi0m766DQgdTC$\n* Suspicious: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$\n* Malicious: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$\n* Unknown: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYM9HYUS0T5tnd0alUn2JbXGhc0RxCID$\n\n$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                        "variable_workflow_01KVOGF4J4IG81TQKFjqzLlnFJwiiNwXwSq": "$activity.definition_activity_01LDIDKP42Z4T0hGz0qVKv6nVCSvogJXewT.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KVOGF4J4JL52xC9ZXdjYwHt2SvRYkArli": "Email Investigation for \"$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4CXZB1PS85vMbaUCSTf8j02SCyIImgV$\"",
                        "variable_workflow_01KVOMXV9ERSV0M9j1WarflgSG8r5SpZ8b5": "Email Investigation for \"$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4CXZB1PS85vMbaUCSTf8j02SCyIImgV$\"",
                        "variable_workflow_01LFBYQJV9FZA2THdEQrMftLyGiiHP65nUq": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LDIDN5QVVPU66SAM8RfsHldRGGXDmUl2I",
                    "name": "Threat Response v2 - Create Incident",
                    "title": "Threat Response v2 - Create Incident",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Incident",
                      "input": {
                        "variable_workflow_01KVVWMAKJ5X54vaAuNkKq259VyiO5JCeuC": "$activity.definition_activity_01LDIDKP42Z4T0hGz0qVKv6nVCSvogJXewT.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KVVWMAKJ9HX4TuMb2g74UqzpRLRxjwlwm": "Email Investigation for \"$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4CXZB1PS85vMbaUCSTf8j02SCyIImgV$\"",
                        "variable_workflow_01KVVWMAKJBSF1Fxv8uLSCRGpOJCxkue4OH": "An investigation was conducted in response to an email arriving in the investigation mailbox.\n\nObservable statistics:\n* Clean: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYIGNL764O6e6Ge5cmuGi0m766DQgdTC$\n* Suspicious: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$\n* Malicious: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$\n* Unknown: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYM9HYUS0T5tnd0alUn2JbXGhc0RxCID$",
                        "variable_workflow_01KWIVDCZ7VJU1t9jPK4nZnnwHqnllu7dJm": "New",
                        "variable_workflow_01KWIVQVGZKUC0vUPbm3oCvqsYVV036tieP": "High",
                        "variable_workflow_01LFBWLGJNHPS450Wh1dwGf1Xqot6KHUTwY": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LDIDNUHM2KW0nfaMPztt5XK8Seh1qXEEl",
                    "name": "Threat Response v2 - Create Relationship",
                    "title": "Threat Response v2 - Create Relationship",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Relationship",
                      "input": {
                        "variable_workflow_01KWID476NLS63mQo7De2Wk9Q1WAJb0dJXe": "$activity.definition_activity_01LDIDKP42Z4T0hGz0qVKv6nVCSvogJXewT.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KWID476NNBL4xUNZ1ze05KmIr6MTOd2tf": "related-to",
                        "variable_workflow_01KWID476NOW27YCzfBvT6jlpfoo4jDNQoS": "",
                        "variable_workflow_01KWID476NRV53BPxHqiyGzSy3hiS50IIYt": "",
                        "variable_workflow_01KWIOPHDZHRM2nxENJ5E3iBUjDizSHzujd": "$activity.definition_activity_01LDIDMPCNF4I3mnNTAAESN9mn022Fh1JKb.output.variable_workflow_01KVOGF4J4HBH1AEO1b5YnhSpqUnFihUeXS$",
                        "variable_workflow_01KWIP24K2A5P6ag8merXYIrzb5KHnOSzU3": "$activity.definition_activity_01LDIDN5QVVPU66SAM8RfsHldRGGXDmUl2I.output.variable_workflow_01KVVWMAKJDWL0w7z086xbnRNZMwGcpxweP$",
                        "variable_workflow_01LFBZWJ98ZH426APtwKiW7OM9nNQMfT7IA": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LLGAS736PV81GdS3woVjsGfNpr6Bx6wy9",
                    "name": "Threat Response v2 - Create Sighting",
                    "title": "Threat Response v2 - Create Sighting",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Sighting",
                      "input": {
                        "variable_workflow_01KWI6XBXC36X5fDp4P3C4W39e3ii12zcYI": "User targeted by a suspicious email",
                        "variable_workflow_01KWI6XBXC8MT4PhPchVEzUFUYhgJ5L37zI": "User targeted by a suspicious email",
                        "variable_workflow_01KWI6XBXCB6Z7FBz7mVAbr2nQMRfJrB9h4": "$activity.definition_activity_01LDIDKP42Z4T0hGz0qVKv6nVCSvogJXewT.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KWI8HQQALI75l9Rdg4OpEokFpKs35ZysU": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLL7DK7UYAjRXpksRudsOQVn67Hs$",
                        "variable_workflow_01KWI98GQEUY83GabUEPdfqY7XaeitLae2F": "Medium",
                        "variable_workflow_01KWIBOK8V9E16FTFfn7IAUK0P0mHgXZrGT": "[{\"type\":\"user\",\"observables\":[{\"type\":\"email\",\"value\":\"$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.sender$\"}],\"observed_time\":{\"start_time\":\"$activity.definition_activity_01LDIDMPCNF4I3mnNTAAESN9mn022Fh1JKb.output.end_time$\"}}]",
                        "variable_workflow_01KWIYHA5ADVS34NX0EPNpeSYNtUj522l8P": "High",
                        "variable_workflow_01LFBXTCC6NTI4FkW9IYQZb6HAYE8EtHfl7": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWI6XE6K5YD5I6K2wZF5Vp0M9FyXUl34y"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LLGJRLG9S3T4k5NR4UpRZAWrYpxP4OGK2",
                    "name": "Threat Response v2 - Create Relationship",
                    "title": "Threat Response v2 - Create Relationship",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Relationship",
                      "input": {
                        "variable_workflow_01KWID476NLS63mQo7De2Wk9Q1WAJb0dJXe": "$activity.definition_activity_01LDIDKP42Z4T0hGz0qVKv6nVCSvogJXewT.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KWID476NNBL4xUNZ1ze05KmIr6MTOd2tf": "related-to",
                        "variable_workflow_01KWID476NOW27YCzfBvT6jlpfoo4jDNQoS": "",
                        "variable_workflow_01KWID476NRV53BPxHqiyGzSy3hiS50IIYt": "",
                        "variable_workflow_01KWIOPHDZHRM2nxENJ5E3iBUjDizSHzujd": "$activity.definition_activity_01LLGAS736PV81GdS3woVjsGfNpr6Bx6wy9.output.variable_workflow_01KWI6XBXCA122ks58vY1MiMR3fTMolsjyC$",
                        "variable_workflow_01KWIP24K2A5P6ag8merXYIrzb5KHnOSzU3": "$activity.definition_activity_01LDIDN5QVVPU66SAM8RfsHldRGGXDmUl2I.output.variable_workflow_01KVVWMAKJDWL0w7z086xbnRNZMwGcpxweP$",
                        "variable_workflow_01LFBZWJ98ZH426APtwKiW7OM9nNQMfT7IA": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LDIDPDPPBZW1mSwcfO4fMWJgcpe7ugSpY",
                "name": "Group",
                "title": "Send instant message to SOC",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Send instant message to SOC",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LDIDPNAC1SM2wCv5R20Httowp1BB2FG3e",
                    "name": "Condition Block",
                    "title": "Was a Webex Teams room provided?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was a Webex Teams room provided?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01LDIDPU27CXT6nFTuCKUro34Rn9BaA7Kxe",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLPMP7MNZ3m0TsDTLgF2JcMe5uS$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LDIDQ51UR5S1ATJNsEOHOFzny2THwA1qc",
                            "name": "Webex Teams - Search for Room",
                            "title": "Webex Teams - Search for Room",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Webex Teams - Search for Room",
                              "input": {
                                "variable_workflow_01FHMU6RWYQWI3QFUEzjWMT7JYBcz5vquuD": "",
                                "variable_workflow_01FHMU6RWYWY822p43LeMi8Lcx89Q9jeyek": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLPMP7MNZ3m0TsDTLgF2JcMe5uS$",
                                "variable_workflow_01FHMU6RWYY481TVWDm0BQ1p0rWnqak191l": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLJRV47QVDw1J8FWKogMqJWCDk6$",
                                "variable_workflow_01FHNGCYY2O6Z0NcPmUDabszT2P4P0oqMNd": ""
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Webex Teams"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LDIDQEGRHLX4DO5Tp7tCBnKXxjt5wqN5G",
                            "name": "Condition Block",
                            "title": "Did we find the room?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Did we find the room?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01LDIDQLNQLQB19A51EPrI6vPUKEf4RmlPa",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01LDIDQ51UR5S1ATJNsEOHOFzny2THwA1qc.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01LDIDQXAQR676WyruQoW1DKirLdGREqq0X",
                                    "name": "Webex Teams - Post Message to Room",
                                    "title": "Webex Teams - Post Message to Room",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Webex Teams - Post Message to Room",
                                      "input": {
                                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLJRV47QVDw1J8FWKogMqJWCDk6$",
                                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$activity.definition_activity_01LDIDQ51UR5S1ATJNsEOHOFzny2THwA1qc.output.variable_workflow_01FHSVE2R6ZTQ6L92WEi0kWgR5T8zhMAUzO$",
                                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "❗️ A new suspicious email investigation has been created in response to a user-submitted email! The sample submitted **contained malicious or suspicious** content! ❗️\\n * Email Subject: `$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4CXZB1PS85vMbaUCSTf8j02SCyIImgV$` \\n * Sender: `$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG3GJ9F9M5S2Qxe4US0DM83k8vstM2cye$` \\n * Recipient(s): `$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4HDZ009225imFLWhsAxjpJBuXZ2RxHT$` \\n * Number of Attachments: $trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.attachments_count$ \\n\\n Actions: \\n * [Investigate in Threat Response](https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe$/investigate?spid=$activity.definition_activity_01LDIDMPCNF4I3mnNTAAESN9mn022Fh1JKb.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$) \\n* [View Threat Response Incident](https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe$/incidents?q=id:$activity.definition_activity_01LDIDN5QVVPU66SAM8RfsHldRGGXDmUl2I.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$)"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "Webex Teams"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LDRMPM8KL7Q06Ebi4OxgXA5MRFjnI4PR3",
                "name": "Group",
                "title": "Send email notifications",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Send email notifications",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LEI3R7IIH7Q2YaM5ibVrXVoT6DEzaRkRE",
                    "name": "Send Email",
                    "title": "Send SOC notification",
                    "type": "email.smtp_send_email",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "body": "An email was submitted to the investigation mailbox that was found to contain malicious and/or suspicious observables.\n\nReported by: $trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.sender$\nThreat Response Incident: https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe$/incidents?q=id:$activity.definition_activity_01LDIDN5QVVPU66SAM8RfsHldRGGXDmUl2I.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$\nThreat Response Investigation: https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLG976twtPV5bt5l5DrFeRLfFPe$/investigate?spid=$activity.definition_activity_01LDIDMPCNF4I3mnNTAAESN9mn022Fh1JKb.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$\nWorkflow Instance: https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLKUF7R3TFDHTFVtSJMW1Pb0w9D$/orch-ui/runs/$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.instance_id$\n\nInformation about the investigation:\n$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                      "continue_if_one_address_valid": false,
                      "continue_on_failure": false,
                      "display_name": "Send SOC notification",
                      "html": false,
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "subject": "Malicious email reported!",
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LPOXBYCDKW02bO7NucoinbfQKdHJjLfRu$"
                              }
                            ]
                          }
                        }
                      },
                      "to": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LEI57J5RYLC77T77OWmjwU64kDd6EuDDp$"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LDIDSERLCBF0s1L2Iu6KUuduQ6VIm0nr5",
                    "name": "Send Email",
                    "title": "Send update to reporting user",
                    "type": "email.smtp_send_email",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "body": "Hello!\n\nThe email you submitted for review with the subject \"$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LG4CXZB1PS85vMbaUCSTf8j02SCyIImgV$\" was found to be DANGEROUS!\n\nPlease do not open the message and delete it immediately!\n\n\nReference ID: $workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.instance_id$",
                      "continue_if_one_address_valid": false,
                      "continue_on_failure": false,
                      "display_name": "Send update to reporting user",
                      "html": false,
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "subject": "Email investigation results",
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LPOXBYCDKW02bO7NucoinbfQKdHJjLfRu$"
                              }
                            ]
                          }
                        }
                      },
                      "to": "$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.sender$"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LW8QLA7R62F6p3vERYw3634O4LSnRoAeC",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$",
                  "operator": "eq",
                  "right_operand": 0
                },
                "operator": "and",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$",
                  "operator": "eq",
                  "right_operand": 0
                }
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LW8Q38TBWSK5eNO3WASfpxiogw4YGorbQ",
                "name": "Send Email",
                "title": "Send SOC notification",
                "type": "email.smtp_send_email",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "body": "An email was submitted to the investigation mailbox and no malicious and/or suspicious observables were found.\n\nInvestigation should be finalized by an analyst and then the user should be notified of the results.\n\nReported by: $trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.sender$\nWorkflow Instance: https://$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLKUF7R3TFDHTFVtSJMW1Pb0w9D$/orch-ui/runs/$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.instance_id$\n\nInformation about the investigation:\n$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LDICSBLLOJT3g5rFBLxbOBw1UlF0Ql9mi$",
                  "continue_if_one_address_valid": false,
                  "continue_on_failure": false,
                  "display_name": "Send SOC notification",
                  "html": false,
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "subject": "Suspicious email report",
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LPOXBYCDKW02bO7NucoinbfQKdHJjLfRu$"
                          }
                        ]
                      }
                    }
                  },
                  "to": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LEI57J5RYLC77T77OWmjwU64kDd6EuDDp$"
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LGAAGVKADKV2RDAuy5qxjNm9JsSlFmRgd",
        "name": "Group",
        "title": "Update statistics table",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Update statistics table",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LGZV8FCF6Y830NK16YVGYYiuPOKjLCgk7",
            "name": "Add Row to Table",
            "title": "Add row to statistics table",
            "type": "core.addrowtotable",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Add row to statistics table",
              "input_table": "$global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ.global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ$",
              "row": [
                {
                  "key": "observables_clean",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYIGNL764O6e6Ge5cmuGi0m766DQgdTC$"
                },
                {
                  "key": "observables_suspicious",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJ91SGAGA7VyrEdTBs7FjF0aFQr2yx0$"
                },
                {
                  "key": "observables_malicious",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYJQVFW8HJ2nEXVlQm67JaGK41nYRUUJ$"
                },
                {
                  "key": "observables_unknown",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYM9HYUS0T5tnd0alUn2JbXGhc0RxCID$"
                },
                {
                  "key": "threatgrid_submissions",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.local.variable_workflow_01LGYMI6C66CI2DaD7QJ5OOD7FVtwPeaPCe$"
                },
                {
                  "key": "start_time",
                  "type": "date",
                  "value": "$workflow.definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC.output.start_time$"
                },
                {
                  "key": "end_time",
                  "type": "date",
                  "value": "$activity.definition_activity_01LDIDK0852VR39z9jjHuK7Ps7b2Ptsgwvu.output.end_time$"
                },
                {
                  "key": "num_attachments",
                  "type": "integer",
                  "value": "$trigger.triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6.output.attachments_count$"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          }
        ]
      }
    ],
    "categories": []
  },
  "triggers": {
    "triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6": {
      "workflow_id": "definition_workflow_01LDICSCPVGP20hFTpJfjEVUZ57FMXx5sOC",
      "name": "Phishing Mailbox",
      "title": "",
      "lowercase_name": "event.phishing_mailbox",
      "type": "event",
      "base_type": "trigger",
      "ref_id": "event_01LGC5X9EJUOC0K1s0akjTy0WxbVxkmzIxO",
      "version": "",
      "disabled": true,
      "unique_name": "triggerevent_01LDICT231ZS43miaxKIy0SEERAAMo7ddn6",
      "object_type": "triggerevent"
    }
  },
  "events": {
    "event_01LGC5X9EJUOC0K1s0akjTy0WxbVxkmzIxO": {
      "name": "Email in Phishing Mailbox",
      "title": "Email in Phishing Mailbox",
      "type": "email.event",
      "base_type": "event",
      "object_type": "event",
      "target_id": "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le",
      "webhook_id": "",
      "version": "1.0.0",
      "properties": {
        "action": "read",
        "display_name": "Email in Phishing Mailbox",
        "download_attachments": true,
        "folder": "INBOX",
        "target_id": "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le",
        "title": "Email in Phishing Mailbox"
      },
      "unique_name": "event_01LGC5X9EJUOC0K1s0akjTy0WxbVxkmzIxO"
    }
  },
  "targets": {
    "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le": {
      "unique_name": "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le",
      "name": "Phishing Investigation Mailbox",
      "title": "Phishing Investigation Mailbox",
      "type": "email.imap_endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "Used to check for new emails that the phishing workflow needs to process",
        "display_name": "Phishing Investigation Mailbox",
        "ignore_certificate_errors": false,
        "polling_interval": 30,
        "port": 993,
        "protocol": "IMAP",
        "server": "mail.yourdomain.com",
        "tls_enabled": true
      }
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "variables": {
    "variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ": {
      "unique_name": "variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ",
      "schema_id": "tabletype_01LGZS6QD140M6f4dg0oyFeUxSf2Tzv2ngq",
      "properties": {
        "value": [
          {
            "column_data": {
              "end_time": "1900-01-01T00:00:00Z",
              "num_attachments": 0,
              "observables_clean": 0,
              "observables_malicious": 0,
              "observables_suspicious": 0,
              "observables_unknown": 0,
              "start_time": "1900-01-01T00:00:00Z",
              "threatgrid_submissions": 0
            }
          }
        ],
        "scope": "global",
        "name": "0010 - Phishing Investigation Statistics",
        "type": "datatype.table",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_01KXKQ1CSRGVL7ZpP6ogcjNI0ADUjMVnIl5": {
      "unique_name": "tabletype_01KXKQ1CSRGVL7ZpP6ogcjNI0ADUjMVnIl5",
      "data_type": "datatype.tabletype",
      "display_name": "Phishing Response - Observables",
      "columns": [
        {
          "is_required": true,
          "name": "value",
          "title": "value",
          "type": "string"
        },
        {
          "name": "disposition",
          "title": "disposition",
          "type": "string"
        },
        {
          "is_required": true,
          "name": "type",
          "title": "type",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_01LGZS6QD140M6f4dg0oyFeUxSf2Tzv2ngq": {
      "unique_name": "tabletype_01LGZS6QD140M6f4dg0oyFeUxSf2Tzv2ngq",
      "data_type": "datatype.tabletype",
      "display_name": "Phishing Response - Statistics",
      "columns": [
        {
          "name": "start_time",
          "title": "start_time",
          "type": "date"
        },
        {
          "name": "threatgrid_submissions",
          "title": "threatgrid_submissions",
          "type": "integer"
        },
        {
          "name": "end_time",
          "title": "end_time",
          "type": "date"
        },
        {
          "name": "num_attachments",
          "title": "num_attachments",
          "type": "integer"
        },
        {
          "name": "observables_clean",
          "title": "observables_clean",
          "type": "integer"
        },
        {
          "name": "observables_malicious",
          "title": "observables_malicious",
          "type": "integer"
        },
        {
          "name": "observables_suspicious",
          "title": "observables_suspicious",
          "type": "integer"
        },
        {
          "name": "observables_unknown",
          "title": "observables_unknown",
          "type": "integer"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss",
    "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x",
    "definition_workflow_01LKD7G2VQ44P3jhvJ6wDFa1EXSJdJPmv1j",
    "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf",
    "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS",
    "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O",
    "definition_workflow_01KWI6XE6K5YD5I6K2wZF5Vp0M9FyXUl34y",
    "definition_workflow_01LG728NY19RR7dSxgZ5Pjjk6kyokjflhvJ",
    "definition_workflow_01KXGKZ0JA96P0p7omD4IdS6zKdw5ECiofU",
    "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU",
    "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW",
    "definition_workflow_01KXH2YWVULRP7kaaTT7ATl62qbAEXE5cpn"
  ]
}
