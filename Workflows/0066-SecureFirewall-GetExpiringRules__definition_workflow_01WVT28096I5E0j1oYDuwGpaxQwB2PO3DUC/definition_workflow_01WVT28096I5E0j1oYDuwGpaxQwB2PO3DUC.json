{
	"workflow": {
	  "unique_name": "definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC",
	  "name": "0066 - Secure Firewall - Get Expiring Rules",
	  "title": "0066 - Secure Firewall - Get Expiring Rules",
	  "type": "generic.workflow",
	  "base_type": "workflow",
	  "variables": [
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Results",
			"type": "datatype.string",
			"description": "Placeholder for workflow results. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.integer",
		  "properties": {
			"value": 0,
			"scope": "local",
			"name": "Rule Offset",
			"type": "datatype.integer",
			"description": "Placeholder used to keep track of which page of results has been fetched. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01Y1HTOMF2SSY3YlLabQ8z7nctjzpxrhj1y",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Expired Rules",
			"type": "datatype.string",
			"description": "Placeholder for expired rules. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01X4JIF7W3SSX5KXWCcn3FUXbvAcol73WQA",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Webex Room Name",
			"type": "datatype.string",
			"description": "The name of the Webex room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01XAHYP07J4591SJXzwrOz9MyQhc1qUGDTR",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Secure Firewall Management Center URL",
			"type": "datatype.string",
			"description": "The Secure Firewall Management Center URL. Example: https://securefirewall.yourcompany.com",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01X4GQIZI9Z0D0gY2ZiucaCvm4icK2Gvdx8",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Workflow URL",
			"type": "datatype.string",
			"description": "Placeholder used to build the URL of the workflow instance. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01Y1PEWSXIPP936VsIPEIQos0xlOoNsyGMy",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Error Message",
			"type": "datatype.string",
			"description": "Placeholder for error messages. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.secure_string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Webex Access Token",
			"type": "datatype.secure_string",
			"description": "The access token to use to authenticate to the Webex API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01XAHZ25H07E93rRjhiOR559W3m5Ap5uhjI",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Expiring Rules",
			"type": "datatype.string",
			"description": "Placeholder for rules that expire soon. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01X13A93EIFV467vVyH0NJkBM3ZKvIIhHra",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.boolean",
		  "properties": {
			"value": true,
			"scope": "local",
			"name": "Check For Expired Rules",
			"type": "datatype.boolean",
			"description": "Whether or not to check for rules which have already expired",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01X5ADNXZ06FQ2lLpHojL9vg7bSAI7SLWlk",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.integer",
		  "properties": {
			"value": 30,
			"scope": "local",
			"name": "Expiring Soon Time Period",
			"type": "datatype.integer",
			"description": "The time period within which a rule is considered to be expiring soon. For example, if you set this to 7 days, any rule expiring within 7 days will be considered \"expiring soon.\" Note: This should match the workflow's scheduled execution interval",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01X12DD0SR2M961TUwJTA2jmEzQBiHnBt5K",
		  "object_type": "variable_workflow"
		}
	  ],
	  "properties": {
		"atomic": {
		  "is_atomic": false
		},
		"delete_workflow_instance": false,
		"description": "This workflow searches up to 500 Cisco Secure Firewall Management Center policies for time-based rules that are set to expire within the configured expiry time. If expired or soon-to-expire rules are found, a message is posted in Webex with the rule details.\n\nTarget Group: Default TargetGroup\n\nTargets: FMC Target, Webex Teams\n\nSteps:\n[] Validate required settings and fetch the Webex room ID\n[] Get access token for FMC\n[] Get time-range objects\n[] Get access policies\n[] For each policy:\n[]> Check each rule for time-based objects\n[]> If time-based objects are found in rule:\n[]>> Calculate the expiry time and append to the workflow output as needed\n[] Finalize the output of the workflow based on what was found\n[]> Post message to Webex\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0066",
		"display_name": "0066 - Secure Firewall - Get Expiring Rules",
		"runtime_user": {
		  "target_default": true
		},
		"target": {
		  "execute_on_target_group": true,
		  "target_group": {
			"target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
			"run_on_all_targets": false,
			"selected_target_types": [
			  "web-service.endpoint"
			],
			"use_criteria": {
			  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
			  "conditions": [
				{
				  "operator": "eqi",
				  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
				  "right_operand": "FMC Target"
				}
			  ]
			}
		  }
		}
	  },
	  "object_type": "definition_workflow",
	  "actions": [
		{
		  "unique_name": "definition_activity_01XAHXZF88T7F2C7odumw66fwFuhDzQURVT",
		  "name": "Group",
		  "title": "Fetch Global Variables",
		  "type": "logic.group",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Fetch Global Variables",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "actions": [
			{
			  "unique_name": "definition_activity_01XAHY715YQ5X3T0NIx2fAJocjDXO6ONHPf",
			  "name": "Set Variables",
			  "title": "Update Local Variables",
			  "type": "core.set_multiple_variables",
			  "base_type": "activity",
			  "properties": {
				"continue_on_failure": false,
				"display_name": "Update Local Variables",
				"skip_execution": false,
				"variables_to_update": [
				  {
					"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHZ25H07E93rRjhiOR559W3m5Ap5uhjI$",
					"variable_value_new": ""
				  }
				]
			  },
			  "object_type": "definition_activity"
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01XAHZF3RXB0I4R2L8hTNRonWUZG0dySOYf",
		  "name": "Webex - Search for Room",
		  "title": "Webex - Search for Room",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": true,
			"display_name": "Webex - Search for Room",
			"input": {
			  "variable_workflow_01PP790MCX1DN3EitpQebkUyJS65DbwS3nU": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHZ25H07E93rRjhiOR559W3m5Ap5uhjI$",
			  "variable_workflow_01PP790MCXB392D3R8pxh9fgOTjTde2bcMW": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHYP07J4591SJXzwrOz9MyQhc1qUGDTR$",
			  "variable_workflow_01PP790MCXHP55YE6ylOEITWsWbUFJeyWGv": "",
			  "variable_workflow_01PP790MCXM9W1MUwo85y8iNRCoQuQ4RGNa": ""
			},
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "override_workflow_target_group_criteria": true,
			  "target_group": {
				"run_on_all_targets": false,
				"use_criteria": {
				  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
				  "conditions": [
					{
					  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
					  "operator": "eqi",
					  "right_operand": "Webex Teams"
					}
				  ]
				}
			  }
			},
			"workflow_id": "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
			"workflow_name": "Webex - Search for Room"
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01X4GQLO7N40F1fp1DAFTJ5Zk5Z1YVjZWc8",
		  "name": "Condition Block",
		  "title": "Check for required variables",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Check for required variables",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01XAI0Q9BOHPL1OvQjI4dbv1J8Y3QKYj0Iz",
			  "name": "Condition Branch",
			  "title": "Webex Room Not Found",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01XAHZF3RXB0I4R2L8hTNRonWUZG0dySOYf.output.succeeded$",
				  "operator": "eq",
				  "right_operand": false
				},
				"continue_on_failure": false,
				"display_name": "Webex Room Not Found",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01XAI0ZKI90T64A14aEWHC4MBZEHUrUB77v",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "The Webex room \"$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHYP07J4591SJXzwrOz9MyQhc1qUGDTR$\" was not found",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01X59GXJ9ZE111ajTgeELETN6Ogkb4lRQz4",
			  "name": "Condition Branch",
			  "title": "Variables Not Set",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4GQIZI9Z0D0gY2ZiucaCvm4icK2Gvdx8$",
				  "operator": "eq",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "Variables Not Set",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01YFZM1A1V1MT5lBkKa4lj28qgIiDLvDFJJ",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "You must configure the Secure Firewall Management Center URL local variable in the workflow",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01Y1PEBNJ3X252X2Y1nrFKg0FORUrP2sv9E",
		  "name": "Condition Block",
		  "title": "What region are we in?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "What region are we in?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01Y1PEBNXSYGZ725s9Xga7Ybn86pPK9pTsp",
			  "name": "Condition Branch",
			  "title": "US",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
				  "operator": "eqi",
				  "right_operand": "prod-nam"
				},
				"continue_on_failure": false,
				"display_name": "US",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01Y1PF07GVKJH2BlsB6ttbpQi2VDWD2UDiF",
				  "name": "Set Variables",
				  "title": "Set Variables",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set Variables",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1PEWSXIPP936VsIPEIQos0xlOoNsyGMy$",
						"variable_value_new": "https://securex-ao.us.security.cisco.com/orch-ui/runs/$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.output.instance_id$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01Y1PFQROC2Q56tm7bmJefU4YDWhwj6MWsU",
			  "name": "Condition Branch",
			  "title": "APJC",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
				  "operator": "eqi",
				  "right_operand": "prod-apjc"
				},
				"continue_on_failure": false,
				"display_name": "APJC",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01Y1PFQROCNH40M4fUUlWFfIoA56ZWZRstk",
				  "name": "Set Variables",
				  "title": "Set Variables",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set Variables",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1PEWSXIPP936VsIPEIQos0xlOoNsyGMy$",
						"variable_value_new": "https://securex-ao.apjc.security.cisco.com/orch-ui/runs/$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.output.instance_id$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01Y1PFRQ9Q9XV1CTAAEnIGYXv9ZjdkS0dox",
			  "name": "Condition Branch",
			  "title": "EU",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
				  "operator": "eqi",
				  "right_operand": "prod-eu"
				},
				"continue_on_failure": false,
				"display_name": "EU",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01Y1PFRQ9R25Z5GIaLO73x2UwIp6Vj7UGOA",
				  "name": "Set Variables",
				  "title": "Set Variables",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set Variables",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1PEWSXIPP936VsIPEIQos0xlOoNsyGMy$",
						"variable_value_new": "https://securex-ao.eu.security.cisco.com/orch-ui/runs/$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.output.instance_id$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ",
		  "name": "Secure Firewall - Get Access Token",
		  "title": "Secure Firewall - Get Access Token",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": true,
			"display_name": "Secure Firewall - Get Access Token",
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target_group": true
			},
			"workflow_id": "definition_workflow_01PP76OBLMFFT4g43eU1MrFz5S7BxbqRzOk",
			"workflow_name": "Secure Firewall - Get Access Token"
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01X085CQULXDS7G51YqOlK41UKDww6PTjnj",
		  "name": "Condition Block",
		  "title": "Token retrieved successfully?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Token retrieved successfully?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01Y1GT5HXRZCS4v5UGr4GzqhWJ7fh8WrIbk",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.succeeded$",
				  "operator": "eq",
				  "right_operand": false
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01YPGMA0VQSY25MkZnyupCRTbJ1IaUf8EGI",
				  "name": "Webex - Post Message to Room",
				  "title": "Webex - Post Message to Room",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Webex - Post Message to Room",
					"input": {
					  "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01XAHZF3RXB0I4R2L8hTNRonWUZG0dySOYf.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
					  "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHZ25H07E93rRjhiOR559W3m5Ap5uhjI$",
					  "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "# Secure Firewall - Get Expiring Rules\n##  Workflow FAILED\n\n$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.error.message$",
					  "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
					  "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"run_on_all_targets": false,
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "Webex Teams"
							}
						  ]
						}
					  }
					},
					"workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
					"workflow_name": "Webex - Post Message to Room"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01YPGMJLXTG9R7XUTTPa2QmvpKX2wjYKNbv",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "Failed to fetch a token for Secure Firewall",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X",
		  "name": "HTTP Request",
		  "title": "Get Timerange Objects",
		  "type": "web-service.http_request",
		  "base_type": "activity",
		  "properties": {
			"accept": "application/json",
			"action_timeout": 180,
			"allow_auto_redirect": true,
			"allow_headers_redirect": false,
			"continue_on_error_status_code": true,
			"continue_on_failure": false,
			"custom_headers": [
			  {
				"name": "X-auth-access-token",
				"value": "$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.variable_workflow_01PP76OBECVZD3O8cyvubv6Cb2mfX5HASQ2$"
			  }
			],
			"display_name": "Get Timerange Objects",
			"method": "GET",
			"relative_url": "fmc_config/v1/domain/$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.variable_workflow_01PP76OBECP484xngkIgAlf2Yr0SrpVXhYx$/object/timeranges?offset=0&limit=1000&expanded=true",
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target_group": true
			}
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01YG3HSHUYJSY2EwZkOLSDZKLIfun7MTw7G",
		  "name": "Condition Block",
		  "title": "Was the request successful?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was the request successful?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01YG3HSIA9A1X2SvuemMI0lx3hkW9XmQa37",
			  "name": "Condition Branch",
			  "title": "200/Successful",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.status_code$",
				  "operator": "eq",
				  "right_operand": 200
				},
				"continue_on_failure": false,
				"display_name": "200/Successful",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01YG27Q7TVM4Y3A3A3yqzYgVFxHLyxIVFnZ",
				  "name": "JSONPath Query",
				  "title": "Parse Object Count",
				  "type": "corejava.jsonpathquery",
				  "base_type": "activity",
				  "properties": {
					"action_timeout": 180,
					"continue_on_failure": false,
					"display_name": "Parse Object Count",
					"input_json": "$activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.response_body$",
					"jsonpath_queries": [
					  {
						"jsonpath_query": "$.paging.count",
						"jsonpath_query_name": "pagingCount",
						"jsonpath_query_type": "integer"
					  }
					],
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01YPGQNHLRG300O4RKd1VxSdaQGcjZ4usfG",
				  "name": "Condition Block",
				  "title": "Were there records?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Were there records?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01YPGQNJBPGMK41EOlVBwTMrpxAyZ8pHvHV",
					  "name": "Condition Branch",
					  "title": "No",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$activity.definition_activity_01YG27Q7TVM4Y3A3A3yqzYgVFxHLyxIVFnZ.output.jsonpath_queries.pagingCount$",
						  "operator": "eq",
						  "right_operand": 0
						},
						"continue_on_failure": false,
						"display_name": "No",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01YPGRR63MXUU5ldnp68iakJq3pi3CBo0PE",
						  "name": "Webex - Post Message to Room",
						  "title": "Webex - Post Message to Room",
						  "type": "workflow.atomic_workflow",
						  "base_type": "subworkflow",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Webex - Post Message to Room",
							"input": {
							  "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01XAHZF3RXB0I4R2L8hTNRonWUZG0dySOYf.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
							  "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHZ25H07E93rRjhiOR559W3m5Ap5uhjI$",
							  "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "# Secure Firewall - Get Expiring Rules\n## Workflow COMPLETED\n\nThere were no timerange objects to evaluate.",
							  "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
							  "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
							},
							"runtime_user": {
							  "target_default": true
							},
							"skip_execution": false,
							"target": {
							  "override_workflow_target_group_criteria": true,
							  "target_group": {
								"run_on_all_targets": false,
								"use_criteria": {
								  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
								  "conditions": [
									{
									  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
									  "operator": "eqi",
									  "right_operand": "Webex Teams"
									}
								  ]
								}
							  }
							},
							"workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
							"workflow_name": "Webex - Post Message to Room"
						  },
						  "object_type": "definition_activity"
						},
						{
						  "unique_name": "definition_activity_01YPGS1UKJGJ84K6RG5KlfYw29eCIv97xt4",
						  "name": "Completed",
						  "title": "Completed",
						  "type": "logic.completed",
						  "base_type": "activity",
						  "properties": {
							"completion_type": "succeeded",
							"continue_on_failure": false,
							"display_name": "Completed",
							"skip_execution": false
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01YG3HSIQPAEK1B6EZ4OVe0EITIeuS2DOi3",
			  "name": "Condition Branch",
			  "title": "Anything Else",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.status_code$",
				  "operator": "ne",
				  "right_operand": "200"
				},
				"continue_on_failure": false,
				"display_name": "Anything Else",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01YPGRL7EZTSN0FEStPvdurwI01bQlCaq0m",
				  "name": "Webex - Post Message to Room",
				  "title": "Webex - Post Message to Room",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Webex - Post Message to Room",
					"input": {
					  "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01XAHZF3RXB0I4R2L8hTNRonWUZG0dySOYf.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
					  "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHZ25H07E93rRjhiOR559W3m5Ap5uhjI$",
					  "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "# Secure Firewall - Get Expiring Rules\n##  Workflow FAILED\n\nFailed to retrieve timerange objects.\n\nStatus code: $activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.status_code$\nResponse body: $activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.response_body$",
					  "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
					  "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"run_on_all_targets": false,
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "Webex Teams"
							}
						  ]
						}
					  }
					},
					"workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
					"workflow_name": "Webex - Post Message to Room"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01YPGSWP3R84T367yp2XrslAXYUy37FbT1O",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "Failed to fetch the timerange objects.\n\nStatus code: $activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.status_code$\nResponse body: $activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.response_body$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01WVU4XHMN2112gvmStfuMceIxOfBVQEzt4",
		  "name": "HTTP Request",
		  "title": "Get Access Policies",
		  "type": "web-service.http_request",
		  "base_type": "activity",
		  "properties": {
			"accept": "application/json",
			"action_timeout": 180,
			"allow_auto_redirect": true,
			"allow_headers_redirect": false,
			"continue_on_error_status_code": true,
			"continue_on_failure": false,
			"custom_headers": [
			  {
				"name": "X-auth-access-token",
				"value": "$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.variable_workflow_01PP76OBECVZD3O8cyvubv6Cb2mfX5HASQ2$"
			  }
			],
			"display_name": "Get Access Policies",
			"method": "GET",
			"relative_url": "fmc_config/v1/domain/$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.variable_workflow_01PP76OBECP484xngkIgAlf2Yr0SrpVXhYx$/policy/accesspolicies?offset=0&limit=500",
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target_group": true
			}
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01X08CWS8Z3TE39cbIXZmgT1IApFoCSgUpZ",
		  "name": "Condition Block",
		  "title": "Was the request successful?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was the request successful?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01X08CWSPX2B73xpS8b9RmSNrynrtG4o5ZV",
			  "name": "Condition Branch",
			  "title": "200/Success",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01WVU4XHMN2112gvmStfuMceIxOfBVQEzt4.output.status_code$",
				  "operator": "eq",
				  "right_operand": 200
				},
				"continue_on_failure": false,
				"display_name": "200/Success",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01WVUIW19PM5727Uc31LgPU45BGJ95DxNRH",
				  "name": "Read Table from JSON",
				  "title": "Parse Access Policies to Table",
				  "type": "corejava.read_table_from_json",
				  "base_type": "activity",
				  "properties": {
					"action_timeout": 180,
					"continue_on_failure": false,
					"display_name": "Parse Access Policies to Table",
					"input_json": "$activity.definition_activity_01WVU4XHMN2112gvmStfuMceIxOfBVQEzt4.output.response_body$",
					"jsonpath_query": "$.items",
					"persist_output": false,
					"populate_columns": false,
					"skip_execution": false,
					"table_columns": [
					  {
						"column_name": "name",
						"column_type": "string"
					  },
					  {
						"column_name": "id",
						"column_type": "string"
					  }
					]
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m",
				  "name": "For Each",
				  "title": "For Each Policy",
				  "type": "logic.for_each",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "For Each Policy",
					"skip_execution": false,
					"source_array": "$activity.definition_activity_01WVUIW19PM5727Uc31LgPU45BGJ95DxNRH.output.read_table_from_json$"
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01Y1IV8SB4QIY46gcpKkLFEnppf25usS0AJ",
					  "name": "Set Variables",
					  "title": "Reset Rule Offset",
					  "type": "core.set_multiple_variables",
					  "base_type": "activity",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Reset Rule Offset",
						"skip_execution": false,
						"variables_to_update": [
						  {
							"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1HTOMF2SSY3YlLabQ8z7nctjzpxrhj1y$",
							"variable_value_new": 0
						  }
						]
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01Y1HUN6AQU391To0953cj6coccZKMIMtSj",
					  "name": "While Loop",
					  "title": "While Loop",
					  "type": "logic.while",
					  "base_type": "activity",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "While Loop",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "blocks": [
						{
						  "unique_name": "definition_activity_01Y1HUN6RC0JX0Jr6tjva9aaDKmwIKpwIyz",
						  "name": "Condition Branch",
						  "title": "True = true",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.output.instance_id$",
							  "operator": "eq",
							  "right_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.output.instance_id$"
							},
							"continue_on_failure": false,
							"display_name": "True = true",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01WVUMSY8A5W54uOVN0FMFXFYy3uolp67je",
							  "name": "HTTP Request",
							  "title": "Get Policy Rules",
							  "type": "web-service.http_request",
							  "base_type": "activity",
							  "properties": {
								"accept": "application/json",
								"action_timeout": 180,
								"allow_auto_redirect": true,
								"allow_headers_redirect": false,
								"continue_on_error_status_code": true,
								"continue_on_failure": false,
								"custom_headers": [
								  {
									"name": "X-auth-access-token",
									"value": "$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.variable_workflow_01PP76OBECVZD3O8cyvubv6Cb2mfX5HASQ2$"
								  }
								],
								"display_name": "Get Policy Rules",
								"method": "GET",
								"relative_url": "fmc_config/v1/domain/$activity.definition_activity_01WVTMT81BROP38bcI1PC2ZQUBeNaN6dLlZ.output.variable_workflow_01PP76OBECP484xngkIgAlf2Yr0SrpVXhYx$/policy/accesspolicies/$activity.definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m.input.source_array[@].id$/accessrules?expanded=true&offset=$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1HTOMF2SSY3YlLabQ8z7nctjzpxrhj1y$&limit=500",
								"runtime_user": {
								  "target_default": true
								},
								"skip_execution": false,
								"target": {
								  "use_workflow_target_group": true
								}
							  },
							  "object_type": "definition_activity"
							},
							{
							  "unique_name": "definition_activity_01X08LSWPSMT46Y03rMwZzsqATeVD4xJ20A",
							  "name": "Condition Block",
							  "title": "Was the request successful?",
							  "type": "logic.if_else",
							  "base_type": "activity",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "Was the request successful?",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "blocks": [
								{
								  "unique_name": "definition_activity_01X08LSXD7KMD0W1dQ40JBPXpx9L9ZaQgS4",
								  "name": "Condition Branch",
								  "title": "200/Success",
								  "type": "logic.condition_block",
								  "base_type": "activity",
								  "properties": {
									"condition": {
									  "left_operand": "$activity.definition_activity_01WVUMSY8A5W54uOVN0FMFXFYy3uolp67je.output.status_code$",
									  "operator": "eq",
									  "right_operand": 200
									},
									"continue_on_failure": false,
									"display_name": "200/Success",
									"skip_execution": false
								  },
								  "object_type": "definition_activity",
								  "actions": [
									{
									  "unique_name": "definition_activity_01Y1LULU3WVZ96CGgYnYqih4IyJEdf6TIcX",
									  "name": "Set Variables",
									  "title": "Update Rule Offset",
									  "type": "core.set_multiple_variables",
									  "base_type": "activity",
									  "properties": {
										"continue_on_failure": false,
										"display_name": "Update Rule Offset",
										"skip_execution": false,
										"variables_to_update": [
										  {
											"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1HTOMF2SSY3YlLabQ8z7nctjzpxrhj1y$",
											"variable_value_new": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1HTOMF2SSY3YlLabQ8z7nctjzpxrhj1y$+500"
										  }
										]
									  },
									  "object_type": "definition_activity"
									},
									{
									  "unique_name": "definition_activity_01Y1N7UYHXS7G02Ng0z3m4QHr2I5GhhUGvc",
									  "name": "JSONPath Query",
									  "title": "Parse Rule Object Count",
									  "type": "corejava.jsonpathquery",
									  "base_type": "activity",
									  "properties": {
										"action_timeout": 180,
										"continue_on_failure": false,
										"display_name": "Parse Rule Object Count",
										"input_json": "$activity.definition_activity_01WVUMSY8A5W54uOVN0FMFXFYy3uolp67je.output.response_body$",
										"jsonpath_queries": [
										  {
											"jsonpath_query": "$.paging.count",
											"jsonpath_query_name": "pagingCount",
											"jsonpath_query_type": "integer"
										  }
										],
										"skip_execution": false
									  },
									  "object_type": "definition_activity"
									},
									{
									  "unique_name": "definition_activity_01Y1N9BSUHV633ZcY8KxpFygsDLU6rHyyql",
									  "name": "Condition Block",
									  "title": "Are there rules to parse?",
									  "type": "logic.if_else",
									  "base_type": "activity",
									  "properties": {
										"continue_on_failure": false,
										"display_name": "Are there rules to parse?",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "blocks": [
										{
										  "unique_name": "definition_activity_01Y1N9BTAKQ3Q70yEsloN65pJ1rJXZP6YEV",
										  "name": "Condition Branch",
										  "title": "Yes",
										  "type": "logic.condition_block",
										  "base_type": "activity",
										  "properties": {
											"condition": {
											  "left_operand": "$activity.definition_activity_01Y1N7UYHXS7G02Ng0z3m4QHr2I5GhhUGvc.output.jsonpath_queries.pagingCount$",
											  "operator": "gt",
											  "right_operand": 0
											},
											"continue_on_failure": false,
											"display_name": "Yes",
											"skip_execution": false
										  },
										  "object_type": "definition_activity",
										  "actions": [
											{
											  "unique_name": "definition_activity_01X4H628T6ZK83qxkDVKFl3NyloLFvBBw5W",
											  "name": "Read Table from JSON",
											  "title": "Parse Policy Rules with Timerange Objects to Table",
											  "type": "corejava.read_table_from_json",
											  "base_type": "activity",
											  "properties": {
												"action_timeout": 180,
												"continue_on_failure": true,
												"display_name": "Parse Policy Rules with Timerange Objects to Table",
												"input_json": "$activity.definition_activity_01WVUMSY8A5W54uOVN0FMFXFYy3uolp67je.output.response_body$",
												"jsonpath_query": "$.items[?(@.timeRangeObjects)]",
												"persist_output": false,
												"populate_columns": false,
												"skip_execution": false,
												"table_columns": [
												  {
													"column_name": "metadata",
													"column_type": "string"
												  },
												  {
													"column_name": "timeRangeObjects",
													"column_type": "string"
												  },
												  {
													"column_name": "name",
													"column_type": "string"
												  }
												]
											  },
											  "object_type": "definition_activity"
											},
											{
											  "unique_name": "definition_activity_01WVVBVEONWLK2h0DPgurI3MFkuDDPFfALF",
											  "name": "Condition Block",
											  "title": "Policy rules parsed successfully?",
											  "type": "logic.if_else",
											  "base_type": "activity",
											  "properties": {
												"continue_on_failure": false,
												"display_name": "Policy rules parsed successfully?",
												"skip_execution": false
											  },
											  "object_type": "definition_activity",
											  "blocks": [
												{
												  "unique_name": "definition_activity_01WVVBVF5W2NZ59ft6cydyS0KAbQp2FJF7e",
												  "name": "Condition Branch",
												  "title": "Yes",
												  "type": "logic.condition_block",
												  "base_type": "activity",
												  "properties": {
													"condition": {
													  "left_operand": "$activity.definition_activity_01X4H628T6ZK83qxkDVKFl3NyloLFvBBw5W.output.succeeded$",
													  "operator": "eq",
													  "right_operand": true
													},
													"continue_on_failure": false,
													"display_name": "Yes",
													"skip_execution": false
												  },
												  "object_type": "definition_activity",
												  "actions": [
													{
													  "unique_name": "definition_activity_01WVUSWML5UA16KMX0vwlnf2AIQpV35EDkQ",
													  "name": "For Each",
													  "title": "For Each Rule with a Timerange Object",
													  "type": "logic.for_each",
													  "base_type": "activity",
													  "properties": {
														"continue_on_failure": false,
														"display_name": "For Each Rule with a Timerange Object",
														"skip_execution": false,
														"source_array": "$activity.definition_activity_01X4H628T6ZK83qxkDVKFl3NyloLFvBBw5W.output.read_table_from_json$"
													  },
													  "object_type": "definition_activity",
													  "actions": [
														{
														  "unique_name": "definition_activity_01WVUPQ8Y83IU0vD6Wbyjbd0XSTpYvWOInn",
														  "name": "JSONPath Query",
														  "title": "Parse Timerange Object ID",
														  "type": "corejava.jsonpathquery",
														  "base_type": "activity",
														  "properties": {
															"action_timeout": 180,
															"continue_on_failure": false,
															"display_name": "Parse Timerange Object ID",
															"input_json": "$activity.definition_activity_01WVUSWML5UA16KMX0vwlnf2AIQpV35EDkQ.input.source_array[@].timeRangeObjects$",
															"jsonpath_queries": [
															  {
																"jsonpath_query": "$..id",
																"jsonpath_query_name": "objectId",
																"jsonpath_query_type": "string"
															  }
															],
															"skip_execution": false
														  },
														  "object_type": "definition_activity"
														},
														{
														  "unique_name": "definition_activity_01WVUT8EPUC7Y1E23TkbbE5wHBQeDWL03Tn",
														  "name": "JSONPath Query",
														  "title": "Parse Timerange Object ID Details",
														  "type": "corejava.jsonpathquery",
														  "base_type": "activity",
														  "properties": {
															"action_timeout": 180,
															"continue_on_failure": false,
															"display_name": "Parse Timerange Object ID Details",
															"input_json": "$activity.definition_activity_01X57M6N91Q3Z0MhGkWnuGexOa8xBlT6X0X.output.response_body$",
															"jsonpath_queries": [
															  {
																"jsonpath_query": "$.items[?(@.id == \"$activity.definition_activity_01WVUPQ8Y83IU0vD6Wbyjbd0XSTpYvWOInn.output.jsonpath_queries.objectId$\")].effectiveStartDateTime",
																"jsonpath_query_name": "startTime",
																"jsonpath_query_type": "string"
															  },
															  {
																"jsonpath_query": "$.items[?(@.id == \"$activity.definition_activity_01WVUPQ8Y83IU0vD6Wbyjbd0XSTpYvWOInn.output.jsonpath_queries.objectId$\")].effectiveEndDateTime",
																"jsonpath_query_name": "endTime",
																"jsonpath_query_type": "string",
																"zdate_type_format": "yyyy-MM-dd'T'HH:mm:ssXXX"
															  },
															  {
																"jsonpath_query": "$.items[?(@.id == \"$activity.definition_activity_01WVUPQ8Y83IU0vD6Wbyjbd0XSTpYvWOInn.output.jsonpath_queries.objectId$\")].name",
																"jsonpath_query_name": "timeObjectName",
																"jsonpath_query_type": "string"
															  }
															],
															"skip_execution": false
														  },
														  "object_type": "definition_activity"
														},
														{
														  "unique_name": "definition_activity_01X140VXIJ1JN47gSu02d1FFNP4ch1anicR",
														  "name": "Split String",
														  "title": "Split Time from End Date",
														  "type": "core.splitstring",
														  "base_type": "activity",
														  "properties": {
															"boundaries": [
															  {
																"boundary": "T"
															  }
															],
															"continue_on_failure": false,
															"display_name": "Split Time from End Date",
															"input_string": "$activity.definition_activity_01WVUT8EPUC7Y1E23TkbbE5wHBQeDWL03Tn.output.jsonpath_queries.endTime$",
															"skip_execution": false
														  },
														  "object_type": "definition_activity"
														},
														{
														  "unique_name": "definition_activity_01X13V6WCTGB54bkOSMp6QExCDgZRc4eZWc",
														  "name": "Parse Date",
														  "title": "Parse End Date",
														  "type": "core.parse_date",
														  "base_type": "activity",
														  "properties": {
															"continue_on_failure": false,
															"display_name": "Parse End Date",
															"format_string": "2006-01-02",
															"input_string": "$activity.definition_activity_01X140VXIJ1JN47gSu02d1FFNP4ch1anicR.output.parts[0]$",
															"skip_execution": false,
															"use_custom_format": false
														  },
														  "object_type": "definition_activity"
														},
														{
														  "unique_name": "definition_activity_01X13PZER7D4J2fGWXkNhTCglkN1WWjxEWd",
														  "name": "Calculate Date Time Difference",
														  "title": "Calculate Days Expired",
														  "type": "core.calculate_date_time_difference",
														  "base_type": "activity",
														  "properties": {
															"continue_on_failure": false,
															"display_name": "Calculate Days Expired",
															"original_date": "$activity.definition_activity_01X13V6WCTGB54bkOSMp6QExCDgZRc4eZWc.output.result$",
															"skip_execution": false,
															"subtract_date": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.output.start_time$"
														  },
														  "object_type": "definition_activity"
														},
														{
														  "unique_name": "definition_activity_01X13ARHUVD5O7OZQnA855HCvKbEb1vZCqh",
														  "name": "Condition Block",
														  "title": "Is the rule set to expire soon?",
														  "type": "logic.if_else",
														  "base_type": "activity",
														  "properties": {
															"continue_on_failure": false,
															"display_name": "Is the rule set to expire soon?",
															"skip_execution": false
														  },
														  "object_type": "definition_activity",
														  "blocks": [
															{
															  "unique_name": "definition_activity_01X14BWS6OATI5MTPhB6y5YvObJTpILF8Hk",
															  "name": "Condition Branch",
															  "title": "Expired",
															  "type": "logic.condition_block",
															  "base_type": "activity",
															  "properties": {
																"condition": {
																  "left_operand": {
																	"left_operand": "$activity.definition_activity_01X13PZER7D4J2fGWXkNhTCglkN1WWjxEWd.output.total_days$",
																	"operator": "lte",
																	"right_operand": 0
																  },
																  "operator": "and",
																  "right_operand": {
																	"left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X5ADNXZ06FQ2lLpHojL9vg7bSAI7SLWlk$",
																	"operator": "eq",
																	"right_operand": true
																  }
																},
																"continue_on_failure": false,
																"display_name": "Expired",
																"skip_execution": false
															  },
															  "object_type": "definition_activity",
															  "actions": [
																{
																  "unique_name": "definition_activity_01X14BWS6OYUL4cvyuXzRlEZWWoXIxdFVFX",
																  "name": "Set Variables",
																  "title": "Update Expired Rules",
																  "type": "core.set_multiple_variables",
																  "base_type": "activity",
																  "properties": {
																	"continue_on_failure": false,
																	"display_name": "Update Expired Rules",
																	"skip_execution": false,
																	"variables_to_update": [
																	  {
																		"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4JIF7W3SSX5KXWCcn3FUXbvAcol73WQA$",
																		"variable_value_new": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4JIF7W3SSX5KXWCcn3FUXbvAcol73WQA$\n\n**Policy:** [$activity.definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m.input.source_array[@].name$]($workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4GQIZI9Z0D0gY2ZiucaCvm4icK2Gvdx8$/ddd/#FirewallPolicyEditor;uuid=$activity.definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m.input.source_array[@].id$)\n**Rule:** `$activity.definition_activity_01WVUSWML5UA16KMX0vwlnf2AIQpV35EDkQ.input.source_array[@].name$`\n**Message:** Timebased object `$activity.definition_activity_01WVUT8EPUC7Y1E23TkbbE5wHBQeDWL03Tn.output.jsonpath_queries.timeObjectName$` expired $activity.definition_activity_01X13PZER7D4J2fGWXkNhTCglkN1WWjxEWd.output.days$ days ago on $activity.definition_activity_01X140VXIJ1JN47gSu02d1FFNP4ch1anicR.output.parts[0]$."
																	  }
																	]
																  },
																  "object_type": "definition_activity"
																}
															  ]
															},
															{
															  "unique_name": "definition_activity_01X13ARID7NIN4YQFR3Xwg5wXGvAhizrpo4",
															  "name": "Condition Branch",
															  "title": "Soon to expire",
															  "type": "logic.condition_block",
															  "base_type": "activity",
															  "properties": {
																"condition": {
																  "left_operand": {
																	"left_operand": "$activity.definition_activity_01X13PZER7D4J2fGWXkNhTCglkN1WWjxEWd.output.total_days$",
																	"operator": "lte",
																	"right_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X12DD0SR2M961TUwJTA2jmEzQBiHnBt5K$"
																  },
																  "operator": "and",
																  "right_operand": {
																	"left_operand": "$activity.definition_activity_01X13PZER7D4J2fGWXkNhTCglkN1WWjxEWd.output.days$",
																	"operator": "gte",
																	"right_operand": 0
																  }
																},
																"continue_on_failure": false,
																"display_name": "Soon to expire",
																"skip_execution": false
															  },
															  "object_type": "definition_activity",
															  "actions": [
																{
																  "unique_name": "definition_activity_01WVUW8X1A9X26E6Am5TykQnmyIKvmNj70l",
																  "name": "Set Variables",
																  "title": "Update Expiring Rules",
																  "type": "core.set_multiple_variables",
																  "base_type": "activity",
																  "properties": {
																	"continue_on_failure": false,
																	"display_name": "Update Expiring Rules",
																	"skip_execution": false,
																	"variables_to_update": [
																	  {
																		"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X13A93EIFV467vVyH0NJkBM3ZKvIIhHra$",
																		"variable_value_new": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X13A93EIFV467vVyH0NJkBM3ZKvIIhHra$\n\n**Policy:** [$activity.definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m.input.source_array[@].name$]($workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4GQIZI9Z0D0gY2ZiucaCvm4icK2Gvdx8$/ddd/#FirewallPolicyEditor;uuid=$activity.definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m.input.source_array[@].id$)\n**Rule:** `$activity.definition_activity_01WVUSWML5UA16KMX0vwlnf2AIQpV35EDkQ.input.source_array[@].name$`\n**Message:** Timebased object `$activity.definition_activity_01WVUT8EPUC7Y1E23TkbbE5wHBQeDWL03Tn.output.jsonpath_queries.timeObjectName$` is set to expire in $activity.definition_activity_01X13PZER7D4J2fGWXkNhTCglkN1WWjxEWd.output.days$ days on $activity.definition_activity_01X140VXIJ1JN47gSu02d1FFNP4ch1anicR.output.parts[0]$."
																	  }
																	]
																  },
																  "object_type": "definition_activity"
																}
															  ]
															}
														  ]
														}
													  ]
													}
												  ]
												},
												{
												  "unique_name": "definition_activity_01WVVBVFQXZF872FDuGHdcOSu5XeRhTe2Q8",
												  "name": "Condition Branch",
												  "title": "No",
												  "type": "logic.condition_block",
												  "base_type": "activity",
												  "properties": {
													"condition": {
													  "left_operand": "$activity.definition_activity_01X4H628T6ZK83qxkDVKFl3NyloLFvBBw5W.output.succeeded$",
													  "operator": "eq",
													  "right_operand": false
													},
													"continue_on_failure": false,
													"display_name": "No",
													"skip_execution": false
												  },
												  "object_type": "definition_activity",
												  "actions": [
													{
													  "unique_name": "definition_activity_01YMQKPUVS4PR44X1Z1lzLH2b0hgSFx6hWy",
													  "name": "Set Variables",
													  "title": "Set Error Message",
													  "type": "core.set_multiple_variables",
													  "base_type": "activity",
													  "properties": {
														"continue_on_failure": false,
														"display_name": "Set Error Message",
														"skip_execution": false,
														"variables_to_update": [
														  {
															"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ$",
															"variable_value_new": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ$\n\nFailed to parse policy rules to table for \"$activity.definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m.input.source_array[@].name$\"."
														  }
														]
													  },
													  "object_type": "definition_activity"
													},
													{
													  "unique_name": "definition_activity_01X08NDQ7JAVP4TnP1gzhTLxaYyjUFdNTL2",
													  "name": "Continue",
													  "title": "Continue",
													  "type": "logic.continue",
													  "base_type": "activity",
													  "properties": {
														"continue_on_failure": false,
														"display_name": "Continue",
														"skip_execution": false
													  },
													  "object_type": "definition_activity"
													}
												  ]
												}
											  ]
											}
										  ]
										},
										{
										  "unique_name": "definition_activity_01Y1N9BTRSOGC3A8mMo9blthQhT3CIqmFxF",
										  "name": "Condition Branch",
										  "title": "No",
										  "type": "logic.condition_block",
										  "base_type": "activity",
										  "properties": {
											"condition": {
											  "left_operand": "$activity.definition_activity_01Y1N7UYHXS7G02Ng0z3m4QHr2I5GhhUGvc.output.jsonpath_queries.pagingCount$",
											  "operator": "eq",
											  "right_operand": "0"
											},
											"continue_on_failure": false,
											"display_name": "No",
											"skip_execution": false
										  },
										  "object_type": "definition_activity",
										  "actions": [
											{
											  "unique_name": "definition_activity_01Y1NA9ODKVKF6JxvK1TBU6J9gf5h6sfUhW",
											  "name": "Break",
											  "title": "Break",
											  "type": "logic.break",
											  "base_type": "activity",
											  "properties": {
												"continue_on_failure": false,
												"display_name": "Break",
												"skip_execution": false
											  },
											  "object_type": "definition_activity"
											}
										  ]
										}
									  ]
									}
								  ]
								},
								{
								  "unique_name": "definition_activity_01X08MA2NF2T73mcarKlHOtNFViWVBLmlyr",
								  "name": "Condition Branch",
								  "title": "Anything Else",
								  "type": "logic.condition_block",
								  "base_type": "activity",
								  "properties": {
									"condition": {
									  "left_operand": "$activity.definition_activity_01WVUMSY8A5W54uOVN0FMFXFYy3uolp67je.output.status_code$",
									  "operator": "ne",
									  "right_operand": 200
									},
									"continue_on_failure": false,
									"display_name": "Anything Else",
									"skip_execution": false
								  },
								  "object_type": "definition_activity",
								  "actions": [
									{
									  "unique_name": "definition_activity_01X588X0LWT8Y7VG2eqQOwYglVEV9u7sISJ",
									  "name": "Set Variables",
									  "title": "Set Error Message",
									  "type": "core.set_multiple_variables",
									  "base_type": "activity",
									  "properties": {
										"continue_on_failure": false,
										"display_name": "Set Error Message",
										"skip_execution": false,
										"variables_to_update": [
										  {
											"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ$",
											"variable_value_new": "Failed to retrieve policy rules for \"$activity.definition_activity_01WVUKJS2FIJI6A4PABhsLgpuWc7pZlL05m.input.source_array[@].name$\".\n\nStatus code: $activity.definition_activity_01WVUMSY8A5W54uOVN0FMFXFYy3uolp67je.output.status_code$\nResponse body: $activity.definition_activity_01WVUMSY8A5W54uOVN0FMFXFYy3uolp67je.output.response_body$"
										  }
										]
									  },
									  "object_type": "definition_activity"
									},
									{
									  "unique_name": "definition_activity_01YMV6NAIOUBX56eJTJ705QlnsCQaxCo9Wh",
									  "name": "Break",
									  "title": "Break",
									  "type": "logic.break",
									  "base_type": "activity",
									  "properties": {
										"continue_on_failure": false,
										"display_name": "Break",
										"skip_execution": false
									  },
									  "object_type": "definition_activity"
									}
								  ]
								}
							  ]
							}
						  ]
						}
					  ]
					}
				  ]
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01X08IGB5DNN52WQp3yTUUcD0MzHGHY7cS1",
			  "name": "Condition Branch",
			  "title": "Anything Else",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01WVU4XHMN2112gvmStfuMceIxOfBVQEzt4.output.status_code$",
				  "operator": "ne",
				  "right_operand": 200
				},
				"continue_on_failure": false,
				"display_name": "Anything Else",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01X586YQMF7632QSlC2pZQlLZpPBrZ7u3yK",
				  "name": "Set Variables",
				  "title": "Set Error Message",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set Error Message",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ$",
						"variable_value_new": "Failed to retrieve access policies from the Secure Firewall Management Center.\n\nStatus code: $activity.definition_activity_01WVU4XHMN2112gvmStfuMceIxOfBVQEzt4.output.status_code$\nResponse body: $activity.definition_activity_01WVU4XHMN2112gvmStfuMceIxOfBVQEzt4.output.response_body$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01X58A8XP5Z1S5EleoFrRq0GrRm3UlNnOtX",
		  "name": "Condition Block",
		  "title": "Results returned?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Results returned?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01X58V599GXJT2B4dtJWXC1Oz7C6frdSq95",
			  "name": "Condition Branch",
			  "title": "Errors Found",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ$",
				  "operator": "ne",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "Errors Found",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01X58W8A6YFPL2lDqYlESQQtbUPKwPNOfCi",
				  "name": "Set Variables",
				  "title": "Update Results",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Update Results",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$",
						"variable_value_new": "# Secure Firewall - Get Expiring Rules\n## Worflow FAILED\n\n---\n\n[Click here]($workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1PEWSXIPP936VsIPEIQos0xlOoNsyGMy$) to view the workflow run.\n\n---\n\n$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ$\n\n$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01Y1MGF2AKC4P60kip8tqIMkySLgQImq1ff",
			  "name": "Condition Branch",
			  "title": "No errors, no results",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": {
					"left_operand": {
					  "left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X588GV62V436KLCxDk1nULqFkAGAqcDBQ$",
					  "operator": "eq",
					  "right_operand": ""
					},
					"operator": "and",
					"right_operand": {
					  "left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4JIF7W3SSX5KXWCcn3FUXbvAcol73WQA$",
					  "operator": "eq",
					  "right_operand": ""
					}
				  },
				  "operator": "and",
				  "right_operand": {
					"left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X13A93EIFV467vVyH0NJkBM3ZKvIIhHra$",
					"operator": "eq",
					"right_operand": ""
				  }
				},
				"continue_on_failure": false,
				"display_name": "No errors, no results",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01Y1MHON2JS0N4BdlbIcNqEOKBXVxEyGzeF",
				  "name": "Completed",
				  "title": "Completed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "succeeded",
					"continue_on_failure": false,
					"display_name": "Completed",
					"result_message": "No expired or soon-to-expire rules found.",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01X58B1ZZ9PW32K9fxj6XbF4BvIVLXFUJ5i",
			  "name": "Condition Branch",
			  "title": "Expired/Expiring Rules Found",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": {
					"left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4JIF7W3SSX5KXWCcn3FUXbvAcol73WQA$",
					"operator": "ne",
					"right_operand": ""
				  },
				  "operator": "or",
				  "right_operand": {
					"left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X13A93EIFV467vVyH0NJkBM3ZKvIIhHra$",
					"operator": "ne",
					"right_operand": ""
				  }
				},
				"continue_on_failure": false,
				"display_name": "Expired/Expiring Rules Found",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01WVV96R466LI11jJTZM4iZlT9m8uUt59Bg",
				  "name": "Set Variables",
				  "title": "Update Results",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Update Results",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$",
						"variable_value_new": "# Secure Firewall - Get Expiring Rules\n## Workflow COMPLETE\n\n---\n\n[Click here]($workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01Y1PEWSXIPP936VsIPEIQos0xlOoNsyGMy$) to view the workflow run.\n\n---\n\nA SecureX Orchestration workflow has discovered one or more policies with time-based rules which are expired or are set to expire within the next **$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X12DD0SR2M961TUwJTA2jmEzQBiHnBt5K$** days. Please review each object and consider removing or updating any expired or soon-to-expire rules."
					  }
					]
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01X4JJ4A6NGWC4RIw1vLXAF90KC5A2ESk4y",
				  "name": "Condition Block",
				  "title": "Expired rules discovered?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Expired rules discovered?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01X4JJ4A6O56R4xe61xbNQFaRdigS8FP7HQ",
					  "name": "Condition Branch",
					  "title": "Yes",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4JIF7W3SSX5KXWCcn3FUXbvAcol73WQA$",
						  "operator": "ne",
						  "right_operand": ""
						},
						"continue_on_failure": false,
						"display_name": "Yes",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01X4JJ4A6Q1N74Sg6PJZwpnimpz8vElqvD1",
						  "name": "Set Variables",
						  "title": "Update Results",
						  "type": "core.set_multiple_variables",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Update Results",
							"skip_execution": false,
							"variables_to_update": [
							  {
								"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$",
								"variable_value_new": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$\n\n---\n\n### Expired Rules:\n$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X4JIF7W3SSX5KXWCcn3FUXbvAcol73WQA$"
							  }
							]
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				},
				{
				  "unique_name": "definition_activity_01X14JROOSYX810NLXi178twQ9KMnuxJpq8",
				  "name": "Condition Block",
				  "title": "Expiring rules discovered?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Expiring rules discovered?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01X14JRP5JB9K3nnx7TIqL3jwnhsdsoxvn0",
					  "name": "Condition Branch",
					  "title": "Yes",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X13A93EIFV467vVyH0NJkBM3ZKvIIhHra$",
						  "operator": "ne",
						  "right_operand": ""
						},
						"continue_on_failure": false,
						"display_name": "Yes",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01WVUY4HUQS747ZKodxaJ7f6r1xLIrRyXWm",
						  "name": "Set Variables",
						  "title": "Update Results",
						  "type": "core.set_multiple_variables",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Update Results",
							"skip_execution": false,
							"variables_to_update": [
							  {
								"variable_to_update": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$",
								"variable_value_new": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$\n\n---\n\n### Expiring Rules:\n$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01X13A93EIFV467vVyH0NJkBM3ZKvIIhHra$"
							  }
							]
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01X593VC5L07672GkxylfB88jYKRVyuA0nl",
		  "name": "Group",
		  "title": "Send Webex message",
		  "type": "logic.group",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Send Webex message",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "actions": [
			{
			  "unique_name": "definition_activity_01WVVISDPEQMJ7Ky1BUTV1TopwAf96dI48z",
			  "name": "Webex - Post Message to Room",
			  "title": "Webex - Post Message to Room",
			  "type": "workflow.atomic_workflow",
			  "base_type": "subworkflow",
			  "properties": {
				"continue_on_failure": true,
				"display_name": "Webex - Post Message to Room",
				"input": {
				  "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01XAHZF3RXB0I4R2L8hTNRonWUZG0dySOYf.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
				  "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01XAHZ25H07E93rRjhiOR559W3m5Ap5uhjI$",
				  "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "$workflow.definition_workflow_01WVT28096I5E0j1oYDuwGpaxQwB2PO3DUC.local.variable_workflow_01WVUWJKA4V5N2oj59M4HepihbFUiExZ1AW$",
				  "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
				  "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
				},
				"runtime_user": {
				  "target_default": true
				},
				"skip_execution": false,
				"target": {
				  "override_workflow_target_group_criteria": true,
				  "target_group": {
					"run_on_all_targets": false,
					"use_criteria": {
					  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
					  "conditions": [
						{
						  "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
						  "operator": "eqi",
						  "right_operand": "Webex Teams"
						}
					  ]
					}
				  }
				},
				"workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
				"workflow_name": "Webex - Post Message to Room"
			  },
			  "object_type": "definition_activity"
			},
			{
			  "unique_name": "definition_activity_01X58TXEAUXQ15IpgebZWDZCUvtdQSftb6y",
			  "name": "Condition Block",
			  "title": "Was the message posted successfully?",
			  "type": "logic.if_else",
			  "base_type": "activity",
			  "properties": {
				"continue_on_failure": false,
				"display_name": "Was the message posted successfully?",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "blocks": [
				{
				  "unique_name": "definition_activity_01X58Z8DYY5XK7jcdaa6cSoWeiseovyEn4Q",
				  "name": "Condition Branch",
				  "title": "No",
				  "type": "logic.condition_block",
				  "base_type": "activity",
				  "properties": {
					"condition": {
					  "left_operand": "$activity.definition_activity_01WVVISDPEQMJ7Ky1BUTV1TopwAf96dI48z.output.succeeded$",
					  "operator": "eq",
					  "right_operand": false
					},
					"continue_on_failure": false,
					"display_name": "No",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01X58ZDYTJBCV7gIHY43l28ZzvlTnmKYMkd",
					  "name": "Completed",
					  "title": "Failed",
					  "type": "logic.completed",
					  "base_type": "activity",
					  "properties": {
						"completion_type": "failed-completed",
						"continue_on_failure": false,
						"display_name": "Failed",
						"result_message": "Workflow completed, however, the Webex message could not be sent.\n\nError: $activity.definition_activity_01WVVISDPEQMJ7Ky1BUTV1TopwAf96dI48z.output.error.message$",
						"skip_execution": false
					  },
					  "object_type": "definition_activity"
					}
				  ]
				}
			  ]
			}
		  ]
		}
	  ],
	  "categories": [
		"category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
	  ]
	},
	"target_groups": {
	  "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
		"unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
		"name": "Default TargetGroup",
		"title": "Default TargetGroup",
		"type": "generic.target_group",
		"base_type": "target_group",
		"version": "1.0.0",
		"targets": [
		  {
			"data_target_type": "web-service.endpoint",
			"view_target_type": "web-service.endpoint",
			"include_all_targets": true
		  },
		  {
			"data_target_type": "email.smtp_endpoint",
			"view_target_type": "email.smtp_endpoint",
			"include_all_targets": true
		  }
		],
		"object_type": "target_group"
	  }
	},
	"atomic_workflows": [
	  "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
	  "definition_workflow_01PP76OBLMFFT4g43eU1MrFz5S7BxbqRzOk",
	  "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
	],
	"dependent_workflows": [
	  "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
	  "definition_workflow_01PP76OBLMFFT4g43eU1MrFz5S7BxbqRzOk",
	  "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
	]
  }