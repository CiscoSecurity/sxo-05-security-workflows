{
  "workflow": {
    "unique_name": "definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF",
    "name": "0016 - SCA - Block IPs and Domains from Alerts",
    "title": "0016 - SCA - Block IPs and Domains from Alerts",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Teams Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex Teams room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01JPY92AW0OGU232MCmMNQVtPzApkLAZfO6",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "open",
          "scope": "local",
          "name": "Secure Cloud Analytics Alert Status",
          "type": "datatype.string",
          "description": "The status of the alerts to fetch from Stealthwatch Cloud. This should be one of the following: all, open, closed (case Sensitive)",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01JPWL2ZYZRFE4Mos4qbH8VCZgCyT3E1k6l",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Umbrella Organization ID",
          "type": "datatype.string",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01JJX43X1JT2D7UvhC00eidKJZKhIwCCrVc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Secure Cloud Analytics Alert Name",
          "type": "datatype.string",
          "description": "The name of the alerts to fetch from Stealthwatch Cloud",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01JJWOS0O6PFJ2BxAAuVVrfIRfpYbD27i3W",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Umbrella IP Destination List",
          "type": "datatype.string",
          "description": "Name of the Umbrella destination list to add IP addresses to. If you don't want to add IPs to a list, leave this blank",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01J7V0JZGTYIQ4AmatZ1XvBlgCnzdECRFDw",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "List of Blocked Items",
          "type": "datatype.string",
          "description": "Placeholder for a list of blocked IPs and domains",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01MQZYNQM8PQV6D1euPHqNdy7PtWOJX63fn",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Teams Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex Teams API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01JPZ68MN93582l1vD0kPf2soZ6WSFKBQHV",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Secure Cloud Analytics API Key",
          "type": "datatype.secure_string",
          "description": "You can generate or regenerate an API key on your user page in your Stealthwatch Cloud portal. If you already have an API key for SWC in a global variable, use the group at the beginning of the workflow to set this variable to the global variable's value",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01JJWRT5KLW716ZP4ImKznD7yKWkAWr0X05",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Umbrella Domain Destination List",
          "type": "datatype.string",
          "description": "Name of the Umbrella destination list to add domain names to. If you don't want to add domains to a list, leave this blank",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01J7V0QBDDQUY5ubyzX1v7l4wtZWEJiy6f4",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "List of Not Blocked Items",
          "type": "datatype.string",
          "description": "Placeholder for a list of IPs and domains that were not blocked",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow fetches alerts from Cisco Secure Cloud Analytics (SCA) for the past 24 hours based on the alert name and status provided. Observations are extracted from the alerts and their associated IPs, domain names, and URLs are logged. Each IP address, domain name, and URL is then added to a destination list in Cisco Umbrella (depending on workflow configuration). Finally, a Webex Teams message is sent with a summary.\n\nNote: This workflow will only fetch the first 100 alerts. If you want to fetch more, update the limit on the \"SCA - Get Alerts\" activity.\n\nTarget Group: Default TargetGroup\n\nTargets: Secure Cloud Analytics, Umbrella Management, Webex Teams\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0016",
      "display_name": "0016 - SCA - Block IPs and Domains from Alerts",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "Secure Cloud Analytics"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01MKUW8B9EQX0178D4Fs98Qn8gaJaKCLSju",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch global variables",
          "skip_execution": true
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01MKUWTMEJBKH2cZUT8L0XYjBE1LDqcaEm4",
            "name": "Set Variables",
            "title": "Fetch global variables ",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch global variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JPZ68MN93582l1vD0kPf2soZ6WSFKBQHV$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJWRT5KLW716ZP4ImKznD7yKWkAWr0X05$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJX43X1JT2D7UvhC00eidKJZKhIwCCrVc$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01J7V0JZGTYIQ4AmatZ1XvBlgCnzdECRFDw$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01J7V0QBDDQUY5ubyzX1v7l4wtZWEJiy6f4$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01MR02XW3JBFQ2h3kRLvT16dPu4dbZ0RxG8",
        "name": "Condition Block",
        "title": "Were both destination lists blank?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Were both destination lists blank?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01MR02YK4QBWT2ZoGXdRn9LC5omFVYaTelo",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01J7V0QBDDQUY5ubyzX1v7l4wtZWEJiy6f4$",
                  "operator": "eq",
                  "right_operand": ""
                },
                "operator": "and",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01J7V0JZGTYIQ4AmatZ1XvBlgCnzdECRFDw$",
                  "operator": "eq",
                  "right_operand": ""
                }
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01MR03GIIQD5S4XmJrr60xld2B358mw0Ku1",
                "name": "Completed",
                "title": "No destination lists",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "No destination lists",
                  "result_message": "You must specify a destination list for IP addresses or domain names (or both)",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01MD5BJLP2JC90bGa8jqhVcK5MbZrDvlLba",
        "name": "Group",
        "title": "Calculate report dates",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Calculate report dates",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01MD5BMMPI2Q47aFHBBE45Hu8JW2AhqB7wa",
            "name": "Calculate Date",
            "title": "Calculate start date",
            "type": "core.calculate_date",
            "base_type": "activity",
            "properties": {
              "adjustment": -86400,
              "continue_on_failure": false,
              "display_name": "Calculate start date",
              "original_date": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.output.start_time$",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MDUYVP4YL9X0sHOwkgM06vlNCOSOEZoJ9",
            "name": "Calculate Date",
            "title": "Calculate end date",
            "type": "core.calculate_date",
            "base_type": "activity",
            "properties": {
              "adjustment": 0,
              "continue_on_failure": false,
              "display_name": "Calculate end date",
              "original_date": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.output.start_time$",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01J7VA4BB466H60lTL8rJX4TAe7kIYgfP9n",
        "name": "Group",
        "title": "Get alerts and associated observations",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Get alerts and associated observations",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01JPWCGB48Z5P6x3pdFI7hc6rYYd0KkygzM",
            "name": "SCA - Get Alerts",
            "title": "SCA - Get Alerts",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "SCA - Get Alerts",
              "input": {
                "variable_workflow_01PP767ENJBFA5SN9YJC7swhvNCTdtgTVvK": "$activity.definition_activity_01MD5BMMPI2Q47aFHBBE45Hu8JW2AhqB7wa.output.result$",
                "variable_workflow_01PP767ENJEQ96BUYwuD5WCUPqI1f7d8tW5": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJWOS0O6PFJ2BxAAuVVrfIRfpYbD27i3W$",
                "variable_workflow_01PP767ENJFWZ2lRbLkNzB68HQefGY1Mr4e": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JPWL2ZYZRFE4Mos4qbH8VCZgCyT3E1k6l$",
                "variable_workflow_01PP767ENJH2S4VttPD6BHxHR3AZszCkzg8": 0,
                "variable_workflow_01PP767ENJI7Y1nCg4PDqDlFSw9BGqcc48m": "$activity.definition_activity_01MDUYVP4YL9X0sHOwkgM06vlNCOSOEZoJ9.output.result$",
                "variable_workflow_01PP767ENJKGT3cQ36vcV8I04GCm7Z0JuZi": 100,
                "variable_workflow_01PP767ENJLM97Xsdwn8fEod1HP3whVWfvU": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJWRT5KLW716ZP4ImKznD7yKWkAWr0X05$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target_group": true
              },
              "workflow_id": "definition_workflow_01PP767EUS6Q52H9Ww5DQjcJoxKwKBIMkdK"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MD61N0KUAV25txAeoaISZnhZW6JhuPH8H",
            "name": "JSONPath Query",
            "title": "Get all observations",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Get all observations",
              "input_json": "$activity.definition_activity_01JPWCGB48Z5P6x3pdFI7hc6rYYd0KkygzM.output.variable_workflow_01PP767ENJJDI5V6ZUMTo1uD5nXQKHXXps5$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.objects[*].observations[*]",
                  "jsonpath_query_name": "observations",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MD688IHXQXP35CslsJ6eGwuajhXqaSaxL",
            "name": "Condition Block",
            "title": "Did we get observations?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Did we get observations?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01MD6894XF3Z27IxWdiIo5eQpMcL2ZcwScB",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01MD61N0KUAV25txAeoaISZnhZW6JhuPH8H.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01MD699Z8JNRZ5X6r0kAb0uvVPoN8l1hBSh",
                    "name": "Completed",
                    "title": "Completed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Completed",
                      "result_message": "No observations were returned by Secure Cloud Analytics",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01MD62R5ZU8PO1d1ag6Ulh2rlOGCr3lgUux",
            "name": "Replace String",
            "title": "Remove brackets",
            "type": "core.replacestring",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Remove brackets",
              "input_string": "$activity.definition_activity_01MD61N0KUAV25txAeoaISZnhZW6JhuPH8H.output.jsonpath_queries.observations$",
              "replace_list": [
                {
                  "replaced_string": "]",
                  "replacement_string": ""
                },
                {
                  "replaced_string": "[",
                  "replacement_string": ""
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MD63LF8893I4gxLCunKhC7Zn7wEx8DUw2",
            "name": "Split String",
            "title": "Convert observations to array",
            "type": "core.splitstring",
            "base_type": "activity",
            "properties": {
              "boundaries": [
                {
                  "boundary": ","
                }
              ],
              "continue_on_failure": false,
              "display_name": "Convert observations to array",
              "input_string": "$activity.definition_activity_01MD62R5ZU8PO1d1ag6Ulh2rlOGCr3lgUux.output.result_string$",
              "remove_empty": true,
              "skip_execution": false
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01MQZHLPHHDMO7U97DiNxoBtR7I126hTmRL",
        "name": "Group",
        "title": "Set up tables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set up tables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa",
            "name": "Read Table from JSON",
            "title": "Create a table for IP addresses",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Create a table for IP addresses",
              "input_json": "[]",
              "jsonpath_query": "$.",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "ip_address",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd",
            "name": "Read Table from JSON",
            "title": "Create a table for domains",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Create a table for domains",
              "input_json": "[]",
              "jsonpath_query": "$.",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "domain",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01JPXL3MF67MR6mXj5N9weBSGZxJAMkNR9S",
        "name": "For Each",
        "title": "For each observation",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For each observation",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01MD63LF8893I4gxLCunKhC7Zn7wEx8DUw2.output.parts$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LXW6S1NANKF1pROXwfJxt6CLWsNvCi3fI",
            "name": "SCA - Get Observation Details by ID",
            "title": "SCA - Get Observation Details by ID",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "SCA - Get Observation Details by ID",
              "input": {
                "variable_workflow_01PP75TXGPWKD7JeAS9njbPB9iQMwsLFkpv": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJWRT5KLW716ZP4ImKznD7yKWkAWr0X05$",
                "variable_workflow_01PP75TXGPXTH1WmumDBJ9PXCTaWRKRtfjl": "$activity.definition_activity_01JPXL3MF67MR6mXj5N9weBSGZxJAMkNR9S.input.source_array[@]$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target_group": true
              },
              "workflow_id": "definition_workflow_01PP75TXMT8S84vRSb0JXxLJKaVaRaJxIDr"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MQZFCBGPK5I3yM8GEbSQJC7DyZJaIUJ84",
            "name": "Parallel Block",
            "title": "Parallel Block",
            "type": "logic.parallel",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Parallel Block",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01MQZFCYWG93N0MCz6ZAxjwTJ1T6vGtmWGj",
                "name": "Parallel Branch",
                "title": "Parse IP address",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parse IP address",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01J7816YKPQL92CycXXrkz9ZIRnQVsOj43m",
                    "name": "JSONPath Query",
                    "title": "Extract IP address",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract IP address",
                      "input_json": "$activity.definition_activity_01LXW6S1NANKF1pROXwfJxt6CLWsNvCi3fI.output.variable_workflow_01PP75TXGPRW75Dcta1hL4brB1UkeXfMPhj$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.cts_matched_ip",
                          "jsonpath_query_name": "destination_ip",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01MQZFVFV3DTS6WljBkbCLHvWri1UPnCwhc",
                    "name": "Condition Block",
                    "title": "Did we get an IP?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we get an IP?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01MQZLSWVC7PB2ZoKmk0SiInkxMvtoZJoKP",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01J7816YKPQL92CycXXrkz9ZIRnQVsOj43m.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MQZOV4QFSBN5Ky8xevfbeATIsV42MqMjF",
                            "name": "Execute Python Script",
                            "title": "Execute reverse lookup for IP",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Execute reverse lookup for IP",
                              "script": "import socket, sys\n\nreversed_dns = socket.gethostbyaddr(sys.argv[1])[0]",
                              "script_arguments": [
                                "$activity.definition_activity_01J7816YKPQL92CycXXrkz9ZIRnQVsOj43m.output.jsonpath_queries.destination_ip$"
                              ],
                              "script_queries": [
                                {
                                  "script_query": "reversed_dns",
                                  "script_query_name": "reversed_dns",
                                  "script_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MQZPK362GPF0AWyLMjkbdPIRcClqfsACT",
                            "name": "Condition Block",
                            "title": "Did we get a domain name?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Did we get a domain name?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01MQZQSU9VM5G2mXcVQmpuFurY0QHTNL95x",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MQZOV4QFSBN5Ky8xevfbeATIsV42MqMjF.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MQZQSVCLV7P3OUUBD6xjuosynPChgQTH5",
                                    "name": "Select from Table",
                                    "title": "Check if the domain is in the table",
                                    "type": "core.selectfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "columns": [
                                        {
                                          "column_name": "domain",
                                          "column_type": "string"
                                        }
                                      ],
                                      "continue_on_failure": false,
                                      "display_name": "Check if the domain is in the table",
                                      "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                      "number_of_rows": {
                                        "at_most": true,
                                        "first_n_rows": 1
                                      },
                                      "persist_output": false,
                                      "skip_execution": false,
                                      "sorting": {
                                        "no_sort": true,
                                        "sort_by": false
                                      },
                                      "where_clause": "domain == '$activity.definition_activity_01MQZOV4QFSBN5Ky8xevfbeATIsV42MqMjF.output.script_queries.reversed_dns$'"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MQZQT756MY413ipQfLTQpN7OfEwEYuEqF",
                                    "name": "Condition Block",
                                    "title": "Is the domain in the table already?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Is the domain in the table already?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01MQZQTIMU8JE4mJ2BfUhrWIsBTzSEidzCY",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01MQZQSVCLV7P3OUUBD6xjuosynPChgQTH5.output.row_count$",
                                            "operator": "eq",
                                            "right_operand": 0
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "No",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01MQZQTJF0FY14VZSlBUC2XqUtd560tnOAX",
                                            "name": "Add Row to Table",
                                            "title": "Add domain to table",
                                            "type": "core.addrowtotable",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Add domain to table",
                                              "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                              "row": [
                                                {
                                                  "key": "domain",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01MQZOV4QFSBN5Ky8xevfbeATIsV42MqMjF.output.script_queries.reversed_dns$"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01MRP6H2OA8JG21xhrzNXcjnu5w85eU82mV",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MQZOV4QFSBN5Ky8xevfbeATIsV42MqMjF.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MQZLSXWAJH62Dp717FOPl3IhQCifriFee",
                                    "name": "Select from Table",
                                    "title": "Check if the IP is in the table",
                                    "type": "core.selectfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "columns": [
                                        {
                                          "column_name": "ip_address",
                                          "column_type": "string"
                                        }
                                      ],
                                      "continue_on_failure": false,
                                      "display_name": "Check if the IP is in the table",
                                      "input_table": "$activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.read_table_from_json$",
                                      "number_of_rows": {
                                        "at_most": true,
                                        "first_n_rows": 1
                                      },
                                      "persist_output": false,
                                      "skip_execution": false,
                                      "sorting": {
                                        "no_sort": true,
                                        "sort_by": false
                                      },
                                      "where_clause": "ip_address == '$activity.definition_activity_01J7816YKPQL92CycXXrkz9ZIRnQVsOj43m.output.jsonpath_queries.destination_ip$'"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MQZLT9B6P1L38T1QHE7ZYycqfaLBSeaP4",
                                    "name": "Condition Block",
                                    "title": "Is the IP in the table already?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Is the IP in the table already?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01MQZLTKSN5N51gxkns2HLcEAoF6CULuyhg",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01MQZLSXWAJH62Dp717FOPl3IhQCifriFee.output.row_count$",
                                            "operator": "eq",
                                            "right_operand": 0
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "No",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01MQZLTLHRAX016vDC31aXpDAMykrnpsiL7",
                                            "name": "Add Row to Table",
                                            "title": "Add IP to table",
                                            "type": "core.addrowtotable",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Add IP to table",
                                              "input_table": "$activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.read_table_from_json$",
                                              "row": [
                                                {
                                                  "key": "ip_address",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01J7816YKPQL92CycXXrkz9ZIRnQVsOj43m.output.jsonpath_queries.destination_ip$"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01N6UN7CCP5LZ48qaRLs1IJzWqNaXSWXAzN",
                "name": "Parallel Branch",
                "title": "Parse external IP address",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parse external IP address",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01N6UN7D8K3LL6q83L5Dx4HUbNCzDQ74iUd",
                    "name": "JSONPath Query",
                    "title": "Extract external IP address",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract external IP address",
                      "input_json": "$activity.definition_activity_01LXW6S1NANKF1pROXwfJxt6CLWsNvCi3fI.output.variable_workflow_01PP75TXGPRW75Dcta1hL4brB1UkeXfMPhj$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.external_ip",
                          "jsonpath_query_name": "destination_ip",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01N6UN7QLDD976ihLYdrZarP6IEsogpn3AB",
                    "name": "Condition Block",
                    "title": "Did we get an IP?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we get an IP?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01N6UN830S4JN3aZl6dYq0VVF87KI3gX6E6",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01N6UN7D8K3LL6q83L5Dx4HUbNCzDQ74iUd.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01N6UN83SG9SE4Xm27aTVcWKnzthdDsmo52",
                            "name": "Execute Python Script",
                            "title": "Execute reverse lookup for IP",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Execute reverse lookup for IP",
                              "script": "import socket, sys\n\nreversed_dns = socket.gethostbyaddr(sys.argv[1])[0]",
                              "script_arguments": [
                                "$activity.definition_activity_01N6UN7D8K3LL6q83L5Dx4HUbNCzDQ74iUd.output.jsonpath_queries.destination_ip$"
                              ],
                              "script_queries": [
                                {
                                  "script_query": "reversed_dns",
                                  "script_query_name": "reversed_dns",
                                  "script_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01N6UN8G3XHMX4UKe3PuGZ0KbX4hZQE4lsc",
                            "name": "Condition Block",
                            "title": "Did we get a domain name?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Did we get a domain name?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01N6UN8SOUKMI48cvuLcFHQxdY8DoNpww3R",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01N6UN83SG9SE4Xm27aTVcWKnzthdDsmo52.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01N6UN8TCQRDE42AbtBYzAeNBzBE1LOF4ib",
                                    "name": "Select from Table",
                                    "title": "Check if the domain is in the table",
                                    "type": "core.selectfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "columns": [
                                        {
                                          "column_name": "domain",
                                          "column_type": "string"
                                        }
                                      ],
                                      "continue_on_failure": false,
                                      "display_name": "Check if the domain is in the table",
                                      "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                      "number_of_rows": {
                                        "at_most": true,
                                        "first_n_rows": 1
                                      },
                                      "persist_output": false,
                                      "skip_execution": false,
                                      "sorting": {
                                        "no_sort": true,
                                        "sort_by": false
                                      },
                                      "where_clause": "domain == '$activity.definition_activity_01N6UN83SG9SE4Xm27aTVcWKnzthdDsmo52.output.script_queries.reversed_dns$'"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01N6UN95QNHYF6efHcPVTpPQ7lqaISFd6Ua",
                                    "name": "Condition Block",
                                    "title": "Is the domain in the table already?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Is the domain in the table already?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01N6UN9IJDYP12nsDd1JxPBL2drTjU9B5yk",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01N6UN8TCQRDE42AbtBYzAeNBzBE1LOF4ib.output.row_count$",
                                            "operator": "eq",
                                            "right_operand": 0
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "No",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01N6UN9J8HTDP335WcRBquM4gBPBPHcopJh",
                                            "name": "Add Row to Table",
                                            "title": "Add domain to table",
                                            "type": "core.addrowtotable",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Add domain to table",
                                              "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                              "row": [
                                                {
                                                  "key": "domain",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01N6UN83SG9SE4Xm27aTVcWKnzthdDsmo52.output.script_queries.reversed_dns$"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01N6UN9VM2A4R4eQ9gemgnbDJqUTqPDkPvg",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01N6UN83SG9SE4Xm27aTVcWKnzthdDsmo52.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01N6UN9WDJGAF2nryGiwk3r1WzmooRGU22M",
                                    "name": "Select from Table",
                                    "title": "Check if the IP is in the table",
                                    "type": "core.selectfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "columns": [
                                        {
                                          "column_name": "ip_address",
                                          "column_type": "string"
                                        }
                                      ],
                                      "continue_on_failure": false,
                                      "display_name": "Check if the IP is in the table",
                                      "input_table": "$activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.read_table_from_json$",
                                      "number_of_rows": {
                                        "at_most": true,
                                        "first_n_rows": 1
                                      },
                                      "persist_output": false,
                                      "skip_execution": false,
                                      "sorting": {
                                        "no_sort": true,
                                        "sort_by": false
                                      },
                                      "where_clause": "ip_address == '$activity.definition_activity_01N6UN7D8K3LL6q83L5Dx4HUbNCzDQ74iUd.output.jsonpath_queries.destination_ip$'"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01N6UNA8WGW270N7UfrQE84szT0KodxQWW7",
                                    "name": "Condition Block",
                                    "title": "Is the IP in the table already?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Is the IP in the table already?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01N6UNALQO6KQ5wIzFKgLqAEmpXXEVpQG5A",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01N6UN9WDJGAF2nryGiwk3r1WzmooRGU22M.output.row_count$",
                                            "operator": "eq",
                                            "right_operand": 0
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "No",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01N6UNAMHDEQ53z33x5a0lHhW4iO0OxPi3p",
                                            "name": "Add Row to Table",
                                            "title": "Add IP to table",
                                            "type": "core.addrowtotable",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Add IP to table",
                                              "input_table": "$activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.read_table_from_json$",
                                              "row": [
                                                {
                                                  "key": "ip_address",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01N6UN7D8K3LL6q83L5Dx4HUbNCzDQ74iUd.output.jsonpath_queries.destination_ip$"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01N6V1REO4AR73Ev0oO1Fzrl2qzkmU9jUtL",
                "name": "Parallel Branch",
                "title": "Parse connected IP address",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parse connected IP address",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01N6V1RFN7UNA0Ae5UpHFmcSgurerfoWBQ1",
                    "name": "JSONPath Query",
                    "title": "Extract connected IP address",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract connected IP address",
                      "input_json": "$activity.definition_activity_01LXW6S1NANKF1pROXwfJxt6CLWsNvCi3fI.output.variable_workflow_01PP75TXGPRW75Dcta1hL4brB1UkeXfMPhj$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.connected_ip",
                          "jsonpath_query_name": "destination_ip",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01N6V1RS25AD923rsQNARW5tWgmjHSWMaGN",
                    "name": "Condition Block",
                    "title": "Did we get an IP?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we get an IP?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01N6V1S4GJTJW7XEdGFHGdgRdUDSIDnBzjB",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01N6V1RFN7UNA0Ae5UpHFmcSgurerfoWBQ1.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01N6V1S556VQH2Ph0yDAKCfTR0AMxyCxIEI",
                            "name": "Execute Python Script",
                            "title": "Execute reverse lookup for IP",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Execute reverse lookup for IP",
                              "script": "import socket, sys\n\nreversed_dns = socket.gethostbyaddr(sys.argv[1])[0]",
                              "script_arguments": [
                                "$activity.definition_activity_01N6V1RFN7UNA0Ae5UpHFmcSgurerfoWBQ1.output.jsonpath_queries.destination_ip$"
                              ],
                              "script_queries": [
                                {
                                  "script_query": "reversed_dns",
                                  "script_query_name": "reversed_dns",
                                  "script_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01N6V1SHM82AN5vCOnze1rLd8xyIH0vumS8",
                            "name": "Condition Block",
                            "title": "Did we get a domain name?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Did we get a domain name?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01N6V1SV3QP224vnGdt06mIYuPkn1VotfUz",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01N6V1S556VQH2Ph0yDAKCfTR0AMxyCxIEI.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01N6V1SVUG9T16QonmlPRWH0TVFkzEfPWm9",
                                    "name": "Select from Table",
                                    "title": "Check if the domain is in the table",
                                    "type": "core.selectfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "columns": [
                                        {
                                          "column_name": "domain",
                                          "column_type": "string"
                                        }
                                      ],
                                      "continue_on_failure": false,
                                      "display_name": "Check if the domain is in the table",
                                      "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                      "number_of_rows": {
                                        "at_most": true,
                                        "first_n_rows": 1
                                      },
                                      "persist_output": false,
                                      "skip_execution": false,
                                      "sorting": {
                                        "no_sort": true,
                                        "sort_by": false
                                      },
                                      "where_clause": "domain == '$activity.definition_activity_01N6V1S556VQH2Ph0yDAKCfTR0AMxyCxIEI.output.script_queries.reversed_dns$'"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01N6V1T98ZP027cmpLIDLwQGFvMxLkSZjHw",
                                    "name": "Condition Block",
                                    "title": "Is the domain in the table already?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Is the domain in the table already?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01N6V1TLPJI2A04pm43UvuxxGTobUBRCBuL",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01N6V1SVUG9T16QonmlPRWH0TVFkzEfPWm9.output.row_count$",
                                            "operator": "eq",
                                            "right_operand": 0
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "No",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01N6V1TMG58KY1gumS3enmtPxdmsusIQyFx",
                                            "name": "Add Row to Table",
                                            "title": "Add domain to table",
                                            "type": "core.addrowtotable",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Add domain to table",
                                              "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                              "row": [
                                                {
                                                  "key": "domain",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01N6V1S556VQH2Ph0yDAKCfTR0AMxyCxIEI.output.script_queries.reversed_dns$"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01N6V1TYUJCQ60h4WOYndXqWPhCpYxY5pX0",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01N6V1S556VQH2Ph0yDAKCfTR0AMxyCxIEI.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01N6V1TZOHYAE40wA41Rf3bpPnoCFspyhMh",
                                    "name": "Select from Table",
                                    "title": "Check if the IP is in the table",
                                    "type": "core.selectfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "columns": [
                                        {
                                          "column_name": "ip_address",
                                          "column_type": "string"
                                        }
                                      ],
                                      "continue_on_failure": false,
                                      "display_name": "Check if the IP is in the table",
                                      "input_table": "$activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.read_table_from_json$",
                                      "number_of_rows": {
                                        "at_most": true,
                                        "first_n_rows": 1
                                      },
                                      "persist_output": false,
                                      "skip_execution": false,
                                      "sorting": {
                                        "no_sort": true,
                                        "sort_by": false
                                      },
                                      "where_clause": "ip_address == '$activity.definition_activity_01N6V1RFN7UNA0Ae5UpHFmcSgurerfoWBQ1.output.jsonpath_queries.destination_ip$'"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01N6V1UCG3HUA0uT2LD2ckmz2jciRnBm59k",
                                    "name": "Condition Block",
                                    "title": "Is the IP in the table already?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Is the IP in the table already?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01N6V1UP0Z8397Rzd982NBmThJhL1iBvGft",
                                        "name": "Condition Branch",
                                        "title": "No",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01N6V1TZOHYAE40wA41Rf3bpPnoCFspyhMh.output.row_count$",
                                            "operator": "eq",
                                            "right_operand": 0
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "No",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01N6V1UPSFOBI18yyQGyaztbCfNIyB7IPam",
                                            "name": "Add Row to Table",
                                            "title": "Add IP to table",
                                            "type": "core.addrowtotable",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "display_name": "Add IP to table",
                                              "input_table": "$activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.read_table_from_json$",
                                              "row": [
                                                {
                                                  "key": "ip_address",
                                                  "type": "string",
                                                  "value": "$activity.definition_activity_01N6V1RFN7UNA0Ae5UpHFmcSgurerfoWBQ1.output.jsonpath_queries.destination_ip$"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01MQZFCZKNFY15fJIOv1oHKCC0qVCWbN0f7",
                "name": "Parallel Branch",
                "title": "Parse domain",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parse domain",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01MDUES7RZM2D3l9Est7xDgtncSAA0nft49",
                    "name": "JSONPath Query",
                    "title": "Extract domain",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract domain",
                      "input_json": "$activity.definition_activity_01LXW6S1NANKF1pROXwfJxt6CLWsNvCi3fI.output.variable_workflow_01PP75TXGPRW75Dcta1hL4brB1UkeXfMPhj$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.cts_matched_domain",
                          "jsonpath_query_name": "destination_domain",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01MQZH5DPHO3S4f8hvgnmBcjRa82UUNlwAG",
                    "name": "Condition Block",
                    "title": "Did we get a domain?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we get a domain?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01MQZH5QM0N7P6mHiyHzrqxbvP1sYYoPRTr",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01MDUES7RZM2D3l9Est7xDgtncSAA0nft49.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MQZIHKZSP8K4qFeVqppLUHJ0pffmrZENC",
                            "name": "Select from Table",
                            "title": "Check if the domain is in the table",
                            "type": "core.selectfromtable",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "columns": [
                                {
                                  "column_name": "domain",
                                  "column_type": "string"
                                }
                              ],
                              "continue_on_failure": false,
                              "display_name": "Check if the domain is in the table",
                              "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                              "number_of_rows": {
                                "at_most": true,
                                "first_n_rows": 1
                              },
                              "persist_output": false,
                              "skip_execution": false,
                              "sorting": {
                                "no_sort": true,
                                "sort_by": false
                              },
                              "where_clause": "domain == '$activity.definition_activity_01MDUES7RZM2D3l9Est7xDgtncSAA0nft49.output.jsonpath_queries.destination_domain$'"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MQZJFJ9FKXS57C6u6a4Qru5vvKRnstk0y",
                            "name": "Condition Block",
                            "title": "Is the domain in the table already?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Is the domain in the table already?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01MQZJFVUCNUL3whqnfdiE3W2ECxnelHdjX",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MQZIHKZSP8K4qFeVqppLUHJ0pffmrZENC.output.row_count$",
                                    "operator": "eq",
                                    "right_operand": 0
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MQZKBRKDBM87GdB9qtKjA6R76q6HWSpdr",
                                    "name": "Add Row to Table",
                                    "title": "Add domain to table",
                                    "type": "core.addrowtotable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Add domain to table",
                                      "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                      "row": [
                                        {
                                          "key": "domain",
                                          "type": "string",
                                          "value": "$activity.definition_activity_01MDUES7RZM2D3l9Est7xDgtncSAA0nft49.output.jsonpath_queries.destination_domain$"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01N6T9GUFNGKB6GotmI92vikvVF8mfJj57U",
                "name": "Parallel Branch",
                "title": "Parse hostname",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parse hostname",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01N6T9GVHTIQQ2MeqGbRuCfSefM1wgwkZl0",
                    "name": "JSONPath Query",
                    "title": "Extract hostname",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract hostname",
                      "input_json": "$activity.definition_activity_01LXW6S1NANKF1pROXwfJxt6CLWsNvCi3fI.output.variable_workflow_01PP75TXGPRW75Dcta1hL4brB1UkeXfMPhj$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.cts_matched_hostname",
                          "jsonpath_query_name": "destination_hostname",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01N6T9H82QXSM7Ztv3RQevdaQgpwBNzKVO0",
                    "name": "Condition Block",
                    "title": "Did we get a hostname?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we get a hostname?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01N6T9HKP1MY65SpO8zwIcvd8Ih9KKQ3cze",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01N6T9GVHTIQQ2MeqGbRuCfSefM1wgwkZl0.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01N6T9HLFH68S6qN0MSQeXmNrT6s8TEeGu4",
                            "name": "Select from Table",
                            "title": "Check if the domain is in the table",
                            "type": "core.selectfromtable",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "columns": [
                                {
                                  "column_name": "domain",
                                  "column_type": "string"
                                }
                              ],
                              "continue_on_failure": false,
                              "display_name": "Check if the domain is in the table",
                              "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                              "number_of_rows": {
                                "at_most": true,
                                "first_n_rows": 1
                              },
                              "persist_output": false,
                              "skip_execution": false,
                              "sorting": {
                                "no_sort": true,
                                "sort_by": false
                              },
                              "where_clause": "domain == '$activity.definition_activity_01N6T9GVHTIQQ2MeqGbRuCfSefM1wgwkZl0.output.jsonpath_queries.destination_hostname$'"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01N6T9HY02RO52kJhaejSbobLgZhSZqjYzh",
                            "name": "Condition Block",
                            "title": "Is the domain in the table already?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Is the domain in the table already?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01N6T9IAJ26OM0Qr94Ui4fO3Eve7PpS35lR",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01N6T9HLFH68S6qN0MSQeXmNrT6s8TEeGu4.output.row_count$",
                                    "operator": "eq",
                                    "right_operand": 0
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01N6T9IBD4KUH6SNaPEmrPis39QcAMytuw6",
                                    "name": "Add Row to Table",
                                    "title": "Add domain to table",
                                    "type": "core.addrowtotable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Add domain to table",
                                      "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                      "row": [
                                        {
                                          "key": "domain",
                                          "type": "string",
                                          "value": "$activity.definition_activity_01N6T9GVHTIQQ2MeqGbRuCfSefM1wgwkZl0.output.jsonpath_queries.destination_hostname$"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01N6U388AF5OB6HwM4J2PR1SEC5sTFmnaso",
                "name": "Parallel Branch",
                "title": "Parse URL",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parse URL",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01N6U389FIQQ027Jg2hMCM2v9d3lvVA1zkB",
                    "name": "JSONPath Query",
                    "title": "Extract url",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract url",
                      "input_json": "$activity.definition_activity_01LXW6S1NANKF1pROXwfJxt6CLWsNvCi3fI.output.variable_workflow_01PP75TXGPRW75Dcta1hL4brB1UkeXfMPhj$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.cts_matched_url",
                          "jsonpath_query_name": "destination_url",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01N6U38LVKA7P4tAz38NoIJLA0W4mneAMD6",
                    "name": "Condition Block",
                    "title": "Did we get a url?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we get a url?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01N6U38YEHY7F4OE60Eftob9ksYKqTFaohH",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01N6U389FIQQ027Jg2hMCM2v9d3lvVA1zkB.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01N6U38Z4UL5C4Xl7Vn4HpVGJ0wb66m3k1u",
                            "name": "Select from Table",
                            "title": "Check if the domain is in the table",
                            "type": "core.selectfromtable",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "columns": [
                                {
                                  "column_name": "domain",
                                  "column_type": "string"
                                }
                              ],
                              "continue_on_failure": false,
                              "display_name": "Check if the domain is in the table",
                              "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                              "number_of_rows": {
                                "at_most": true,
                                "first_n_rows": 1
                              },
                              "persist_output": false,
                              "skip_execution": false,
                              "sorting": {
                                "no_sort": true,
                                "sort_by": false
                              },
                              "where_clause": "domain == '$activity.definition_activity_01N6U389FIQQ027Jg2hMCM2v9d3lvVA1zkB.output.jsonpath_queries.destination_url$'"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01N6U39N3VJ6I1FGAyrQFOiyDviqCAjqvyT",
                            "name": "Condition Block",
                            "title": "Is the domain in the table already?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Is the domain in the table already?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01N6U39ZFWB2I2J9gN260ZlrWmxHC8rAQ0n",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01N6U38Z4UL5C4Xl7Vn4HpVGJ0wb66m3k1u.output.row_count$",
                                    "operator": "eq",
                                    "right_operand": 0
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01N6U3A073LIA1uDTuj9H6ImKSdnhOwaDVT",
                                    "name": "Add Row to Table",
                                    "title": "Add domain to table",
                                    "type": "core.addrowtotable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Add domain to table",
                                      "input_table": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$",
                                      "row": [
                                        {
                                          "key": "domain",
                                          "type": "string",
                                          "value": "$activity.definition_activity_01N6U389FIQQ027Jg2hMCM2v9d3lvVA1zkB.output.jsonpath_queries.destination_url$"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01MR03XA5H2585C57Aud6fMhvyPyk7IOE7u",
        "name": "Group",
        "title": "Fetch destination lists and take actions",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch destination lists and take actions",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01MR025DUS0B65SuReb8W9NT2FhRb3xt8pQ",
            "name": "Umbrella - Management - Get Destination Lists",
            "title": "Umbrella - Management - Get Destination Lists",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Umbrella - Management - Get Destination Lists",
              "input": {
                "variable_workflow_01PP76E2I524R2Ds69P8MPBNOsTC97lLsjE": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJX43X1JT2D7UvhC00eidKJZKhIwCCrVc$",
                "variable_workflow_01PP76E2I57QC1YKSGlj4FvrIirJajhuiJU": 100,
                "variable_workflow_01PP76E2I598J2s8XLXecj9Ai9616xQ7Vv3": 1
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Umbrella Management"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01PP76E2PZZDF6jy3jVpYnYp5STVy3zReDB"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MR04NBLENY62yxViL8ztpsBhDGaOFvYDu",
            "name": "Group",
            "title": "Process IP addresses",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Process IP addresses",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01MR04BKCLB967OScA93AuK5F1eevPShZOf",
                "name": "JSONPath Query",
                "title": "Extract destination list ID",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Extract destination list ID",
                  "input_json": "$activity.definition_activity_01MR025DUS0B65SuReb8W9NT2FhRb3xt8pQ.output.variable_workflow_01PP76E2I5AGW6ER9Z87Zvcb4O1pjn9Wcwc$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.data[?(@.name=='$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01J7V0JZGTYIQ4AmatZ1XvBlgCnzdECRFDw$')].id",
                      "jsonpath_query_name": "ip_destination_list_id",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01MR04S9CJOKI1XDzLg0CZpryNaQO0KpIDM",
                "name": "Condition Block",
                "title": "Was the destination list found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was the destination list found?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01MR04SLO30HK7DSYYjKOcNAVeICldirxNC",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01MR04BKCLB967OScA93AuK5F1eevPShZOf.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01MR04XJA44VQ0LPVNlUjWh8pNKP9hZaGX6",
                        "name": "For Each",
                        "title": "For each IP address",
                        "type": "logic.for_each",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "For each IP address",
                          "skip_execution": false,
                          "source_array": "$activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.read_table_from_json$"
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MR05IJD3XD36VD9ahSx1e2w3i5x91Xh11",
                            "name": "Umbrella - Management - Add Record to Destination List",
                            "title": "Umbrella - Management - Add Record to Destination List",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Umbrella - Management - Add Record to Destination List",
                              "input": {
                                "variable_workflow_01PR38PRA8DAV0ueGoV9r6wwpoD7SSF757y": "",
                                "variable_workflow_01PR38PRA8HGK1pzCqHFCWKILh6nWkPrpC0": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJX43X1JT2D7UvhC00eidKJZKhIwCCrVc$",
                                "variable_workflow_01PR38PRA8ISH0QK4PJTeo7pPubN1Ft8vi7": "$activity.definition_activity_01MR04BKCLB967OScA93AuK5F1eevPShZOf.output.jsonpath_queries.ip_destination_list_id$",
                                "variable_workflow_01PR38PRA8JXW531nZH86NP15pwRBtmRMOT": "$activity.definition_activity_01MR04XJA44VQ0LPVNlUjWh8pNKP9hZaGX6.input.source_array[@].ip_address$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Umbrella Management"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PR38PRIL1R04x7je59e5UtYqDQ0B1NHet"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MR05SNM8MSY66D1TzkjMUkSJmrbfh8Pbz",
                            "name": "Condition Block",
                            "title": "Was the record added successfully?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Was the record added successfully?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01MR05TB44PUI5FHeDVJvPWMLYU3oo5zGSC",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MR05IJD3XD36VD9ahSx1e2w3i5x91Xh11.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MR05LTJEHWR7j6jEUT0a9Wqq0TTqY336k",
                                    "name": "Set Variables",
                                    "title": "Add to list of blocked items",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Add to list of blocked items",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZYNQM8PQV6D1euPHqNdy7PtWOJX63fn$",
                                          "variable_value_new": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZYNQM8PQV6D1euPHqNdy7PtWOJX63fn$ \\n $activity.definition_activity_01MR04XJA44VQ0LPVNlUjWh8pNKP9hZaGX6.input.source_array[@].ip_address$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01MR05TBUWPHA2KKGKTqeRKfKa9uYSK1MJQ",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MR05IJD3XD36VD9ahSx1e2w3i5x91Xh11.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MR0750XZOE65yPHCWjKNHjH5ZuwdWnFzk",
                                    "name": "Set Variables",
                                    "title": "Add to list of not blocked items",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Add to list of not blocked items",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$",
                                          "variable_value_new": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$ \\n $activity.definition_activity_01MR04XJA44VQ0LPVNlUjWh8pNKP9hZaGX6.input.source_array[@].ip_address$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01MRPCZISIVMC47ZbJysBdYHX2tlJrjUmsS",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01MR04BKCLB967OScA93AuK5F1eevPShZOf.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01MRPDF3NF9NK3KrPZmQqDSBcvsMGmspjJj",
                        "name": "Set Variables",
                        "title": "Add to list of not blocked items",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Add to list of not blocked items",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$",
                              "variable_value_new": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$ \\n $activity.definition_activity_01MQZHRKE8MZ87CIn06ey5GWMNLyWdfn8Pa.output.row_count$ IP addresses were not blocked because a destination list for IPs was not provided or the list provided was not found in Umbrella"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01MR0DWVE1JKC4rr8qhhgUtMg6BFv0oJzmH",
            "name": "Group",
            "title": "Process domains",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Process domains",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01MR0DX7ZRLFL4NtqulqzRi0X3XIqRLTwSJ",
                "name": "JSONPath Query",
                "title": "Extract destination list ID",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Extract destination list ID",
                  "input_json": "$activity.definition_activity_01MR025DUS0B65SuReb8W9NT2FhRb3xt8pQ.output.variable_workflow_01PP76E2I5AGW6ER9Z87Zvcb4O1pjn9Wcwc$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.data[?(@.name=='$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01J7V0QBDDQUY5ubyzX1v7l4wtZWEJiy6f4$')].id",
                      "jsonpath_query_name": "domain_destination_list_id",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01MR0DXJOXBSZ6Ft33dgkbaW17SFCW6HzpY",
                "name": "Condition Block",
                "title": "Was the destination list found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was the destination list found?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01MR0DXV94QGV3mQKGcW185H6AhlSENhrcO",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01MR0DX7ZRLFL4NtqulqzRi0X3XIqRLTwSJ.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01MR0DXW0H2HQ0pmTOQJItu3m7MQDKQqPb6",
                        "name": "For Each",
                        "title": "For each domain",
                        "type": "logic.for_each",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "For each domain",
                          "skip_execution": false,
                          "source_array": "$activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.read_table_from_json$"
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MR0DY8HY0HS2KIRbrFZYkGzLjOR4vSJCs",
                            "name": "Umbrella - Management - Add Record to Destination List",
                            "title": "Umbrella - Management - Add Record to Destination List",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Umbrella - Management - Add Record to Destination List",
                              "input": {
                                "variable_workflow_01PR38PRA8DAV0ueGoV9r6wwpoD7SSF757y": "",
                                "variable_workflow_01PR38PRA8HGK1pzCqHFCWKILh6nWkPrpC0": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJX43X1JT2D7UvhC00eidKJZKhIwCCrVc$",
                                "variable_workflow_01PR38PRA8ISH0QK4PJTeo7pPubN1Ft8vi7": "$activity.definition_activity_01MR0DX7ZRLFL4NtqulqzRi0X3XIqRLTwSJ.output.jsonpath_queries.domain_destination_list_id$",
                                "variable_workflow_01PR38PRA8JXW531nZH86NP15pwRBtmRMOT": "$activity.definition_activity_01MR0DXW0H2HQ0pmTOQJItu3m7MQDKQqPb6.input.source_array[@].domain$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Umbrella Management"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PR38PRIL1R04x7je59e5UtYqDQ0B1NHet"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MR0DZ8KQIG42ubLSkrenXmAgDbtLZaVvu",
                            "name": "Condition Block",
                            "title": "Was the record added successfully?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Was the record added successfully?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01MR0DZKCNDRS5ABqehZgJS19z4F8WSkmls",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MR0DY8HY0HS2KIRbrFZYkGzLjOR4vSJCs.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MR0DZLCHGEP2tBgL9eSMLrkxgIJeT8Oaj",
                                    "name": "Set Variables",
                                    "title": "Add to list of blocked items",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Add to list of blocked items",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZYNQM8PQV6D1euPHqNdy7PtWOJX63fn$",
                                          "variable_value_new": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZYNQM8PQV6D1euPHqNdy7PtWOJX63fn$ \\n $activity.definition_activity_01MR0DXW0H2HQ0pmTOQJItu3m7MQDKQqPb6.input.source_array[@].domain$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01MR0DZX0UZ9K3uHVOd7RJgKQI5BFP9TYZh",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MR0DY8HY0HS2KIRbrFZYkGzLjOR4vSJCs.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MR0DZYDSUDJ1Z6xV87WyedB5cVkcBsYP5",
                                    "name": "Set Variables",
                                    "title": "Add to list of not blocked items",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Add to list of not blocked items",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$",
                                          "variable_value_new": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$ \\n $activity.definition_activity_01MR0DXW0H2HQ0pmTOQJItu3m7MQDKQqPb6.input.source_array[@].domain$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01MRPE3YU5G2X7g00DzmqpKTbOFr5CPlf1w",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01MR0DX7ZRLFL4NtqulqzRi0X3XIqRLTwSJ.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01MRPE97PLMS55jPtPaVdKuNklC3ByWahNQ",
                        "name": "Set Variables",
                        "title": "Add to list of not blocked items",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Add to list of not blocked items",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$",
                              "variable_value_new": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$ \\n $activity.definition_activity_01MQZI2HADLMZ1ovs0mmsH0NfiLa4qIO4Vd.output.row_count$ domains were not blocked because a destination list for domains was not provided or the list provided was not found in Umbrella"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01MKVC6AIAFO30pIa829bqJrQB8VSt35Hjy",
        "name": "Condition Block",
        "title": "Was a Webex Teams room provided?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Was a Webex Teams room provided?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01MKVC778Q1GH5xgUV5rFspLeK9jfi6h6Vj",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JPY92AW0OGU232MCmMNQVtPzApkLAZfO6$",
                "operator": "ne",
                "right_operand": ""
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01MKVD39WIMY32XvD2ZqO7fPxibwlEDQQTj",
                "name": "Webex Teams - Search for Room",
                "title": "Webex Teams - Search for Room",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Webex Teams - Search for Room",
                  "input": {
                    "variable_workflow_01PP790MCX1DN3EitpQebkUyJS65DbwS3nU": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JPZ68MN93582l1vD0kPf2soZ6WSFKBQHV$",
                    "variable_workflow_01PP790MCXB392D3R8pxh9fgOTjTde2bcMW": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JPY92AW0OGU232MCmMNQVtPzApkLAZfO6$",
                    "variable_workflow_01PP790MCXHP55YE6ylOEITWsWbUFJeyWGv": "",
                    "variable_workflow_01PP790MCXM9W1MUwo85y8iNRCoQuQ4RGNa": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "Webex Teams"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01MKVEQWN45LO1MyoOq6EnfM8UJHv0gmpKu",
                "name": "Condition Block",
                "title": "Did we find the room?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Did we find the room?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01MKVES35YBB57gEFqS0hcMt4x4Cee4vPXW",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01MKVD39WIMY32XvD2ZqO7fPxibwlEDQQTj.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01JPY4TB71SY72qjU66dlh9wkKj3k7l0Br7",
                        "name": "Webex Teams - Post Message to Room",
                        "title": "Webex Teams - Post Message to Room",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Webex Teams - Post Message to Room",
                          "input": {
                            "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01MKVD39WIMY32XvD2ZqO7fPxibwlEDQQTj.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
                            "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JPZ68MN93582l1vD0kPf2soZ6WSFKBQHV$",
                            "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "Secure Network Analytics alerts were processed for the period $activity.definition_activity_01MD5BMMPI2Q47aFHBBE45Hu8JW2AhqB7wa.output.result$ through $activity.definition_activity_01MDUYVP4YL9X0sHOwkgM06vlNCOSOEZoJ9.output.result$. Alerts were found matching a name of \"$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JJWOS0O6PFJ2BxAAuVVrfIRfpYbD27i3W$\" with a status of \"$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01JPWL2ZYZRFE4Mos4qbH8VCZgCyT3E1k6l$\".\n\nThe following items were blocked in Umbrella:\n```$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZYNQM8PQV6D1euPHqNdy7PtWOJX63fn$\n```\n\nThe following items were **not** blocked in Umbrella:\n```$workflow.definition_workflow_01J72R7Z249ZJ1XEtWCLhQJx44IKOv2c5iF.local.variable_workflow_01MQZZ2Y6N5IX5jVzW1l6b8S5oDz9oVRxVB$\n```",
                            "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": ""
                          },
                          "runtime_user": {
                            "override_target_runtime_user": false,
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "mw",
                                    "right_operand": "Webex Teams"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_01KB985T807PN72HWdrDjvYCedj6wNtjbF6"
    ]
  },
  "categories": {
    "category_01KB985T807PN72HWdrDjvYCedj6wNtjbF6": {
      "unique_name": "category_01KB985T807PN72HWdrDjvYCedj6wNtjbF6",
      "name": "Secure Cloud Analytics",
      "title": "Secure Cloud Analytics",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01PR38PRIL1R04x7je59e5UtYqDQ0B1NHet",
    "definition_workflow_01PP767EUS6Q52H9Ww5DQjcJoxKwKBIMkdK",
    "definition_workflow_01PP75TXMT8S84vRSb0JXxLJKaVaRaJxIDr",
    "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
    "definition_workflow_01PP76E2PZZDF6jy3jVpYnYp5STVy3zReDB"
  ]
}