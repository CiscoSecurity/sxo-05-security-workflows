{
    "workflow": {
      "unique_name": "definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt",
      "name": "0019 - Meraki - MX - L3 Outbound Firewall Block",
      "title": "0019 - Meraki - MX - L3 Outbound Firewall Block",
      "type": "generic.workflow",
      "base_type": "workflow",
      "variables": [
        {
          "schema_id": "datatype.secure_string",
          "properties": {
            "value": "",
            "scope": "local",
            "name": "Meraki API Key",
            "type": "datatype.secure_string",
            "description": "Your Meraki API key. This can be generated in your Meraki dashboard",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01N8TZYS3UXYB6Id7fVa2f4xOjeHgJl2plk",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "",
            "scope": "input",
            "name": "observable_value",
            "type": "datatype.string",
            "description": "The value of the observable pivoted on",
            "is_required": true,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01N8TYN67OPH77kqFsZTKmJF2wKF25adMqi",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "",
            "scope": "input",
            "name": "observable_type",
            "type": "datatype.string",
            "description": "The type of observable pivoted on",
            "is_required": true,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01N8TYSM6J4K10CzAZDyqs4dClwVGlWgqwW",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "",
            "scope": "local",
            "name": "Network Names",
            "type": "datatype.string",
            "description": "A comma-separated list of network names to alter firewall rules for. If this is blank, all networks in a given organization will have their firewall rules modified. Note that network name matching is case sensitive",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01N8UD1SUI9TM1JXxwB7jc8UIeTn2prk9ql",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "",
            "scope": "local",
            "name": "Organization Names",
            "type": "datatype.string",
            "description": "A comma-separated list of organization names to alter firewall rules for. If this is blank, all organizations will have their firewall rules modified (for networks matching the \"Network Name\" local variable). Note that organization name matching is case sensitive",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_0214Y4BRY8SNJ1SPYhEr3MOL0cY3WEdeNow",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "",
            "scope": "local",
            "name": "Errors",
            "type": "datatype.string",
            "description": "Placeholder for any errors that may occur during workflow execution",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_0214YRBSQV3836FO7hqsg99MkxP7y0MRkug",
          "object_type": "variable_workflow"
        }
      ],
      "properties": {
        "atomic": {
          "is_atomic": false
        },
        "delete_workflow_instance": false,
        "description": "This workflow blocks the given IP address on a Cisco Meraki MX L3 outbound firewall (using the input observable as the rule's destination). Supported observable: ip\n\nDocumentation: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0019\n\nTarget Group: Default TargetGroup\n\nTargets: Cisco Meraki\n\nSteps:\n[] Make sure the observable type provided is supported\n[] Get the Meraki API key from a global variable (optional)\n[] Loop through each organization\n[]> Check the organization is in scope\n[]> Loop through each network\n[]>> Check the network is in scope\n[]>> Get the existing L3 firewall rules\n[]>> Add the new L3 firewall rule\n[]>> Update the firewall rules",
        "display_name": "0019 - Meraki - MX - L3 Outbound Firewall Block",
        "runtime_user": {
          "override_target_runtime_user": false,
          "specify_on_workflow_start": false,
          "target_default": true
        },
        "target": {
          "execute_on_target_group": true,
          "target_group": {
            "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
            "run_on_all_targets": false,
            "selected_target_types": [
              "web-service.endpoint"
            ],
            "use_criteria": {
              "choose_target_using_algorithm": "choose_first_with_matching_criteria",
              "conditions": [
                {
                  "operator": "eqi",
                  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                  "right_operand": "Cisco Meraki"
                }
              ]
            }
          }
        }
      },
      "object_type": "definition_workflow",
      "actions": [
        {
          "unique_name": "definition_activity_01N8U2EPWJO9S7VezVebfgvDR1TYHGJxExx",
          "name": "Condition Block",
          "title": "Is the observable type supported?",
          "type": "logic.if_else",
          "base_type": "activity",
          "properties": {
            "continue_on_failure": false,
            "display_name": "Is the observable type supported?",
            "skip_execution": false
          },
          "object_type": "definition_activity",
          "blocks": [
            {
              "unique_name": "definition_activity_01N8U2FGTWBCA54bW2QrmZkB6vIemsCB2NX",
              "name": "Condition Branch",
              "title": "No",
              "type": "logic.condition_block",
              "base_type": "activity",
              "properties": {
                "condition": {
                  "left_operand": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.input.variable_workflow_01N8TYSM6J4K10CzAZDyqs4dClwVGlWgqwW$",
                  "operator": "ne",
                  "right_operand": "ip"
                },
                "continue_on_failure": false,
                "display_name": "No",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01N8U311GXEED38UrU3PBxoZe5J4S2rVY54",
                  "name": "Completed",
                  "title": "Unsupported observable",
                  "type": "logic.completed",
                  "base_type": "activity",
                  "properties": {
                    "completion_type": "failed-completed",
                    "continue_on_failure": false,
                    "display_name": "Unsupported observable",
                    "result_message": "The observable type \"$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.input.variable_workflow_01N8TYSM6J4K10CzAZDyqs4dClwVGlWgqwW$\" is not supported by this workflow",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity"
                }
              ]
            }
          ]
        },
        {
          "unique_name": "definition_activity_01N8TZG7UN36K5SMmBPqs4gRSDcMitq95U7",
          "name": "Group",
          "title": "Fetch global variables",
          "type": "logic.group",
          "base_type": "activity",
          "properties": {
            "continue_on_failure": false,
            "display_name": "Fetch global variables",
            "skip_execution": true
          },
          "object_type": "definition_activity",
          "actions": [
            {
              "unique_name": "definition_activity_01N8TZJNW8Z9U4cJZiSTB6dTD7XuSuuPWL2",
              "name": "Set Variables",
              "title": "Fetch global variables",
              "type": "core.set_multiple_variables",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Fetch global variables",
                "skip_execution": false,
                "variables_to_update": [
                  {
                    "variable_to_update": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_01N8TZYS3UXYB6Id7fVa2f4xOjeHgJl2plk$",
                    "variable_value_new": ""
                  }
                ]
              },
              "object_type": "definition_activity"
            }
          ]
        },
        {
          "unique_name": "definition_activity_01NIUZ8QK9XMH0QC0qnsHlVAwKjwChutFpj",
          "name": "Group",
          "title": "Get organizations and networks",
          "type": "logic.group",
          "base_type": "activity",
          "properties": {
            "continue_on_failure": false,
            "display_name": "Get organizations and networks",
            "skip_execution": false
          },
          "object_type": "definition_activity",
          "actions": [
            {
              "unique_name": "definition_activity_01NIUYXPKCERN79mhcDnjpvuGYiH1fynQwg",
              "name": "Meraki - Get Organizations",
              "title": "Meraki - Get Organizations",
              "type": "workflow.atomic_workflow",
              "base_type": "subworkflow",
              "properties": {
                "continue_on_failure": true,
                "display_name": "Meraki - Get Organizations",
                "input": {
                  "variable_workflow_01PP75VKCNBIR74HoD8U7ycWq28NINXEGi5": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_01N8TZYS3UXYB6Id7fVa2f4xOjeHgJl2plk$"
                },
                "runtime_user": {
                  "target_default": true
                },
                "skip_execution": false,
                "target": {
                  "use_workflow_target_group": true
                },
                "workflow_id": "definition_workflow_01PP75VKKHI0M7L1KhzORCEGNLR0y54Vaz8",
                "workflow_name": "Meraki - Get Organizations"
              },
              "object_type": "definition_activity"
            },
            {
              "unique_name": "definition_activity_0214YQ6U1FUII1qQiXLdB4jNzsPh8Jdg4pS",
              "name": "Condition Block",
              "title": "Did we get an organization list?",
              "type": "logic.if_else",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Did we get an organization list?",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "blocks": [
                {
                  "unique_name": "definition_activity_0214YQ6UPQUG67Z92pf7GouK1nnnQAOpKJX",
                  "name": "Condition Branch",
                  "title": "No",
                  "type": "logic.condition_block",
                  "base_type": "activity",
                  "properties": {
                    "condition": {
                      "left_operand": "$activity.definition_activity_01NIUYXPKCERN79mhcDnjpvuGYiH1fynQwg.output.succeeded$",
                      "operator": "eq",
                      "right_operand": false
                    },
                    "continue_on_failure": false,
                    "display_name": "No",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "actions": [
                    {
                      "unique_name": "definition_activity_0214YQ8MAGRYU3M1TALcjVVrx2ikNsQ109C",
                      "name": "Completed",
                      "title": "Failed",
                      "type": "logic.completed",
                      "base_type": "activity",
                      "properties": {
                        "completion_type": "failed-completed",
                        "continue_on_failure": false,
                        "display_name": "Failed",
                        "result_message": "Failed to fetch list of organizations from Meraki",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity"
                    }
                  ]
                }
              ]
            },
            {
              "unique_name": "definition_activity_0214XOM16EVIW7QzBLUe5gdDSdJupsIlo4M",
              "name": "Read Table from JSON",
              "title": "Convert Organizations to Table",
              "type": "corejava.read_table_from_json",
              "base_type": "activity",
              "properties": {
                "action_timeout": 180,
                "continue_on_failure": false,
                "display_name": "Convert Organizations to Table",
                "input_json": "$activity.definition_activity_01NIUYXPKCERN79mhcDnjpvuGYiH1fynQwg.output.variable_workflow_01PP75VKCNFWC0Y3NckXoox5CRNcfdLVBNT$",
                "jsonpath_query": "$.",
                "persist_output": false,
                "populate_columns": false,
                "skip_execution": false,
                "table_columns": [
                  {
                    "column_name": "id",
                    "column_type": "string"
                  },
                  {
                    "column_name": "name",
                    "column_type": "string"
                  }
                ]
              },
              "object_type": "definition_activity"
            },
            {
              "unique_name": "definition_activity_0214XOYQU7H9I5fYdsvZNiJKZ5VD7JIflZf",
              "name": "For Each",
              "title": "For Each Organization",
              "type": "logic.for_each",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "For Each Organization",
                "skip_execution": false,
                "source_array": "$activity.definition_activity_0214XOM16EVIW7QzBLUe5gdDSdJupsIlo4M.output.read_table_from_json$"
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_0219C05MSLB5E0XAq4T4DKXImf1Ot9NCh85",
                  "name": "Execute Python Script",
                  "title": "Is the organization in scope?",
                  "type": "python3.script",
                  "base_type": "activity",
                  "properties": {
                    "action_timeout": 180,
                    "continue_on_failure": false,
                    "display_name": "Is the organization in scope?",
                    "script": "import sys\n\norganizations = sys.argv[1]\nthisOrganization = sys.argv[2]\n\ninScope = False\n\nif len(organizations) == 0:\n  inScope = True\nelse:\n  organizations = organizations.split(',')\n\n  for organization in organizations:\n    if organization == thisOrganization:\n      inScope = True\n      break",
                    "script_arguments": [
                      "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_0214Y4BRY8SNJ1SPYhEr3MOL0cY3WEdeNow$",
                      "$activity.definition_activity_0214XOYQU7H9I5fYdsvZNiJKZ5VD7JIflZf.input.source_array[@].name$"
                    ],
                    "script_queries": [
                      {
                        "script_query": "inScope",
                        "script_query_name": "inScope",
                        "script_query_type": "boolean"
                      }
                    ],
                    "skip_execution": false
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_0214Y3TKMEJ0V5wdDVOvJRyv5tEi27O3Cou",
                  "name": "Condition Block",
                  "title": "Check Organization Name",
                  "type": "logic.if_else",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Check Organization Name",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "blocks": [
                    {
                      "unique_name": "definition_activity_0214Y3TKY7A3W71oHyDRwsE1XGOvKfIeCeE",
                      "name": "Condition Branch",
                      "title": "Matched or Blank",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                        "condition": {
                          "left_operand": "$activity.definition_activity_0219C05MSLB5E0XAq4T4DKXImf1Ot9NCh85.output.script_queries.inScope$",
                          "operator": "eq",
                          "right_operand": true
                        },
                        "continue_on_failure": false,
                        "display_name": "Matched or Blank",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01NIUZ1IQQMRL0TVEOUnJhQu0wi8wlTWWuI",
                          "name": "Meraki - Get Networks by Organization",
                          "title": "Meraki - Get Networks by Organization",
                          "type": "workflow.atomic_workflow",
                          "base_type": "subworkflow",
                          "properties": {
                            "continue_on_failure": true,
                            "display_name": "Meraki - Get Networks by Organization",
                            "input": {
                              "variable_workflow_01PP77O6RVSLT5JjQwacuzlTNQIO59JloTY": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_01N8TZYS3UXYB6Id7fVa2f4xOjeHgJl2plk$",
                              "variable_workflow_01PP77O6RVTZZ1KbG6HsO2BKhfZu9RvOpL4": "$activity.definition_activity_0214XOYQU7H9I5fYdsvZNiJKZ5VD7JIflZf.input.source_array[@].id$"
                            },
                            "runtime_user": {
                              "target_default": true
                            },
                            "skip_execution": false,
                            "target": {
                              "use_workflow_target_group": true
                            },
                            "workflow_id": "definition_workflow_01PP77O6ZSWPP2qZ7F9djlfhYkp4gC6tOsj",
                            "workflow_name": "Meraki - Get Networks by Organization"
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_0214YQOYNREC62oOSmIYMB1uB3AnCfV0FH3",
                          "name": "Condition Block",
                          "title": "Did we get a network list?",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Did we get a network list?",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_0214YQOZBJA0958gTRGbnNXLJdxyQyIOAPx",
                              "name": "Condition Branch",
                              "title": "No",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01NIUZ1IQQMRL0TVEOUnJhQu0wi8wlTWWuI.output.succeeded$",
                                  "operator": "eq",
                                  "right_operand": false
                                },
                                "continue_on_failure": false,
                                "display_name": "No",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "actions": [
                                {
                                  "unique_name": "definition_activity_0214YRFAB0WHT5zZr8eyA1E2FsMJvxbw387",
                                  "name": "Set Variables",
                                  "title": "Update Error Variable",
                                  "type": "core.set_multiple_variables",
                                  "base_type": "activity",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Update Error Variable",
                                    "skip_execution": false,
                                    "variables_to_update": [
                                      {
                                        "variable_to_update": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_0214YRBSQV3836FO7hqsg99MkxP7y0MRkug$",
                                        "variable_value_new": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_0214YRBSQV3836FO7hqsg99MkxP7y0MRkug$\nFailed to fetch networks for organization \"$activity.definition_activity_0214XOYQU7H9I5fYdsvZNiJKZ5VD7JIflZf.input.source_array[@].id$\" ($activity.definition_activity_0214XOYQU7H9I5fYdsvZNiJKZ5VD7JIflZf.input.source_array[@].name$)"
                                      }
                                    ]
                                  },
                                  "object_type": "definition_activity"
                                },
                                {
                                  "unique_name": "definition_activity_0214YRH5IQF327e4c5Vy9nDbGOumlRv6kpD",
                                  "name": "Continue",
                                  "title": "Continue",
                                  "type": "logic.continue",
                                  "base_type": "activity",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Continue",
                                    "skip_execution": false
                                  },
                                  "object_type": "definition_activity"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "unique_name": "definition_activity_0214XPU99TR8Z0VZ68k3Z9g0GaDLVqQry2t",
                          "name": "Read Table from JSON",
                          "title": "Convert Networks to Table",
                          "type": "corejava.read_table_from_json",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": false,
                            "display_name": "Convert Networks to Table",
                            "input_json": "$activity.definition_activity_01NIUZ1IQQMRL0TVEOUnJhQu0wi8wlTWWuI.output.variable_workflow_01PP77O6RVOER4BwNbBQLRypxfTWlKubeaJ$",
                            "jsonpath_query": "$.",
                            "persist_output": false,
                            "populate_columns": false,
                            "skip_execution": false,
                            "table_columns": [
                              {
                                "column_name": "id",
                                "column_type": "string"
                              },
                              {
                                "column_name": "name",
                                "column_type": "string"
                              },
                              {
                                "column_name": "productTypes",
                                "column_type": "string"
                              }
                            ]
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_0214XPTIPFLNM3SC8G8x1SHkHO4ZRgZoRzs",
                          "name": "For Each",
                          "title": "For Each Network",
                          "type": "logic.for_each",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "For Each Network",
                            "skip_execution": false,
                            "source_array": "$activity.definition_activity_0214XPU99TR8Z0VZ68k3Z9g0GaDLVqQry2t.output.read_table_from_json$"
                          },
                          "object_type": "definition_activity",
                          "actions": [
                            {
                              "unique_name": "definition_activity_0219C37GYDZ7Y73MnLxv0GYfQSpXyoAxkdW",
                              "name": "Execute Python Script",
                              "title": "Is the network in scope?",
                              "type": "python3.script",
                              "base_type": "activity",
                              "properties": {
                                "action_timeout": 180,
                                "continue_on_failure": false,
                                "display_name": "Is the network in scope?",
                                "script": "import sys, json\n\nnetworks = sys.argv[1]\nthisNetwork = sys.argv[2]\nproducts = json.loads(sys.argv[3])\n\ninScope = False\n\nif 'appliance' in products:\n  if len(networks) == 0:\n    inScope = True\n  else:\n    networks = networks.split(',')\n\n    for network in networks:\n      if network == thisNetwork:\n        inScope = True\n        break",
                                "script_arguments": [
                                  "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_01N8UD1SUI9TM1JXxwB7jc8UIeTn2prk9ql$",
                                  "$activity.definition_activity_0214XPTIPFLNM3SC8G8x1SHkHO4ZRgZoRzs.input.source_array[@].name$",
                                  "$activity.definition_activity_0214XPTIPFLNM3SC8G8x1SHkHO4ZRgZoRzs.input.source_array[@].productTypes$"
                                ],
                                "script_queries": [
                                  {
                                    "script_query": "inScope",
                                    "script_query_name": "inScope",
                                    "script_query_type": "boolean"
                                  }
                                ],
                                "skip_execution": false
                              },
                              "object_type": "definition_activity"
                            },
                            {
                              "unique_name": "definition_activity_0214Y4PG38IXC2clXbaICGLl68FQtM5uhYq",
                              "name": "Condition Block",
                              "title": "Check If Network is In Scope",
                              "type": "logic.if_else",
                              "base_type": "activity",
                              "properties": {
                                "continue_on_failure": false,
                                "display_name": "Check If Network is In Scope",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "blocks": [
                                {
                                  "unique_name": "definition_activity_0214Y4PGEZ3KR4FmU5Hmr1OE1S9zii2BzCS",
                                  "name": "Condition Branch",
                                  "title": "Matched or Blank",
                                  "type": "logic.condition_block",
                                  "base_type": "activity",
                                  "properties": {
                                    "condition": {
                                      "left_operand": "$activity.definition_activity_0219C37GYDZ7Y73MnLxv0GYfQSpXyoAxkdW.output.script_queries.inScope$",
                                      "operator": "eq",
                                      "right_operand": true
                                    },
                                    "continue_on_failure": false,
                                    "display_name": "Matched or Blank",
                                    "skip_execution": false
                                  },
                                  "object_type": "definition_activity",
                                  "actions": [
                                    {
                                      "unique_name": "definition_activity_01N8TXZWKFTLC6Uxhb4XUdp3IMTGe5XLj6y",
                                      "name": "Meraki - Network - MX - Get L3 Outbound Firewall Rules",
                                      "title": "Meraki - Network - MX - Get L3 Outbound Firewall Rules",
                                      "type": "workflow.atomic_workflow",
                                      "base_type": "subworkflow",
                                      "properties": {
                                        "continue_on_failure": false,
                                        "display_name": "Meraki - Network - MX - Get L3 Outbound Firewall Rules",
                                        "input": {
                                          "variable_workflow_01PP78X6RXZOL2zyCifrgrspJ6El1R7HIBM": "$activity.definition_activity_0214XPTIPFLNM3SC8G8x1SHkHO4ZRgZoRzs.input.source_array[@].id$",
                                          "variable_workflow_01PP78X6RY2WZ5Ch3V2Ew55C2NzYlKtQq07": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_01N8TZYS3UXYB6Id7fVa2f4xOjeHgJl2plk$"
                                        },
                                        "runtime_user": {
                                          "target_default": true
                                        },
                                        "skip_execution": false,
                                        "target": {
                                          "use_workflow_target_group": true
                                        },
                                        "workflow_id": "definition_workflow_01PP78X6Z62P94QhzA05iog6dqFsGVo4XnR",
                                        "workflow_name": "Meraki - Network - MX - Get L3 Outbound Firewall Rules"
                                      },
                                      "object_type": "definition_activity"
                                    },
                                    {
                                      "unique_name": "definition_activity_01NIU575NH6Y52G3LtYLromDgc07INZoUg4",
                                      "name": "Execute Python Script",
                                      "title": "Insert new firewall rule",
                                      "type": "python3.script",
                                      "base_type": "activity",
                                      "properties": {
                                        "action_timeout": 180,
                                        "continue_on_failure": false,
                                        "display_name": "Insert new firewall rule",
                                        "script": "import sys,json\n\nexistingRules= sys.argv[1]\ndestination= sys.argv[2]\n\nexistingRules = json.loads(existingRules)\n\nnewRule = {\n  \"comment\": \"SecureX Orchestration ($workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.output.instance_id$)\",\n  \"destCidr\": destination,\n  \"destPort\": \"any\",\n  \"policy\": \"deny\",\n  \"protocol\": \"any\",\n  \"srcCidr\": \"any\",\n  \"srcPort\": \"any\",\n  \"syslogEnabled\": False\n}\n\nexistingRules.insert(0, newRule)\n\nnewRules = json.dumps(existingRules)",
                                        "script_arguments": [
                                          "$activity.definition_activity_01N8TXZWKFTLC6Uxhb4XUdp3IMTGe5XLj6y.output.variable_workflow_01PP78X6RY4765K9xTmEWHSMhkE1T7NegLv$",
                                          "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.input.variable_workflow_01N8TYN67OPH77kqFsZTKmJF2wKF25adMqi$"
                                        ],
                                        "script_queries": [
                                          {
                                            "script_query": "newRules",
                                            "script_query_name": "newRules",
                                            "script_query_type": "string"
                                          }
                                        ],
                                        "skip_execution": false
                                      },
                                      "object_type": "definition_activity"
                                    },
                                    {
                                      "unique_name": "definition_activity_01NIU78BKOY0J7cBXwqUgXbIIrgXNjMdtTx",
                                      "name": "Meraki - Network - MX - Update L3 Outbound Firewall Rules",
                                      "title": "Meraki - Network - MX - Update L3 Outbound Firewall Rules",
                                      "type": "workflow.atomic_workflow",
                                      "base_type": "subworkflow",
                                      "properties": {
                                        "continue_on_failure": true,
                                        "display_name": "Meraki - Network - MX - Update L3 Outbound Firewall Rules",
                                        "input": {
                                          "variable_workflow_01PP74UIZQOYS1ot2dLVIfQOkucce5AWXWO": "$activity.definition_activity_01NIU575NH6Y52G3LtYLromDgc07INZoUg4.output.script_queries.newRules$",
                                          "variable_workflow_01PP74UIZQTEY0LNNkoJN1rdkgRcgkbEt1Q": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_01N8TZYS3UXYB6Id7fVa2f4xOjeHgJl2plk$",
                                          "variable_workflow_01PP74UIZQUV26gxaqSOFbe28YkUS5Uwomt": "$activity.definition_activity_0214XPTIPFLNM3SC8G8x1SHkHO4ZRgZoRzs.input.source_array[@].id$"
                                        },
                                        "runtime_user": {
                                          "target_default": true
                                        },
                                        "skip_execution": false,
                                        "target": {
                                          "use_workflow_target_group": true
                                        },
                                        "workflow_id": "definition_workflow_01PP74UJ76SS13pAJukA3R2XP7nxxnIHLZZ",
                                        "workflow_name": "Meraki - Network - MX - Update L3 Outbound Firewall Rules"
                                      },
                                      "object_type": "definition_activity"
                                    },
                                    {
                                      "unique_name": "definition_activity_0214YS9KE6VP66fVnxbMB5hIJawTveVizh5",
                                      "name": "Condition Block",
                                      "title": "Was the update successful?",
                                      "type": "logic.if_else",
                                      "base_type": "activity",
                                      "properties": {
                                        "continue_on_failure": false,
                                        "display_name": "Was the update successful?",
                                        "skip_execution": false
                                      },
                                      "object_type": "definition_activity",
                                      "blocks": [
                                        {
                                          "unique_name": "definition_activity_0214YS9KQ5NVN65vzWNq9dBAOwM4CZE4bSu",
                                          "name": "Condition Branch",
                                          "title": "No",
                                          "type": "logic.condition_block",
                                          "base_type": "activity",
                                          "properties": {
                                            "condition": {
                                              "left_operand": "$activity.definition_activity_01NIU78BKOY0J7cBXwqUgXbIIrgXNjMdtTx.output.succeeded$",
                                              "operator": "eq",
                                              "right_operand": false
                                            },
                                            "continue_on_failure": false,
                                            "display_name": "No",
                                            "skip_execution": false
                                          },
                                          "object_type": "definition_activity",
                                          "actions": [
                                            {
                                              "unique_name": "definition_activity_0214YSBT4II5019MCS23TC1uPmvsTWJR3vW",
                                              "name": "Set Variables",
                                              "title": "Update Error Variable",
                                              "type": "core.set_multiple_variables",
                                              "base_type": "activity",
                                              "properties": {
                                                "continue_on_failure": false,
                                                "display_name": "Update Error Variable",
                                                "skip_execution": false,
                                                "variables_to_update": [
                                                  {
                                                    "variable_to_update": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_0214YRBSQV3836FO7hqsg99MkxP7y0MRkug$",
                                                    "variable_value_new": "$workflow.definition_workflow_01N8TXL33W9E22A4yIbisj9tP8Us54bTTdt.local.variable_workflow_0214YRBSQV3836FO7hqsg99MkxP7y0MRkug$\nFailed to update firewall rules for network \"$activity.definition_activity_0214XPTIPFLNM3SC8G8x1SHkHO4ZRgZoRzs.input.source_array[@].id$\" ($activity.definition_activity_0214XPTIPFLNM3SC8G8x1SHkHO4ZRgZoRzs.input.source_array[@].name$) in organization \"$activity.definition_activity_0214XOYQU7H9I5fYdsvZNiJKZ5VD7JIflZf.input.source_array[@].id$\" ($activity.definition_activity_0214XOYQU7H9I5fYdsvZNiJKZ5VD7JIflZf.input.source_array[@].name$)"
                                                  }
                                                ]
                                              },
                                              "object_type": "definition_activity"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "categories": [
        "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
      ]
    },
    "categories": {
      "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
        "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
        "name": "response",
        "title": "response",
        "type": "basic.category",
        "base_type": "category",
        "category_type": "custom",
        "object_type": "category"
      }
    },
    "target_groups": {
      "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
        "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
        "name": "Default TargetGroup",
        "title": "Default TargetGroup",
        "type": "generic.target_group",
        "base_type": "target_group",
        "version": "1.0.0",
        "targets": [
          {
            "data_target_type": "web-service.endpoint",
            "view_target_type": "web-service.endpoint",
            "include_all_targets": true
          },
          {
            "data_target_type": "email.smtp_endpoint",
            "view_target_type": "email.smtp_endpoint",
            "include_all_targets": true
          }
        ],
        "object_type": "target_group"
      }
    },
    "atomic_workflows": [
      "definition_workflow_01PP77O6ZSWPP2qZ7F9djlfhYkp4gC6tOsj",
      "definition_workflow_01PP75VKKHI0M7L1KhzORCEGNLR0y54Vaz8",
      "definition_workflow_01PP78X6Z62P94QhzA05iog6dqFsGVo4XnR",
      "definition_workflow_01PP74UJ76SS13pAJukA3R2XP7nxxnIHLZZ"
    ],
    "dependent_workflows": [
      "definition_workflow_01PP75VKKHI0M7L1KhzORCEGNLR0y54Vaz8",
      "definition_workflow_01PP77O6ZSWPP2qZ7F9djlfhYkp4gC6tOsj",
      "definition_workflow_01PP78X6Z62P94QhzA05iog6dqFsGVo4XnR",
      "definition_workflow_01PP74UJ76SS13pAJukA3R2XP7nxxnIHLZZ"
    ]
  }