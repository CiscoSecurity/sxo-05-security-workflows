{
	"workflow": {
	  "unique_name": "definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N",
	  "name": "0050 - Palo Alto - Panorama - Request Threat Containment",
	  "title": "0050 - Palo Alto - Panorama - Request Threat Containment",
	  "type": "generic.workflow",
	  "base_type": "workflow",
	  "variables": [
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Source Address Group Name",
			"type": "datatype.string",
			"description": "Name of the address group to add the rule's source objects to",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32F9UJF5AENwdUFHNERIXXb9sTko2",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.secure_string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "API Key",
			"type": "datatype.secure_string",
			"description": "Your API key for the Panorama REST API. See: https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-panorama-api/get-started-with-the-pan-os-xml-api/get-your-api-key.html",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "observable_value",
			"type": "datatype.string",
			"description": "The value of the observable pivoted on",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32FA0Y04deR9uAkce2M8GtT3Pc6yY",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Destination Address Group Name",
			"type": "datatype.string",
			"description": "Name of the address group to add the rule's destination objects to",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32FADWI2gXEkEk4hpcVagKl5q4kt9",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Device Group Name",
			"type": "datatype.string",
			"description": "The name of the device group to get service groups for. This is only required when Location is set to device-group",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Security Policy Pre Rule Name",
			"type": "datatype.string",
			"description": "Name of the security policy pre rule to add objects to",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01SDX8U99EKHR74GRuJaEP8FgHmdoxntRkw",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Destination Address Object",
			"type": "datatype.string",
			"description": "Name to use for the destination address object. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32F8FY15Tvdh4RnkXtGTZf9nKJEzg",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "SXo",
			"scope": "local",
			"name": "Name Prefix",
			"type": "datatype.string",
			"description": "A prefix that will be added to the address objects created by this workflow",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32F88WM3yPZSrawk8Z2zsxnHC9jFZ",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Source Address Object",
			"type": "datatype.string",
			"description": "Name to use for the source address object. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32FA7KO7G1SfD1rkCmFS4SogVyEEq",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Service Group Name",
			"type": "datatype.string",
			"description": "Name of the service object group to add the rule's service objects to",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32F9N1G6VKZV2uE5UatB9IXUzXJfq",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "shared",
			"scope": "local",
			"name": "Location",
			"type": "datatype.string",
			"description": "The availability of the objects. Valid values include: shared, device-group. If you use device-group, you must provide a Device Group Name",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Service Name",
			"type": "datatype.string",
			"description": "Name to use for the service object. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32F7H0X5k64776dmp3pvptmYLETET",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "observable_type",
			"type": "datatype.string",
			"description": "The type of observable pivoted on",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01RHSZ32F986V1vFH2uUL6xa3Dd7AE5NTmD",
		  "object_type": "variable_workflow"
		}
	  ],
	  "properties": {
		"atomic": {
		  "is_atomic": false
		},
		"delete_workflow_instance": false,
		"description": "This workflow is designed to be triggered by ServiceNow in response to a new Firewall Rule Task. When triggered, it gets data from ServiceNow which is used to update rules in Palo Alto Panorama. If an address or service object for the given input is not found, new objects are created.\n\nNote: You may need to use a SecureX Orchestration Remote to communicate with Panorama if it's on-premise. See: https://cs.co/SXO_remote\n\nTarget Group: Default TargetGroup\n\nTargets: Palo Alto Panorama, ServiceNow\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0050",
		"display_name": "0050 - Palo Alto - Panorama - Request Threat Containment",
		"runtime_user": {
		  "target_default": true
		},
		"target": {
		  "execute_on_target_group": true,
		  "target_group": {
			"target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
			"run_on_all_targets": false,
			"selected_target_types": [
			  "web-service.endpoint"
			],
			"use_criteria": {
			  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
			  "conditions": [
				{
				  "operator": "eqi",
				  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
				  "right_operand": "Palo Alto Panorama"
				}
			  ]
			}
		  }
		}
	  },
	  "object_type": "definition_workflow",
	  "actions": [
		{
		  "unique_name": "definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi",
		  "name": "Execute Python Script",
		  "title": "Parse input data",
		  "type": "python3.script",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": false,
			"display_name": "Parse input data",
			"script": "import json\nimport sys\n#\ndef read_possible_range_value(value):\n    value = [part.strip() for part in value.split('-')]\n    return '-'.join(value)\n#\ndef define_address_type(ip):\n    return 'ip-range' if '-' in ip else 'ip-netmask'\n#\ndef read_protocol(protocol):\n    assert protocol in ('tcp', 'udp')\n    return protocol\n#\ndef read_action(action):\n    action_mapping = {'allow': 'allow', 'block': 'deny'}\n    return action_mapping[action.lower()]\n#\ninput_data = json.loads(sys.argv[1])\ndestination_address = None\ndestination_address_type = None\nsource_address = None\nsource_address_type = None\ndestination_service = None\nprotocol = None\npre_rule = None\naction = None\nsn_task_id = None\nerror = None\nerror_mapping = {\n    KeyError: 'Input Data Error. Not valid input JSON',\n    AttributeError: \"Input Data Error. Destination port (or range of ports) can't be empty\",\n    AssertionError: \"Input Data Error. The protocol has to be one of TCP or UDP\"\n}\ntry:\n    sn_task_id = input_data[\"ServiceNow Task ID\"]\n    destination_address = read_possible_range_value(input_data[\"Destination Host IP\"])\n    destination_address_type = define_address_type(destination_address)\n    source_address = read_possible_range_value(input_data[\"Source Host IP\"])\n    source_address_type = define_address_type(source_address)\n    destination_service = read_possible_range_value(input_data[\"Destination Port\"])\n    protocol = read_protocol(input_data[\"Protocol\"].lower())\n    action = read_action(input_data[\"Access Action\"])\nexcept tuple(error_mapping) as exception:\n    error = error_mapping[exception.__class__]",
			"script_arguments": [
			  "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.input.variable_workflow_01RHSZ32FA0Y04deR9uAkce2M8GtT3Pc6yY$"
			],
			"script_queries": [
			  {
				"script_query": "destination_address",
				"script_query_name": "Destination Address",
				"script_query_type": "string"
			  },
			  {
				"script_query": "source_address",
				"script_query_name": "Source Address",
				"script_query_type": "string"
			  },
			  {
				"script_query": "destination_service",
				"script_query_name": "Destination Service",
				"script_query_type": "string"
			  },
			  {
				"script_query": "protocol",
				"script_query_name": "Protocol",
				"script_query_type": "string"
			  },
			  {
				"script_query": "sn_task_id",
				"script_query_name": "ServiceNow Task ID",
				"script_query_type": "string"
			  },
			  {
				"script_query": "action",
				"script_query_name": "Action",
				"script_query_type": "string"
			  },
			  {
				"script_query": "error",
				"script_query_name": "Error",
				"script_query_type": "string"
			  },
			  {
				"script_query": "destination_address_type",
				"script_query_name": "Destination Address Type",
				"script_query_type": "string"
			  },
			  {
				"script_query": "source_address_type",
				"script_query_name": "Source Address Type",
				"script_query_type": "string"
			  }
			],
			"skip_execution": false
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01RHSZ3ANR1IP5tq9shvvkGTysEkQ1R8yQr",
		  "name": "Condition Block",
		  "title": "Was the input data valid?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was the input data valid?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01RHSZ3BC1F0T0DRYe8bviPYJeIrdKm8yPC",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Error$",
				  "operator": "ne",
				  "right_operand": "None"
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01RHSZ3CGIL8Q73A92J5PL1WiVwRjtBWaRS",
				  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
					"input": {
					  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
					  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request:\n$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Error$",
					  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"run_on_all_targets": false,
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "ServiceNow"
							}
						  ]
						}
					  }
					},
					"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01RHT0IHFMJZC4RAn3SLPQtvfyVSKe6iUpf",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "Failed to process Threat Containment Request:\n$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Error$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01SDXCH3AJPZS3dHFim8bFbF8D13A8BmSha",
		  "name": "Condition Block",
		  "title": "Were the required object names provided?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Were the required object names provided?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01SDXCH3N1X7S5FLXKb5jiWOyk4qzplVcoF",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": {
					"left_operand": {
					  "left_operand": {
						"left_operand": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FADWI2gXEkEk4hpcVagKl5q4kt9$",
						"operator": "eq",
						"right_operand": ""
					  },
					  "operator": "or",
					  "right_operand": {
						"left_operand": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9UJF5AENwdUFHNERIXXb9sTko2$",
						"operator": "eq",
						"right_operand": ""
					  }
					},
					"operator": "or",
					"right_operand": {
					  "left_operand": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9N1G6VKZV2uE5UatB9IXUzXJfq$",
					  "operator": "eq",
					  "right_operand": ""
					}
				  },
				  "operator": "or",
				  "right_operand": {
					"left_operand": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01SDX8U99EKHR74GRuJaEP8FgHmdoxntRkw$",
					"operator": "eq",
					"right_operand": ""
				  }
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01SDXEYKOR1SD0064oIP9zgU2eEEHy4mUJc",
				  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
					"input": {
					  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
					  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. One or more required object names was missing. Please verify the following variables are provided:\n- Destination Address Group Name\n- Source Address Group Name\n- Service Group Name\n- Security Policy Pre Rule Name",
					  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"run_on_all_targets": false,
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "ServiceNow"
							}
						  ]
						}
					  }
					},
					"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01SDXK32D4LTN1iIfl1VkeTcjGgzDKQomeD",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "SecureX orchestration failed to process the threat containment request. One or more required object names was missing. Please verify the following variables are provided:\n- Destination Address Group Name\n- Source Address Group Name\n- Service Group Name\n- Security Policy Pre Rule Name",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01RHSZ3GYTBQL2CjsmiUJR4glWeno6RStba",
		  "name": "Execute Python Script",
		  "title": "Create  JSON for table",
		  "type": "python3.script",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": false,
			"display_name": "Create  JSON for table",
			"script": "from sys import argv\nimport json\ntable = [\n    {\n        \"id\": \"SourceAddress\",\n        \"type\": argv[5],\n        \"value\": argv[1],\n        \"group\": argv[3]\n    },\n    {\n        \"id\": \"DestinationAddress\",\n        \"type\": argv[6],\n        \"value\": argv[2],\n        \"group\": argv[4]\n    }\n]\ntable = json.dumps(table)",
			"script_arguments": [
			  "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Source Address$",
			  "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Destination Address$",
			  "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9UJF5AENwdUFHNERIXXb9sTko2$",
			  "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FADWI2gXEkEk4hpcVagKl5q4kt9$",
			  "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Source Address Type$",
			  "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Destination Address Type$"
			],
			"script_queries": [
			  {
				"script_query": "table",
				"script_query_name": "Table",
				"script_query_type": "string"
			  }
			],
			"skip_execution": false
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01RHSZ3HQLZHE6rAKDs5pUDcTbt1c0tDmKS",
		  "name": "Read Table from JSON",
		  "title": "Read table from JSON",
		  "type": "corejava.read_table_from_json",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": false,
			"display_name": "Read table from JSON",
			"input_json": "$activity.definition_activity_01RHSZ3GYTBQL2CjsmiUJR4glWeno6RStba.output.script_queries.Table$",
			"jsonpath_query": "$.",
			"persist_output": false,
			"populate_columns": false,
			"skip_execution": false,
			"table_columns": [
			  {
				"column_name": "id",
				"column_type": "string"
			  },
			  {
				"column_name": "value",
				"column_type": "string"
			  },
			  {
				"column_name": "group",
				"column_type": "string"
			  },
			  {
				"column_name": "type",
				"column_type": "string"
			  }
			]
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG",
		  "name": "For Each",
		  "title": "For each address",
		  "type": "logic.for_each",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "For each address",
			"skip_execution": false,
			"source_array": "$activity.definition_activity_01RHSZ3HQLZHE6rAKDs5pUDcTbt1c0tDmKS.output.read_table_from_json$"
		  },
		  "object_type": "definition_activity",
		  "actions": [
			{
			  "unique_name": "definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN",
			  "name": "Palo Alto - Panorama - Search Address Object by Value",
			  "title": "Palo Alto - Panorama - Search Address Object by Value",
			  "type": "workflow.atomic_workflow",
			  "base_type": "subworkflow",
			  "properties": {
				"continue_on_failure": true,
				"display_name": "Palo Alto - Panorama - Search Address Object by Value",
				"input": {
				  "variable_workflow_01QQJ3ORB4TTJ3j3iwK0HjnEit3E4lAFjQh": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8$",
				  "variable_workflow_01QQJ6D2CD5JW7ldEaoy5fnpGTDq8LJIl5b": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy$",
				  "variable_workflow_01QQJ730X162E19IFiajCJampLGGo0ZaE4h": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx$",
				  "variable_workflow_01QQJ8548OJSE4eJAV87mzk5VeExR1rC68j": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].value$"
				},
				"runtime_user": {
				  "target_default": true
				},
				"skip_execution": false,
				"target": {
				  "use_workflow_target_group": true
				},
				"workflow_id": "definition_workflow_01QQJ2AU0DAS47HJHH5JuZ92pnPzGAMyQUf"
			  },
			  "object_type": "definition_activity"
			},
			{
			  "unique_name": "definition_activity_01ROI02T11SH667yCrn2RmvIPIm2vDkvWQx",
			  "name": "Condition Block",
			  "title": "Did the search fail?",
			  "type": "logic.if_else",
			  "base_type": "activity",
			  "properties": {
				"continue_on_failure": false,
				"display_name": "Did the search fail?",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "blocks": [
				{
				  "unique_name": "definition_activity_01ROI02TE7OER79vcudjsiLa14drgM8r692",
				  "name": "Condition Branch",
				  "title": "Yes",
				  "type": "logic.condition_block",
				  "base_type": "activity",
				  "properties": {
					"condition": {
					  "left_operand": "$activity.definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN.output.succeeded$",
					  "operator": "eq",
					  "right_operand": false
					},
					"continue_on_failure": false,
					"display_name": "Yes",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01RHT5M0OU77L4I7DiDWiC4OwMCh8izDPHI",
					  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
					  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
					  "type": "workflow.atomic_workflow",
					  "base_type": "subworkflow",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
						"input": {
						  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
						  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to search for address objects:\n$activity.definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN.output.error.message$",
						  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
						},
						"runtime_user": {
						  "target_default": true
						},
						"skip_execution": false,
						"target": {
						  "override_workflow_target_group_criteria": true,
						  "target_group": {
							"run_on_all_targets": false,
							"use_criteria": {
							  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
							  "conditions": [
								{
								  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
								  "operator": "eqi",
								  "right_operand": "ServiceNow"
								}
							  ]
							}
						  }
						},
						"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01ROI1D5KNB3K1KsYoNna0RY2YPBZW6LFND",
					  "name": "Completed",
					  "title": "Failed",
					  "type": "logic.completed",
					  "base_type": "activity",
					  "properties": {
						"completion_type": "failed-completed",
						"continue_on_failure": false,
						"display_name": "Failed",
						"result_message": "SecureX orchestration failed to process the threat containment request:\n$activity.definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN.output.error.message$",
						"skip_execution": false
					  },
					  "object_type": "definition_activity"
					}
				  ]
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01RHSZ3LDS6LT5EzQt6ECdv1ZRt4hJGaz4Z",
			  "name": "Condition Block",
			  "title": "Address Object Found?",
			  "type": "logic.if_else",
			  "base_type": "activity",
			  "properties": {
				"continue_on_failure": false,
				"display_name": "Address Object Found?",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "blocks": [
				{
				  "unique_name": "definition_activity_01RJF9AZKAQTD3OMVqjIvR46yTHPoMpHHw4",
				  "name": "Condition Branch",
				  "title": "Yes",
				  "type": "logic.condition_block",
				  "base_type": "activity",
				  "properties": {
					"condition": {
					  "left_operand": "$activity.definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN.output.variable_workflow_01QR8AJP967JD4PRplkAHusJHE7hX1EhPbV$",
					  "operator": "ne",
					  "right_operand": ""
					},
					"continue_on_failure": false,
					"display_name": "Yes",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01RIMV31JNK4I5oXDy8XvCvmOQxP656Pove",
					  "name": "Condition Block",
					  "title": "Object Destination Selection",
					  "type": "logic.if_else",
					  "base_type": "activity",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Object Destination Selection",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "blocks": [
						{
						  "unique_name": "definition_activity_01RIMV31QYFKM1OLKO7jH62XvPbzESt5tCD",
						  "name": "Condition Branch",
						  "title": "Source",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].id$",
							  "operator": "eqi",
							  "right_operand": "SourceAddress"
							},
							"continue_on_failure": false,
							"display_name": "Source",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01RINRPBIS5R15eyIJ7LWpGxWYSpqMsOgmj",
							  "name": "Set Variables",
							  "title": "Set address object name",
							  "type": "core.set_multiple_variables",
							  "base_type": "activity",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "Set address object name",
								"skip_execution": false,
								"variables_to_update": [
								  {
									"variable_to_update": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FA7KO7G1SfD1rkCmFS4SogVyEEq$",
									"variable_value_new": "$activity.definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN.output.variable_workflow_01QR8AJP967JD4PRplkAHusJHE7hX1EhPbV$"
								  }
								]
							  },
							  "object_type": "definition_activity"
							}
						  ]
						},
						{
						  "unique_name": "definition_activity_01RIMV31YM82J5XuyJfxmqDPNFhWpvWJuk3",
						  "name": "Condition Branch",
						  "title": "Destination",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].id$",
							  "operator": "eqi",
							  "right_operand": "DestinationAddress"
							},
							"continue_on_failure": false,
							"display_name": "Destination",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01RINRQK34Q890m4TveTPedac42zWVxh03l",
							  "name": "Set Variables",
							  "title": "Set address object name",
							  "type": "core.set_multiple_variables",
							  "base_type": "activity",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "Set address object name",
								"skip_execution": false,
								"variables_to_update": [
								  {
									"variable_to_update": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8FY15Tvdh4RnkXtGTZf9nKJEzg$",
									"variable_value_new": "$activity.definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN.output.variable_workflow_01QR8AJP967JD4PRplkAHusJHE7hX1EhPbV$"
								  }
								]
							  },
							  "object_type": "definition_activity"
							}
						  ]
						}
					  ]
					}
				  ]
				},
				{
				  "unique_name": "definition_activity_01RHSZ3M3W9294Hl9B10VTLanh3qEbWGx9K",
				  "name": "Condition Branch",
				  "title": "No",
				  "type": "logic.condition_block",
				  "base_type": "activity",
				  "properties": {
					"condition": {
					  "left_operand": "$activity.definition_activity_01RHSZ3KLFOWT66dWvMa91ycSN5QGqTehzN.output.variable_workflow_01QR8AJP967JD4PRplkAHusJHE7hX1EhPbV$",
					  "operator": "eq",
					  "right_operand": ""
					},
					"continue_on_failure": false,
					"display_name": "No",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01RHSZ3MXDH1E7VuMVRwmGTdQjalKoVNX0t",
					  "name": "Execute Python Script",
					  "title": "Create object names",
					  "type": "python3.script",
					  "base_type": "activity",
					  "properties": {
						"action_timeout": 180,
						"continue_on_failure": false,
						"display_name": "Create object names",
						"script": "from sys import argv\nfrom time import time\nobject_name = f'{argv[1]}-{argv[2]}Object-{int(time())}'[:63]",
						"script_arguments": [
						  "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F88WM3yPZSrawk8Z2zsxnHC9jFZ$",
						  "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].id$"
						],
						"script_queries": [
						  {
							"script_query": "object_name",
							"script_query_name": "Adress Object Name",
							"script_query_type": "string"
						  }
						],
						"skip_execution": false
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01RHSZ3OF291V0rjpBjctzooTjKNm18Cnlc",
					  "name": "Palo Alto - Panorama - Create Address Object",
					  "title": "Palo Alto - Panorama - Create Address Object",
					  "type": "workflow.atomic_workflow",
					  "base_type": "subworkflow",
					  "properties": {
						"continue_on_failure": true,
						"display_name": "Palo Alto - Panorama - Create Address Object",
						"input": {
						  "variable_workflow_01PV9FLWQOR11432sTk3DBOlEBnMhEtAvGR": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy$",
						  "variable_workflow_01PV9FLWQOSET23iwr0r3CksorFepGCrNbv": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8$",
						  "variable_workflow_01PV9FLWQOTLD2TLTPNcMq53rjqjLf4fxFv": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx$",
						  "variable_workflow_01PV9JRMU3WNX3r9x8rH6CMEVXNWPU0rbjt": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].type$",
						  "variable_workflow_01PV9K80OYC8T52l4kVd0xqRnClAMPZMaGS": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].value$",
						  "variable_workflow_01PV9LJ5MXCJE2koNt6iSROrJPCwxVywbac": "$activity.definition_activity_01RHSZ3MXDH1E7VuMVRwmGTdQjalKoVNX0t.output.script_queries.Adress Object Name$",
						  "variable_workflow_01PV9NW72DRO54OJsK9YTOORvkgEMijwghN": ""
						},
						"runtime_user": {
						  "target_default": true
						},
						"skip_execution": false,
						"target": {
						  "use_workflow_target_group": true
						},
						"workflow_id": "definition_workflow_01PV9FLWXZHNA1gKq6UBTXF0OtZq0fX3vOA"
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01RHT1KEVNTAY6q25jRjsXo65kdtNnGQRYm",
					  "name": "Condition Block",
					  "title": "Did object creation fail?",
					  "type": "logic.if_else",
					  "base_type": "activity",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Did object creation fail?",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "blocks": [
						{
						  "unique_name": "definition_activity_01RHT1KF7DTHZ4YeZk6Azcv8w9mP3raZuaP",
						  "name": "Condition Branch",
						  "title": "Yes",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$activity.definition_activity_01RHSZ3OF291V0rjpBjctzooTjKNm18Cnlc.output.succeeded$",
							  "operator": "eq",
							  "right_operand": false
							},
							"continue_on_failure": false,
							"display_name": "Yes",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01ROKVAHNCD9Y4afkxVLHJ2C30jBgQ68uPt",
							  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
							  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
							  "type": "workflow.atomic_workflow",
							  "base_type": "subworkflow",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
								"input": {
								  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
								  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to create the address object:\n$activity.definition_activity_01RHSZ3OF291V0rjpBjctzooTjKNm18Cnlc.output.error.message$",
								  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
								},
								"runtime_user": {
								  "target_default": true
								},
								"skip_execution": false,
								"target": {
								  "override_workflow_target_group_criteria": true,
								  "target_group": {
									"run_on_all_targets": false,
									"use_criteria": {
									  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
									  "conditions": [
										{
										  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
										  "operator": "eqi",
										  "right_operand": "ServiceNow"
										}
									  ]
									}
								  }
								},
								"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
							  },
							  "object_type": "definition_activity"
							},
							{
							  "unique_name": "definition_activity_01RHT6C27KFPW7INgzHWxSi2VCxzwmtCP4Q",
							  "name": "Completed",
							  "title": "Failed",
							  "type": "logic.completed",
							  "base_type": "activity",
							  "properties": {
								"completion_type": "failed-completed",
								"continue_on_failure": false,
								"display_name": "Failed",
								"result_message": "SecureX orchestration failed to process the threat containment request. Failed to create the address object:\n$activity.definition_activity_01RHSZ3OF291V0rjpBjctzooTjKNm18Cnlc.output.error.message$",
								"skip_execution": false
							  },
							  "object_type": "definition_activity"
							}
						  ]
						}
					  ]
					},
					{
					  "unique_name": "definition_activity_01RJF5Z18SKCQ7TVmOkWhETTOe10rHhqOXB",
					  "name": "Condition Block",
					  "title": "Object Destination Selection",
					  "type": "logic.if_else",
					  "base_type": "activity",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Object Destination Selection",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "blocks": [
						{
						  "unique_name": "definition_activity_01RJF5Z18T2YJ6OJ9zSCkxGRiilATUvvCV9",
						  "name": "Condition Branch",
						  "title": "Source",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].id$",
							  "operator": "eqi",
							  "right_operand": "SourceAddress"
							},
							"continue_on_failure": false,
							"display_name": "Source",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01RJF5Z18UZIT5naSkpKAjciVXtS79AvwZY",
							  "name": "Set Variables",
							  "title": "Set address object name",
							  "type": "core.set_multiple_variables",
							  "base_type": "activity",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "Set address object name",
								"skip_execution": false,
								"variables_to_update": [
								  {
									"variable_to_update": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FA7KO7G1SfD1rkCmFS4SogVyEEq$",
									"variable_value_new": "$activity.definition_activity_01RHSZ3MXDH1E7VuMVRwmGTdQjalKoVNX0t.output.script_queries.Adress Object Name$"
								  }
								]
							  },
							  "object_type": "definition_activity"
							}
						  ]
						},
						{
						  "unique_name": "definition_activity_01RJF5Z18Y9Q61r0dPrm4bLCp3evltkd3a7",
						  "name": "Condition Branch",
						  "title": "Destination",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].id$",
							  "operator": "eqi",
							  "right_operand": "DestinationAddress"
							},
							"continue_on_failure": false,
							"display_name": "Destination",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01RJF5Z18YSD07Mhs1AxdpURicQmLpBxbDP",
							  "name": "Set Variables",
							  "title": "Set address object name",
							  "type": "core.set_multiple_variables",
							  "base_type": "activity",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "Set address object name",
								"skip_execution": false,
								"variables_to_update": [
								  {
									"variable_to_update": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8FY15Tvdh4RnkXtGTZf9nKJEzg$",
									"variable_value_new": "$activity.definition_activity_01RHSZ3MXDH1E7VuMVRwmGTdQjalKoVNX0t.output.script_queries.Adress Object Name$"
								  }
								]
							  },
							  "object_type": "definition_activity"
							}
						  ]
						}
					  ]
					}
				  ]
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01RJFZVSMSKSP3LN2iTTDXhDjvI4oZqSBqh",
			  "name": "Execute Python Script",
			  "title": "Set temporary object name",
			  "type": "python3.script",
			  "base_type": "activity",
			  "properties": {
				"action_timeout": 180,
				"continue_on_failure": false,
				"display_name": "Set temporary object name",
				"script": "from sys import argv\n\nobj_name = None\nif argv[1] == \"SourceAddress\":\n    obj_name = argv[2]\nelse:\n    obj_name = argv[3]",
				"script_arguments": [
				  "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].id$",
				  "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FA7KO7G1SfD1rkCmFS4SogVyEEq$",
				  "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8FY15Tvdh4RnkXtGTZf9nKJEzg$"
				],
				"script_queries": [
				  {
					"script_query": "obj_name",
					"script_query_name": "Object Name",
					"script_query_type": "string"
				  }
				],
				"skip_execution": false
			  },
			  "object_type": "definition_activity"
			},
			{
			  "unique_name": "definition_activity_01RHSZ43CXZ3O6S8ayoh0cd30dIy9Qoaaxu",
			  "name": "Palo Alto - Panorama - Add Address Object to Address Group",
			  "title": "Palo Alto - Panorama - Add Address Object to Address Group",
			  "type": "workflow.atomic_workflow",
			  "base_type": "subworkflow",
			  "properties": {
				"continue_on_failure": true,
				"display_name": "Palo Alto - Panorama - Add Address Object to Address Group",
				"input": {
				  "variable_workflow_01PV9RDPDTENI51oOx5vBz5oy14bE3pwoAZ": "$activity.definition_activity_01RHSZ3IKJL790nuLVjqg5QiQwwwaVoYhkG.input.source_array[@].group$",
				  "variable_workflow_01PV9RDPDTG0P2BPK62JcE5D4NSHNU9HTto": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8$",
				  "variable_workflow_01PV9RDPDTH753VOpyRu9Dx937NwGWoQUZO": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx$",
				  "variable_workflow_01PV9RDPDTJOB3ptLHKXrm2lo6yZUUWhOAY": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy$",
				  "variable_workflow_01PV9RDPDTKUN1dwCAfKozKpduWMhJr8Szc": "$activity.definition_activity_01RJFZVSMSKSP3LN2iTTDXhDjvI4oZqSBqh.output.script_queries.Object Name$",
				  "variable_workflow_01QVLOWWRPASL7D5NwKoEw7vYg80HhNNwW1": ""
				},
				"runtime_user": {
				  "target_default": true
				},
				"skip_execution": false,
				"target": {
				  "use_workflow_target_group": true
				},
				"workflow_id": "definition_workflow_01PV9RDPLW6E81fynAgROTU8SaPMbElspCS"
			  },
			  "object_type": "definition_activity"
			},
			{
			  "unique_name": "definition_activity_01RHTA7P9G1DU3ruSUexYS2yzW4O137mjgi",
			  "name": "Condition Block",
			  "title": "Did adding to the object group fail?",
			  "type": "logic.if_else",
			  "base_type": "activity",
			  "properties": {
				"continue_on_failure": false,
				"display_name": "Did adding to the object group fail?",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "blocks": [
				{
				  "unique_name": "definition_activity_01RHTA7POP90U3TPGUb49OU1bvB1PFKBatQ",
				  "name": "Condition Branch",
				  "title": "Yes",
				  "type": "logic.condition_block",
				  "base_type": "activity",
				  "properties": {
					"condition": {
					  "left_operand": "$activity.definition_activity_01RHSZ43CXZ3O6S8ayoh0cd30dIy9Qoaaxu.output.succeeded$",
					  "operator": "eq",
					  "right_operand": false
					},
					"continue_on_failure": false,
					"display_name": "Yes",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01RHT9HA62BW44ofVxvDh1kMVOQy2nXMSBY",
					  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
					  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
					  "type": "workflow.atomic_workflow",
					  "base_type": "subworkflow",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
						"input": {
						  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
						  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to add the address object to the address group:\n$activity.definition_activity_01RHSZ43CXZ3O6S8ayoh0cd30dIy9Qoaaxu.output.error.message$",
						  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
						},
						"runtime_user": {
						  "target_default": true
						},
						"skip_execution": false,
						"target": {
						  "override_workflow_target_group_criteria": true,
						  "target_group": {
							"run_on_all_targets": false,
							"use_criteria": {
							  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
							  "conditions": [
								{
								  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
								  "operator": "eqi",
								  "right_operand": "ServiceNow"
								}
							  ]
							}
						  }
						},
						"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01RHTQ8ZB1QM34X0u4PKE7w16SCwztHM7Gr",
					  "name": "Completed",
					  "title": "Failed",
					  "type": "logic.completed",
					  "base_type": "activity",
					  "properties": {
						"completion_type": "failed-completed",
						"continue_on_failure": false,
						"display_name": "Failed",
						"result_message": "SecureX orchestration failed to process the threat containment request. Failed to add the address object to the address group:\n$activity.definition_activity_01RHSZ43CXZ3O6S8ayoh0cd30dIy9Qoaaxu.output.error.message$",
						"skip_execution": false
					  },
					  "object_type": "definition_activity"
					}
				  ]
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01RHSZ4AAR8ZM3XTgYDe11jwUd6mpQzKb3n",
		  "name": "Palo Alto - Panorama - Search Service Objects",
		  "title": "Palo Alto - Panorama - Search Service Objects",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": true,
			"display_name": "Palo Alto - Panorama - Search Service Objects",
			"input": {
			  "variable_workflow_01QLG7YB3EX1N1sJ7qywmgUhpPDUlhUsOkF": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Destination Service$",
			  "variable_workflow_01QLGQ7HNZUGR6VgnRZlUktXitIfziOBdQF": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx$",
			  "variable_workflow_01QLGR1K92IM32zdYGxDHZKLLY6esuswiDP": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy$",
			  "variable_workflow_01QLIGKJV0PGQ1vczV3YBjmieI4N7odgLoh": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8$",
			  "variable_workflow_01QWHV53LS3GI2qreYRYx2IigvUdrLoWAu2": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Protocol$",
			  "variable_workflow_01QXBQ5GPMATI443jNfVF7QICPQK2WSAnir": ""
			},
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target_group": true
			},
			"workflow_id": "definition_workflow_01QLG27DV5HSE4B2bVtyZub0wi5XOdD6ccA"
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01ROI61INGOW32Ny2owZ8NOuoi7T9WnVoOd",
		  "name": "Condition Block",
		  "title": "Did the search fail?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Did the search fail?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01ROI61J0UQ6I77PmqulPjY1t6LfP1sIVmi",
			  "name": "Condition Branch",
			  "title": "Yes",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01RHSZ4AAR8ZM3XTgYDe11jwUd6mpQzKb3n.output.succeeded$",
				  "operator": "eq",
				  "right_operand": false
				},
				"continue_on_failure": false,
				"display_name": "Yes",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01ROKW3M375IN0j0d2C5TAceJE1qTZEwv1I",
				  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
					"input": {
					  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
					  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to search for service objects:\n$activity.definition_activity_01RHSZ4AAR8ZM3XTgYDe11jwUd6mpQzKb3n.output.error.message$",
					  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"run_on_all_targets": false,
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "ServiceNow"
							}
						  ]
						}
					  }
					},
					"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01ROI72BEOT7V18YHQRydkAUH4k36mrph7S",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "SecureX orchestration failed to process the threat containment request. Failed to search for service objects:\n$activity.definition_activity_01RHSZ4AAR8ZM3XTgYDe11jwUd6mpQzKb3n.output.error.message$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01RHSZ4B7Z9CR63mRJ3EDZBGueYqRlNSU6D",
		  "name": "Condition Block",
		  "title": "Was a service object found?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was a service object found?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01RHSZ4C0EP116Ww7ra5g5PyZ1CvlzPkMKY",
			  "name": "Condition Branch",
			  "title": "Yes",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01RHSZ4AAR8ZM3XTgYDe11jwUd6mpQzKb3n.output.variable_workflow_01QWCWO2D8MVO61mKIw9pnbQApCRi56NfMr$",
				  "operator": "ne",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "Yes",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01RHSZ4CYHLO04uWH0ikpHClwjb5ujVjhSh",
				  "name": "Set Variables",
				  "title": "Set service object name",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set service object name",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F7H0X5k64776dmp3pvptmYLETET$",
						"variable_value_new": "$activity.definition_activity_01RHSZ4AAR8ZM3XTgYDe11jwUd6mpQzKb3n.output.variable_workflow_01QLGLEA278AM2ET5Gg6SqZR7rpMHp69PsW$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01RHSZ4DXIH3Y5aSGjG7xF6RIWEvGQZkb5l",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01RHSZ4AAR8ZM3XTgYDe11jwUd6mpQzKb3n.output.variable_workflow_01QWCWO2D8MVO61mKIw9pnbQApCRi56NfMr$",
				  "operator": "eq",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01RHSZ4EYKES908pQFzPK0zLQzBTFjZEbwB",
				  "name": "Execute Python Script",
				  "title": "Create object names",
				  "type": "python3.script",
				  "base_type": "activity",
				  "properties": {
					"action_timeout": 180,
					"continue_on_failure": false,
					"display_name": "Create object names",
					"script": "from sys import argv\nfrom time import time\nservice_name = f'{argv[1]}-ServiceObject-{int(time())}'[:63]",
					"script_arguments": [
					  "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F88WM3yPZSrawk8Z2zsxnHC9jFZ$"
					],
					"script_queries": [
					  {
						"script_query": "service_name",
						"script_query_name": "Service Name",
						"script_query_type": "string"
					  }
					],
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01RHSZ4G4AWFN606Bplxh2Mv68U1WmChk47",
				  "name": "Palo Alto - Panorama - Create Service Object",
				  "title": "Palo Alto - Panorama - Create Service Object",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": true,
					"display_name": "Palo Alto - Panorama - Create Service Object",
					"input": {
					  "variable_workflow_01QIWNCBML6MX38U5B6GypOEvw7vnX9GgtD": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Protocol$",
					  "variable_workflow_01QIWOOQZSUEN5f0cgjR8FvyjrBjLZCXL8b": "$activity.definition_activity_01RHSZ4EYKES908pQFzPK0zLQzBTFjZEbwB.output.script_queries.Service Name$",
					  "variable_workflow_01QIWQL2Q7TO4403qsUM07WM3nNQ44d53XZ": "",
					  "variable_workflow_01QIWRPHGOGSE0HZa5EwaC5nfiEtLk8VvB3": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Destination Service$",
					  "variable_workflow_01QIWSCV00O7Q3PUgCfAXKVf0wnZSwXHyEW": "",
					  "variable_workflow_01QIWWITOV11Z2qVJpjp7JAYHTpojGWiH2B": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy$",
					  "variable_workflow_01QIX4KB9NJOU44cPUqSiTBwakt4PEs32Gj": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx$",
					  "variable_workflow_01QNTZTDPJ0PX70eNeCccu2TADhS2dH7vCl": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8$"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "use_workflow_target_group": true
					},
					"workflow_id": "definition_workflow_01QIQ4XDLP2MB0jpETWm3k97SDkSdVFQD0V"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01RHTSEI5XFZH6pnuQMqK19v3xHk6TmmEP5",
				  "name": "Condition Block",
				  "title": "Was the object created?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Was the object created?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01RHTSEIJO0Q73Wxx5ZaDg22sdYtsX57j2U",
					  "name": "Condition Branch",
					  "title": "No",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$activity.definition_activity_01RHSZ4G4AWFN606Bplxh2Mv68U1WmChk47.output.succeeded$",
						  "operator": "eq",
						  "right_operand": false
						},
						"continue_on_failure": false,
						"display_name": "No",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01RHTUQ9XDQZ76lTJSIDLf96misjfudCcGc",
						  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
						  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
						  "type": "workflow.atomic_workflow",
						  "base_type": "subworkflow",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
							"input": {
							  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
							  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to create a new service object:\n$activity.definition_activity_01RHSZ4G4AWFN606Bplxh2Mv68U1WmChk47.output.error.message$",
							  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
							},
							"runtime_user": {
							  "target_default": true
							},
							"skip_execution": false,
							"target": {
							  "override_workflow_target_group_criteria": true,
							  "target_group": {
								"run_on_all_targets": false,
								"use_criteria": {
								  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
								  "conditions": [
									{
									  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
									  "operator": "eqi",
									  "right_operand": "ServiceNow"
									}
								  ]
								}
							  }
							},
							"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
						  },
						  "object_type": "definition_activity"
						},
						{
						  "unique_name": "definition_activity_01RHUGTXWGAZ27kD4bHindgjkhgMxPMev09",
						  "name": "Completed",
						  "title": "Failed",
						  "type": "logic.completed",
						  "base_type": "activity",
						  "properties": {
							"completion_type": "failed-completed",
							"continue_on_failure": false,
							"display_name": "Failed",
							"result_message": "SecureX orchestration failed to process the threat containment request. Failed to create a new service object:\n$activity.definition_activity_01RHSZ4G4AWFN606Bplxh2Mv68U1WmChk47.output.error.message$",
							"skip_execution": false
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				},
				{
				  "unique_name": "definition_activity_01RK9NMHCC1YL2WurySlfcSVIQrV7tvPu79",
				  "name": "Set Variables",
				  "title": "Set service object name",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set service object name",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F7H0X5k64776dmp3pvptmYLETET$",
						"variable_value_new": "$activity.definition_activity_01RHSZ4EYKES908pQFzPK0zLQzBTFjZEbwB.output.script_queries.Service Name$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01RHSZ4QIIOV62IMI5RT5eg4FZ4aEU0md2n",
		  "name": "Palo Alto - Panorama - Add Service Object to Service Group",
		  "title": "Palo Alto - Panorama - Add Service Object to Service Group",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": true,
			"display_name": "Palo Alto - Panorama - Add Service Object to Service Group",
			"input": {
			  "variable_workflow_01QZUPYI1FYRM6Gzc1iJQHjuhJCjhALVzZj": "",
			  "variable_workflow_01QZUVFPRZVU21ie7OzubeVxtXNiGQbUkOe": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9N1G6VKZV2uE5UatB9IXUzXJfq$",
			  "variable_workflow_01QZUWLP4L6KY1JzeFxzRN7RILcCX3tCo7N": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F7H0X5k64776dmp3pvptmYLETET$",
			  "variable_workflow_01QZUXNPHLSDC0SMgJzvfe5XGwxPH6cQ6JY": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8$",
			  "variable_workflow_01QZV62GRKZ813OtwBUDEpZ98yN5HVzdElS": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx$",
			  "variable_workflow_01QZV9W12311W4mYCrRZ3ZZckzZNnrJB82i": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy$"
			},
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target_group": true
			},
			"workflow_id": "definition_workflow_01QZUMVG18YYB5HwsxsOzXdBu2d0K1ysuCU"
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01RHV0Y5ROKRB0BA1zE26UKDx4foWrHLqGN",
		  "name": "Condition Block",
		  "title": "Was the object added to the group?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was the object added to the group?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01RHV0Y684TFS31tEA6FkmQ5vsFzRVl0cYc",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01RHSZ4QIIOV62IMI5RT5eg4FZ4aEU0md2n.output.succeeded$",
				  "operator": "eq",
				  "right_operand": false
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01RHV8G7FC9HV6EgDV6hG66e38HdzF2I5lR",
				  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
					"input": {
					  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
					  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to add the service object to the service group:\n$activity.definition_activity_01RHSZ4QIIOV62IMI5RT5eg4FZ4aEU0md2n.output.error.message$",
					  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"run_on_all_targets": false,
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "ServiceNow"
							}
						  ]
						}
					  }
					},
					"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01RHV4U23M3VE1OGK0eRPM1wQnexzaeKNtq",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "SecureX orchestration failed to process the threat containment request. Failed to add the service object to the service group:\n$activity.definition_activity_01RHSZ4QIIOV62IMI5RT5eg4FZ4aEU0md2n.output.error.message$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01RHSZ4YYR3G65UB8P7hAZZVdaTfLpe47br",
		  "name": "Palo Alto - Panorama - Update Security Policy Pre Rule",
		  "title": "Palo Alto - Panorama - Update Security Policy Pre Rule",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": true,
			"display_name": "Palo Alto - Panorama - Update Security Policy Pre Rule",
			"input": {
			  "variable_workflow_01QORDBZK6YF64HcaH4ephX41pXR32BulYH": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RII1T3YPJC2164dWb5vMN4XtRzBapTLO8$",
			  "variable_workflow_01QORE7C3W1GS0C06sZWCHoOPy2KTc7ZIEJ": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FAK2248S4r8PqQ7vzq3XABfOQLy$",
			  "variable_workflow_01QORLXE4CFPO3GESHrSxqVZjMffKJYH7eW": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8SXO4GrtcSmaF3u9zyYzPawWVx$",
			  "variable_workflow_01QORNV7L6VFC2GEJQjV9aYccoU9l1XhNpE": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01SDX8U99EKHR74GRuJaEP8FgHmdoxntRkw$",
			  "variable_workflow_01QOROBKETGTA5uK2Sso1LLGUJBfbmHaCap": "",
			  "variable_workflow_01QORT3NX7VTY0FhfmHt2FM59GfYYrPC7hf": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.Action$",
			  "variable_workflow_01QORU1IFYXEO5s5MH67x18Ys5PWVzj1V0L": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9UJF5AENwdUFHNERIXXb9sTko2$",
			  "variable_workflow_01QORV740TZ3Y7l3CMEzFHjqCl8Nxhuhmi7": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9N1G6VKZV2uE5UatB9IXUzXJfq$",
			  "variable_workflow_01QORVO26588W59DhdqGmAZYtzfc1q4kZZb": "",
			  "variable_workflow_01QOTXQJBHQ1U23Nlcz8ZM6S92fmdwsOGxx": "$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FADWI2gXEkEk4hpcVagKl5q4kt9$"
			},
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target_group": true
			},
			"workflow_id": "definition_workflow_01QNWS0U2T5QY6MfHyMZT0BUd9sNyLnQyTk"
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01RHVD674LHAG4Wwf7BkpWvKRuNqKtV2Dpn",
		  "name": "Condition Block",
		  "title": "Was the pre rule updated?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was the pre rule updated?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01RHVD67CYGLZ37aJs2FvbNjoBMG6b0BtvC",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01RHSZ4YYR3G65UB8P7hAZZVdaTfLpe47br.output.succeeded$",
				  "operator": "eq",
				  "right_operand": false
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01RHVG1E93QUZ4ozncVzW4DSsBmCB8fhF9p",
				  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
					"input": {
					  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
					  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration failed to process the threat containment request. Failed to update the security policy pre rule:\n$activity.definition_activity_01RHSZ4YYR3G65UB8P7hAZZVdaTfLpe47br.output.error.message$",
					  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"run_on_all_targets": false,
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "ServiceNow"
							}
						  ]
						}
					  }
					},
					"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01RHVHHOZXUSD6RnREHmN20PF9KByO49nYv",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "SecureX orchestration failed to process the threat containment request. Failed to update the security policy pre rule:\n$activity.definition_activity_01RHSZ4YYR3G65UB8P7hAZZVdaTfLpe47br.output.error.message$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01RHSZ542BF0S5IVBIlQKCsFIxaADHl02VV",
		  "name": "ServiceNow - Add Work Note to Firewall Rule Task",
		  "title": "ServiceNow - Add Work Note to Firewall Rule Task",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
			"input": {
			  "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01RHSZ39YILAN0rzni5aN0tBV6e0v5kmiPi.output.script_queries.ServiceNow Task ID$",
			  "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "SecureX orchestration has updated the security policy pre rule \"$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01SDX8U99EKHR74GRuJaEP8FgHmdoxntRkw$\" successfully!\n- Source group \"$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9UJF5AENwdUFHNERIXXb9sTko2$\" updated with object \"$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FA7KO7G1SfD1rkCmFS4SogVyEEq$\"\n- Destination group \"$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32FADWI2gXEkEk4hpcVagKl5q4kt9$\" updated with object \"$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F8FY15Tvdh4RnkXtGTZf9nKJEzg$\"\n- Service group \"$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F9N1G6VKZV2uE5UatB9IXUzXJfq$\" updated with object \"$workflow.definition_workflow_01RHSZ328KBTC3l51l1VSqIwTjyiWKNMD9N.local.variable_workflow_01RHSZ32F7H0X5k64776dmp3pvptmYLETET$\"",
			  "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
			},
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "override_workflow_target_group_criteria": true,
			  "target_group": {
				"run_on_all_targets": false,
				"use_criteria": {
				  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
				  "conditions": [
					{
					  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
					  "operator": "eqi",
					  "right_operand": "ServiceNow"
					}
				  ]
				}
			  }
			},
			"workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
		  },
		  "object_type": "definition_activity"
		}
	  ],
	  "categories": [
		"category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
	  ]
	},
	"categories": {
	  "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
		"unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
		"name": "response",
		"title": "response",
		"type": "basic.category",
		"base_type": "category",
		"category_type": "custom",
		"object_type": "category"
	  }
	},
	"target_groups": {
	  "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
		"unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
		"name": "Default TargetGroup",
		"title": "Default TargetGroup",
		"type": "generic.target_group",
		"base_type": "target_group",
		"version": "1.0.0",
		"targets": [
		  {
			"data_target_type": "web-service.endpoint",
			"view_target_type": "web-service.endpoint",
			"include_all_targets": true
		  },
		  {
			"data_target_type": "email.smtp_endpoint",
			"view_target_type": "email.smtp_endpoint",
			"include_all_targets": true
		  }
		],
		"object_type": "target_group"
	  }
	},
	"atomic_workflows": [
	  "definition_workflow_01QIQ4XDLP2MB0jpETWm3k97SDkSdVFQD0V",
	  "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
	  "definition_workflow_01QQJ2AU0DAS47HJHH5JuZ92pnPzGAMyQUf",
	  "definition_workflow_01PV9FLWXZHNA1gKq6UBTXF0OtZq0fX3vOA",
	  "definition_workflow_01PV9RDPLW6E81fynAgROTU8SaPMbElspCS",
	  "definition_workflow_01QZUMVG18YYB5HwsxsOzXdBu2d0K1ysuCU",
	  "definition_workflow_01QNWS0U2T5QY6MfHyMZT0BUd9sNyLnQyTk",
	  "definition_workflow_01QLG27DV5HSE4B2bVtyZub0wi5XOdD6ccA"
	]
  }