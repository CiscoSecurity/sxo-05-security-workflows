{
	"workflow": {
	  "unique_name": "definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79",
	  "name": "0057 - Secure Malware Analytics - Endpoint IOCs from File Hash",
	  "title": "0057 - Secure Malware Analytics - Endpoint IOCs from File Hash",
	  "type": "generic.workflow",
	  "base_type": "workflow",
	  "variables": [
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "sha256",
			"scope": "input",
			"name": "observable_type",
			"type": "datatype.string",
			"description": "The type of observable pivoted on",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "output",
			"name": "ServiceNow Ticket ID",
			"type": "datatype.string",
			"description": "The ID of the incident ticket opened in ServiceNow",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01UEOGYCQN3FU6V6VAdFZx7rVBAMfm0O9pF",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "579786ed91fcd1c779d2d973ea671f5e3a944bc59f6e08e3ee25386ef6d99480",
			"scope": "input",
			"name": "observable_value",
			"type": "datatype.string",
			"description": "The value of the observable pivoted on",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.secure_string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Secure Malware Analytics API Key",
			"type": "datatype.secure_string",
			"description": "The API key to use with Secure Malware Analytics. You can either set this here (and remove this variable from the Fetch Global Variables activity) or you can use the Fetch Global Variables activity to update this variable with an existing API key from a global variable",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01UEI5FVC5IZ64Ux4V0sbOdy73fU4q5B5Rx",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Ticket Text",
			"type": "datatype.string",
			"description": "Placeholder used to assemble information for the ServiceNow incident ticket. This will be populated automatically",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01UEI5FVC67AK2VL2GFSJhsXp3GS7Ur7E5N",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "securex-orchestration",
			"scope": "local",
			"name": "ServiceNow User ID",
			"type": "datatype.string",
			"description": "The username of the user you're using to open incident tickets. This can either match the username in your ServiceNow account key or, if the account has the appropriate permissions, can be a different user",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01UEI5FVC5U57787PcVQwnmIEwijZ9YH7AJ",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.integer",
		  "properties": {
			"value": 0,
			"scope": "local",
			"name": "Host Count",
			"type": "datatype.integer",
			"description": "Keeps track of how many hosts are impacted by the IOCs discovered by the workflow. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01UIQINEXX7GM1Urys9YrjyEta7S1OEjse0",
		  "object_type": "variable_workflow"
		}
	  ],
	  "properties": {
		"atomic": {
		  "is_atomic": false
		},
		"delete_workflow_instance": false,
		"description": "Searches Cisco Secure Malware Analytics for IOCs related to the file hash provided. If IOCs are found with Orbital queries, the queries are executed on all endpoints running Orbital. The Orbital results are then checked to see if any hosts may be vulnerable to the IOCs and the results are documented in a ServiceNow incident ticket. Supported observables: sha1, sha256, md5\n\nTarget Group: Default TargetGroup\n\nTargets: Orbital_For_Access_Token, Orbital_Target, ServiceNow, ThreatGrid_Target\n\nSteps:\n[] Please see the documentation linked below\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0057",
		"display_name": "0057 - Secure Malware Analytics - Endpoint IOCs from File Hash",
		"runtime_user": {
		  "target_default": true
		},
		"target": {
		  "execute_on_target_group": true,
		  "target_group": {
			"target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
			"run_on_all_targets": false,
			"selected_target_types": [
			  "web-service.endpoint"
			],
			"use_criteria": {
			  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
			  "conditions": [
				{
				  "operator": "eqi",
				  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
				  "right_operand": "ThreatGrid_Target"
				}
			  ]
			}
		  }
		}
	  },
	  "object_type": "definition_workflow",
	  "actions": [
		{
		  "unique_name": "definition_activity_01UEI5GAU7Y370Jb3PyRwaDMAiqZSavq3sh",
		  "name": "Group",
		  "title": "Fetch global variables",
		  "type": "logic.group",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Fetch global variables",
			"skip_execution": true
		  },
		  "object_type": "definition_activity",
		  "actions": [
			{
			  "unique_name": "definition_activity_01UEI5GCNLYFW4Wgm9iVPOMkKhv4TpW1Fxo",
			  "name": "Set Variables",
			  "title": "Fetch global variables",
			  "type": "core.set_multiple_variables",
			  "base_type": "activity",
			  "properties": {
				"continue_on_failure": false,
				"display_name": "Fetch global variables",
				"skip_execution": false,
				"variables_to_update": [
				  {
					"variable_to_update": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC5IZ64Ux4V0sbOdy73fU4q5B5Rx$",
					"variable_value_new": ""
				  }
				]
			  },
			  "object_type": "definition_activity"
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01UI4PF27RJL96qQq7qHN7fFME05VBcW5jN",
		  "name": "Condition Block",
		  "title": "Is the observable supported?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Is the observable supported?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01UI4PF363G460qp4bsUN2bnIHIjFzEfFGn",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": {
					"left_operand": {
					  "left_operand": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$",
					  "operator": "ne",
					  "right_operand": "sha256"
					},
					"operator": "and",
					"right_operand": {
					  "left_operand": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$",
					  "operator": "ne",
					  "right_operand": "sha1"
					}
				  },
				  "operator": "and",
				  "right_operand": {
					"left_operand": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$",
					"operator": "ne",
					"right_operand": "md5"
				  }
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UI4QI0D6LCL588EGXAfzYxaGdKsDbsLjM",
				  "name": "Completed",
				  "title": "Unsupported observable",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Unsupported observable",
					"result_message": "The observable type \"$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$\" is not supported by this workflow",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01UEI5H4UB07B5mzuMNwuUApSfCK8H3VODG",
		  "name": "Condition Block",
		  "title": "Was a ServiceNow user provided?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was a ServiceNow user provided?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01UEI5H6E15XQ7fZTbGx2CshY2n56m3JN8V",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC5U57787PcVQwnmIEwijZ9YH7AJ$",
				  "operator": "eq",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UEI5H89YR021E0GSLPwYJDNwZXCO93doZ",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "A ServiceNow username must be provided",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01UI4WK73OLET45UZtujScrqVPDYeMHVeCW",
		  "name": "Read Table from JSON",
		  "title": "Create a table for IOCs",
		  "type": "corejava.read_table_from_json",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": false,
			"display_name": "Create a table for IOCs",
			"input_json": "[]",
			"jsonpath_query": "$.",
			"persist_output": true,
			"populate_columns": false,
			"skip_execution": false,
			"table_columns": [
			  {
				"column_name": "sample",
				"column_type": "string"
			  },
			  {
				"column_name": "title",
				"column_type": "string"
			  },
			  {
				"column_name": "description",
				"column_type": "string"
			  },
			  {
				"column_name": "ioc",
				"column_type": "string"
			  },
			  {
				"column_name": "orbital-queries",
				"column_type": "string"
			  },
			  {
				"column_name": "query-id",
				"column_type": "string"
			  },
			  {
				"column_name": "orbital-results",
				"column_type": "string"
			  },
			  {
				"column_name": "orbital-url",
				"column_type": "string"
			  },
			  {
				"column_name": "hosts",
				"column_type": "string"
			  },
			  {
				"column_name": "filename",
				"column_type": "string"
			  }
			]
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01UEI5HEKXD5G795tx4CFjl7XvBwxcFA4xF",
		  "name": "Secure Malware Analytics - Get Samples by File Hash",
		  "title": "Secure Malware Analytics - Get Samples by File Hash",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Secure Malware Analytics - Get Samples by File Hash",
			"input": {
			  "variable_workflow_01PP75MUYR6BQ3JMaE2C9DeLQfA0NGKwcC0": "submitted_at",
			  "variable_workflow_01PP75MUYRAK15oaEltBUsDEK8LVXcyitUZ": "",
			  "variable_workflow_01PP75MUYRBW524x1K9sMRvOlP5rv7ZaZMl": 0,
			  "variable_workflow_01PP75MUYRD4R2X2ffVGla8Fm8G0NXX5VSh": "desc",
			  "variable_workflow_01PP75MUYREAP0sMFJtkk2iJ7DayVQxbbpD": 20,
			  "variable_workflow_01PP75MUYRHW34Cx3mTFnKkxx91tf2ErJMj": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC5IZ64Ux4V0sbOdy73fU4q5B5Rx$",
			  "variable_workflow_01PP75MUYRJ4J17Q5LllVtuhr2dnXXWRxC6": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv$"
			},
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target_group": true
			},
			"workflow_id": "definition_workflow_01PP75MV62DWN0raRr4mKAGgLjQhLnPVlFJ"
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01UEI5HHA1RTZ2KVjGlchGWVP46Ni6ODKJx",
		  "name": "Condition Block",
		  "title": "Were any samples found?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Were any samples found?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01UEI5HK0VOTP43kiYm5tLTr8P6Sy5CY3RN",
			  "name": "Condition Branch",
			  "title": "Yes",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01UEI5HEKXD5G795tx4CFjl7XvBwxcFA4xF.output.variable_workflow_01PP75MUYRGQ06JQQxfMgwb1J2zavZzK5cS$",
				  "operator": "gt",
				  "right_operand": 0
				},
				"continue_on_failure": false,
				"display_name": "Yes",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UEI5HMI513W1aponAapR0BSY1AZeJyPlv",
				  "name": "JSONPath Query",
				  "title": "Extract sample IDs",
				  "type": "corejava.jsonpathquery",
				  "base_type": "activity",
				  "properties": {
					"action_timeout": 180,
					"continue_on_failure": false,
					"display_name": "Extract sample IDs",
					"input_json": "$activity.definition_activity_01UEI5HEKXD5G795tx4CFjl7XvBwxcFA4xF.output.variable_workflow_01PP75MUYRFJG1CNlrZRn3hAlMgNartGgrP$",
					"jsonpath_queries": [
					  {
						"jsonpath_query": "$.data.items[*].item.sample",
						"jsonpath_query_name": "sample_list",
						"jsonpath_query_type": "string"
					  }
					],
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01UI574X32XUI0lV2XetORFz0jSweSiiFPH",
				  "name": "Match Regex",
				  "title": "Parse IDs to list",
				  "type": "core.matchregex",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Parse IDs to list",
					"input_regex": "([a-z0-9]+)",
					"input_string": "$activity.definition_activity_01UEI5HMI513W1aponAapR0BSY1AZeJyPlv.output.jsonpath_queries.sample_list$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01UEI5HTWSW140O9dgW2ir23n5pwKTHrwPi",
				  "name": "For Each",
				  "title": "For Each Sample in Sample List",
				  "type": "logic.for_each",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "For Each Sample in Sample List",
					"skip_execution": false,
					"source_array": "$activity.definition_activity_01UI574X32XUI0lV2XetORFz0jSweSiiFPH.output.matching_strings$"
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01UEI5HX2YNU8089SZnyVszkfGLQD2ZTOCD",
					  "name": "Secure Malware Analytics - Get Sample Analysis",
					  "title": "Secure Malware Analytics - Get Sample Analysis",
					  "type": "workflow.atomic_workflow",
					  "base_type": "subworkflow",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Secure Malware Analytics - Get Sample Analysis",
						"input": {
						  "variable_workflow_01PP7889J206H2c622JY1H7wL3GGYHZ3q6r": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC5IZ64Ux4V0sbOdy73fU4q5B5Rx$",
						  "variable_workflow_01PP7889J24FD4e2HujSrmiBcU7HibFa3Bt": "$activity.definition_activity_01UEI5HTWSW140O9dgW2ir23n5pwKTHrwPi.input.source_array[@]$"
						},
						"runtime_user": {
						  "target_default": true
						},
						"skip_execution": false,
						"target": {
						  "use_workflow_target_group": true
						},
						"workflow_id": "definition_workflow_01PP7889QZ7LW3KC8jCPnHzO2hKwjeNWPMi"
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01UEI5HZXQ0QO7CQBW4MqpRwnnosOGmncgF",
					  "name": "Read Table from JSON",
					  "title": "Parse IOCs from sample",
					  "type": "corejava.read_table_from_json",
					  "base_type": "activity",
					  "properties": {
						"action_timeout": 180,
						"continue_on_failure": true,
						"display_name": "Parse IOCs from sample",
						"input_json": "$activity.definition_activity_01UEI5HX2YNU8089SZnyVszkfGLQD2ZTOCD.output.variable_workflow_01PP7889J25O16gY6tGAd75K5BD9Pyvi19f$",
						"jsonpath_query": "$.iocs[?(@.orbital-queries.length() > 0)]",
						"persist_output": true,
						"populate_columns": false,
						"skip_execution": false,
						"table_columns": [
						  {
							"column_name": "title",
							"column_type": "string"
						  },
						  {
							"column_name": "description",
							"column_type": "string"
						  },
						  {
							"column_name": "severity",
							"column_type": "integer"
						  },
						  {
							"column_name": "ioc",
							"column_type": "string"
						  },
						  {
							"column_name": "orbital-queries",
							"column_type": "string"
						  }
						]
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01UEI5I2V33PJ5zjlw1APgWtXeAcAIACOc1",
					  "name": "Condition Block",
					  "title": "Does the sample contain Orbital queires?",
					  "type": "logic.if_else",
					  "base_type": "activity",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Does the sample contain Orbital queires?",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "blocks": [
						{
						  "unique_name": "definition_activity_01UEI5I57I9LP4AMCV0be8m9dAevzQ9OnUG",
						  "name": "Condition Branch",
						  "title": "Yes",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$activity.definition_activity_01UEI5HZXQ0QO7CQBW4MqpRwnnosOGmncgF.output.succeeded$",
							  "operator": "eq",
							  "right_operand": true
							},
							"continue_on_failure": false,
							"display_name": "Yes",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01UEI5I7RCP2Q5rxLeGkCWnp8o9UjxzbcEr",
							  "name": "For Each",
							  "title": "For each IOC",
							  "type": "logic.for_each",
							  "base_type": "activity",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "For each IOC",
								"skip_execution": false,
								"source_array": "$activity.definition_activity_01UEI5HZXQ0QO7CQBW4MqpRwnnosOGmncgF.output.read_table_from_json$"
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01UIPC1O3J2691ZKk7CQuEzobnTeLkShUrS",
								  "name": "Select from Table",
								  "title": "Check if the IOC is in the table already",
								  "type": "core.selectfromtable",
								  "base_type": "activity",
								  "properties": {
									"action_timeout": 180,
									"columns": [
									  {
										"column_name": "title",
										"column_type": "string"
									  }
									],
									"continue_on_failure": false,
									"display_name": "Check if the IOC is in the table already",
									"input_table": "$activity.definition_activity_01UI4WK73OLET45UZtujScrqVPDYeMHVeCW.output.read_table_from_json$",
									"number_of_rows": {
									  "all_rows": true
									},
									"persist_output": false,
									"skip_execution": false,
									"sorting": {
									  "no_sort": true
									},
									"where_clause": "ioc == '$activity.definition_activity_01UEI5I7RCP2Q5rxLeGkCWnp8o9UjxzbcEr.input.source_array[@].ioc$'"
								  },
								  "object_type": "definition_activity"
								},
								{
								  "unique_name": "definition_activity_01UEI5IA6RM312fp9VCmFe7wXbLdAs59bRc",
								  "name": "Condition Block",
								  "title": "Is this query already in the IOC table?",
								  "type": "logic.if_else",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Is this query already in the IOC table?",
									"skip_execution": false
								  },
								  "object_type": "definition_activity",
								  "blocks": [
									{
									  "unique_name": "definition_activity_01UEI5IGMR0CD7i5s0inMU85fQksdaXq5Mf",
									  "name": "Condition Branch",
									  "title": "No",
									  "type": "logic.condition_block",
									  "base_type": "activity",
									  "properties": {
										"condition": {
										  "left_operand": "$activity.definition_activity_01UIPC1O3J2691ZKk7CQuEzobnTeLkShUrS.output.row_count$",
										  "operator": "eq",
										  "right_operand": 0
										},
										"continue_on_failure": false,
										"display_name": "No",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "actions": [
										{
										  "unique_name": "definition_activity_01UEI5IJB1ZEO2sdflrSsM1ylbYc71zm50K",
										  "name": "Add Row to Table",
										  "title": "Add query to IOC table",
										  "type": "core.addrowtotable",
										  "base_type": "activity",
										  "properties": {
											"action_timeout": 180,
											"continue_on_failure": false,
											"display_name": "Add query to IOC table",
											"input_table": "$activity.definition_activity_01UI4WK73OLET45UZtujScrqVPDYeMHVeCW.output.read_table_from_json$",
											"row": [
											  {
												"key": "sample",
												"type": "string",
												"value": "$activity.definition_activity_01UEI5HTWSW140O9dgW2ir23n5pwKTHrwPi.input.source_array[@]$"
											  },
											  {
												"key": "title",
												"type": "string",
												"value": "$activity.definition_activity_01UEI5I7RCP2Q5rxLeGkCWnp8o9UjxzbcEr.input.source_array[@].title$"
											  },
											  {
												"key": "description",
												"type": "string",
												"value": "$activity.definition_activity_01UEI5I7RCP2Q5rxLeGkCWnp8o9UjxzbcEr.input.source_array[@].description$"
											  },
											  {
												"key": "ioc",
												"type": "string",
												"value": "$activity.definition_activity_01UEI5I7RCP2Q5rxLeGkCWnp8o9UjxzbcEr.input.source_array[@].ioc$"
											  },
											  {
												"key": "orbital-queries",
												"type": "string",
												"value": "$activity.definition_activity_01UEI5I7RCP2Q5rxLeGkCWnp8o9UjxzbcEr.input.source_array[@].orbital-queries$"
											  },
											  {
												"key": "query-id",
												"type": "string"
											  },
											  {
												"key": "orbital-results",
												"type": "string"
											  },
											  {
												"key": "orbital-url",
												"type": "string"
											  },
											  {
												"key": "hosts",
												"type": "string"
											  },
											  {
												"key": "filename",
												"type": "string"
											  }
											],
											"skip_execution": false
										  },
										  "object_type": "definition_activity"
										}
									  ]
									}
								  ]
								}
							  ]
							}
						  ]
						},
						{
						  "unique_name": "definition_activity_01UEI5IN654V41aohlY5fKXpqdAWyaAkgpV",
						  "name": "Condition Branch",
						  "title": "No",
						  "type": "logic.condition_block",
						  "base_type": "activity",
						  "properties": {
							"condition": {
							  "left_operand": "$activity.definition_activity_01UEI5HZXQ0QO7CQBW4MqpRwnnosOGmncgF.output.succeeded$",
							  "operator": "eq",
							  "right_operand": false
							},
							"continue_on_failure": false,
							"display_name": "No",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "actions": [
							{
							  "unique_name": "definition_activity_01UEI5IQAFMHA5U892xT8Q6RvWrrht32iGR",
							  "name": "Continue",
							  "title": "Skip this sample",
							  "type": "logic.continue",
							  "base_type": "activity",
							  "properties": {
								"continue_on_failure": false,
								"display_name": "Skip this sample",
								"skip_execution": false
							  },
							  "object_type": "definition_activity"
							}
						  ]
						}
					  ]
					}
				  ]
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01UEI5IYETXWV2zGxWpFQQV2oHkjrvCVplS",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01UEI5HEKXD5G795tx4CFjl7XvBwxcFA4xF.output.variable_workflow_01PP75MUYRGQ06JQQxfMgwb1J2zavZzK5cS$",
				  "operator": "eq",
				  "right_operand": 0
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UEI5J1A2TCF3oROWusyS6vS0q05jajSAd",
				  "name": "Completed",
				  "title": "No samples found",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "No samples found",
					"result_message": "The file hash \"$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv$\" of type $workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$ was not found in Secure Malware Analytics. Please submit the file to Secure Malware Analytics before running this workflow",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01UEI5IT55BL74lnKiHsG0qxjd7L0tu2ey6",
		  "name": "Select from Table",
		  "title": "Count IOC table rows",
		  "type": "core.selectfromtable",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"columns": [
			  {
				"column_name": "sample",
				"column_type": "string"
			  },
			  {
				"column_name": "title",
				"column_type": "string"
			  },
			  {
				"column_name": "description",
				"column_type": "string"
			  },
			  {
				"column_name": "ioc",
				"column_type": "string"
			  },
			  {
				"column_name": "orbital-queries",
				"column_type": "string"
			  },
			  {
				"column_name": "query-id",
				"column_type": "string"
			  },
			  {
				"column_name": "orbital-results",
				"column_type": "string"
			  },
			  {
				"column_name": "orbital-url",
				"column_type": "string"
			  },
			  {
				"column_name": "hosts",
				"column_type": "string"
			  },
			  {
				"column_name": "filename",
				"column_type": "string"
			  }
			],
			"continue_on_failure": false,
			"display_name": "Count IOC table rows",
			"input_table": "$activity.definition_activity_01UI4WK73OLET45UZtujScrqVPDYeMHVeCW.output.read_table_from_json$",
			"number_of_rows": {
			  "all_rows": true
			},
			"persist_output": false,
			"skip_execution": false,
			"sorting": {
			  "no_sort": true
			}
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01UEI5J5XIILK0fLHrAi4VJ81s1FziNwtwl",
		  "name": "Condition Block",
		  "title": "Were IOCs with Orbital queries found?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Were IOCs with Orbital queries found?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01UEI5J89QPP24nwoFB2vk6lhtv0iaXHfLJ",
			  "name": "Condition Branch",
			  "title": "Yes",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01UEI5IT55BL74lnKiHsG0qxjd7L0tu2ey6.output.row_count$",
				  "operator": "gt",
				  "right_operand": 0
				},
				"continue_on_failure": false,
				"display_name": "Yes",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UEI5JE59MBT0dPPNVhYbj3G3hRhOhpS3n",
				  "name": "For Each",
				  "title": "For each IOC",
				  "type": "logic.for_each",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "For each IOC",
					"skip_execution": false,
					"source_array": "$activity.definition_activity_01UEI5IT55BL74lnKiHsG0qxjd7L0tu2ey6.output.output_table$"
				  },
				  "object_type": "definition_activity",
				  "actions": [
					{
					  "unique_name": "definition_activity_01UEI5JJWH6IT6hTTik6owB9bQ6olRrBqr5",
					  "name": "Threat Response - Generate Access Token",
					  "title": "Threat Response - Generate Access Token",
					  "type": "workflow.atomic_workflow",
					  "base_type": "subworkflow",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Threat Response - Generate Access Token",
						"runtime_user": {
						  "target_default": true
						},
						"skip_execution": false,
						"target": {
						  "override_workflow_target_group_criteria": true,
						  "target_group": {
							"run_on_all_targets": false,
							"use_criteria": {
							  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
							  "conditions": [
								{
								  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
								  "operator": "eqi",
								  "right_operand": "Orbital_For_Access_Token"
								}
							  ]
							}
						  }
						},
						"workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH"
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01UEI5JNH8KSF2KymUvpbPX1bGDJVa7ljLX",
					  "name": "Execute Python Script",
					  "title": "Build Orbital query arguments",
					  "type": "python3.script",
					  "base_type": "activity",
					  "properties": {
						"action_timeout": 180,
						"continue_on_failure": false,
						"display_name": "Build Orbital query arguments",
						"script": "import sys, json\n\nqueryArray = json.loads(sys.argv[1])\n\ndef parse_values(values):\n  queryValues = {}\n  for value in values:\n    queryValues[value] = [values[value]]\n  return queryValues\n\norbitalQuery = queryArray[0][\"query-id\"]\norbitalArgs = parse_values(queryArray[0][\"values\"][0])\norbitalArgs = json.dumps(orbitalArgs)",
						"script_arguments": [
						  "$activity.definition_activity_01UEI5JE59MBT0dPPNVhYbj3G3hRhOhpS3n.input.source_array[@].orbital-queries$"
						],
						"script_queries": [
						  {
							"script_query": "orbitalQuery",
							"script_query_name": "orbitalQuery",
							"script_query_type": "string"
						  },
						  {
							"script_query": "orbitalArgs",
							"script_query_name": "orbitalArgs",
							"script_query_type": "string"
						  }
						],
						"skip_execution": false
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01UEI5JPSXRZ21iiHKJvVvnpXdIUBrhH9Gn",
					  "name": "Orbital - Query All Endpoints",
					  "title": "Orbital - Query All Endpoints",
					  "type": "workflow.atomic_workflow",
					  "base_type": "subworkflow",
					  "properties": {
						"continue_on_failure": false,
						"display_name": "Orbital - Query All Endpoints",
						"input": {
						  "variable_workflow_01PP74XXDJ6I02lUbtpjEKbDd7y0gpOYS4y": true,
						  "variable_workflow_01PP74XXDJ7U10PBSYZl7md3gg6krQ03p57": "",
						  "variable_workflow_01PP74XXDJ95H0lvwlcEnTPXWXQgvbbTKe6": "$activity.definition_activity_01UEI5JNH8KSF2KymUvpbPX1bGDJVa7ljLX.output.script_queries.orbitalQuery$",
						  "variable_workflow_01PP74XXDJAL33MsBJCm3Iptr9I5iu7pLvI": "",
						  "variable_workflow_01PP74XXDJFAH5HLlFGbENuXfD77aWNTPrF": "$activity.definition_activity_01UEI5JJWH6IT6hTTik6owB9bQ6olRrBqr5.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$",
						  "variable_workflow_01PP74XXDJGFR2b0QKga75DJjqwiX0K9Nbt": 10,
						  "variable_workflow_01SW2GRR9R9EH4rSK7JBaDZjavxyl8SX0UR": "0",
						  "variable_workflow_01SW2H938IB3V0XwjYGxkRaW62xKwJH0gwF": "$activity.definition_activity_01UEI5JNH8KSF2KymUvpbPX1bGDJVa7ljLX.output.script_queries.orbitalArgs$"
						},
						"runtime_user": {
						  "target_default": true
						},
						"skip_execution": false,
						"target": {
						  "override_workflow_target_group_criteria": true,
						  "target_group": {
							"run_on_all_targets": false,
							"use_criteria": {
							  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
							  "conditions": [
								{
								  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
								  "operator": "eqi",
								  "right_operand": "Orbital_Target"
								}
							  ]
							}
						  }
						},
						"workflow_id": "definition_workflow_01PP74XXLH4JK5RznBkKvbBUhiBqVm0A35C"
					  },
					  "object_type": "definition_activity"
					},
					{
					  "unique_name": "definition_activity_01UIQA8BC94Y12sVum84iAFMHAxo1wcvX4K",
					  "name": "Update Row in Table",
					  "title": "Add Orbital results to table",
					  "type": "core.updaterowintable",
					  "base_type": "activity",
					  "properties": {
						"action_timeout": 180,
						"columns": [
						  {
							"column_name": "query-id",
							"column_type": "string"
						  },
						  {
							"column_name": "orbital-results",
							"column_type": "string"
						  }
						],
						"continue_on_failure": false,
						"display_name": "Add Orbital results to table",
						"input_table": "$activity.definition_activity_01UI4WK73OLET45UZtujScrqVPDYeMHVeCW.output.read_table_from_json$",
						"row": [
						  {
							"key": "query-id",
							"type": "string",
							"value": "$activity.definition_activity_01UEI5JPSXRZ21iiHKJvVvnpXdIUBrhH9Gn.output.variable_workflow_01PP74XXDJCY74dJLD4gRvaMADzoTM2ZCHK$"
						  },
						  {
							"key": "orbital-results",
							"type": "string",
							"value": "$activity.definition_activity_01UEI5JPSXRZ21iiHKJvVvnpXdIUBrhH9Gn.output.variable_workflow_01PP74XXDJBRP6hhz6uRRyhmvLv1NKZQnt9$"
						  }
						],
						"rows": {
						  "rows_matching_criteria": true,
						  "where_clause": "ioc == '$activity.definition_activity_01UEI5JE59MBT0dPPNVhYbj3G3hRhOhpS3n.input.source_array[@].ioc$'"
						},
						"skip_execution": false
					  },
					  "object_type": "definition_activity"
					}
				  ]
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01UEI5JX87URB6zkcEuAY96qOYhrdhNHiy0",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01UEI5IT55BL74lnKiHsG0qxjd7L0tu2ey6.output.row_count$",
				  "operator": "eq",
				  "right_operand": 0
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UEI5JZ582UP3IYZBYsvmGexMAjDiNJqq7",
				  "name": "Completed",
				  "title": "Completed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "succeeded",
					"continue_on_failure": false,
					"display_name": "Completed",
					"result_message": "No Orbital IOC queries were found for the $workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$ file hash \"$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv$\"",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01UIQB33NHGR11u7E9K7Rsl7mY9beK3x9wi",
		  "name": "For Each",
		  "title": "For each set of Orbital results",
		  "type": "logic.for_each",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "For each set of Orbital results",
			"skip_execution": false,
			"source_array": "$activity.definition_activity_01UI4WK73OLET45UZtujScrqVPDYeMHVeCW.output.read_table_from_json$"
		  },
		  "object_type": "definition_activity",
		  "actions": [
			{
			  "unique_name": "definition_activity_01UIQBEAUCR8P5MqMzCvt33rFIfD8SSPKZV",
			  "name": "Execute Python Script",
			  "title": "Parse the results",
			  "type": "python3.script",
			  "base_type": "activity",
			  "properties": {
				"action_timeout": 180,
				"continue_on_failure": false,
				"display_name": "Parse the results",
				"script": "import sys, json\n\norbitalResults = json.loads(sys.argv[1])\nsampleId = sys.argv[2]\norbitalJobId = sys.argv[3]\niocTitle = sys.argv[4]\niocDescription = sys.argv[5]\n\nhostList = ''\nhostCount = 0\n\nfor host in orbitalResults:\n  if host['osQueryResult'][0]['values'] == None:\n    continue\n\n  hostList = hostList + '<li><a href=\"https://orbital.amp.cisco.com/nodes/' + host['node'] + '\" target=\"_blank\">' + host['hostinfo']['hostname'] + '</a></li>'\n  hostCount += 1\n\nticketText = '<h2>Orbital query results for IOC \"' + iocTitle + '\"</h3><ul>'\nticketText += '<li><strong>Description:</strong> ' + iocDescription + '</li>'\nticketText += '<li><a href=\"https://panacea.threatgrid.com/mask/samples/' + sampleId + '\" target=\"_blank\">View Secure Malware Analytics Sample</a></li>'\nticketText += '<li><a href=\"https://orbital.amp.cisco.com/job/' + orbitalJobId + '\" target=\"_blank\">View Orbital Job</a></li>'\nticketText += '<li><strong>Hosts with Results:</strong> ' + str(hostCount) + '</li></ul>'\n\nif hostCount > 0:\n  ticketText += '<br /><strong>Host List:</strong><br /><ul>' + hostList + '</ul>'\n",
				"script_arguments": [
				  "$activity.definition_activity_01UIQB33NHGR11u7E9K7Rsl7mY9beK3x9wi.input.source_array[@].orbital-results$",
				  "$activity.definition_activity_01UIQB33NHGR11u7E9K7Rsl7mY9beK3x9wi.input.source_array[@].sample$",
				  "$activity.definition_activity_01UIQB33NHGR11u7E9K7Rsl7mY9beK3x9wi.input.source_array[@].query-id$",
				  "$activity.definition_activity_01UIQB33NHGR11u7E9K7Rsl7mY9beK3x9wi.input.source_array[@].title$",
				  "$activity.definition_activity_01UIQB33NHGR11u7E9K7Rsl7mY9beK3x9wi.input.source_array[@].description$"
				],
				"script_queries": [
				  {
					"script_query": "ticketText",
					"script_query_name": "ticketText",
					"script_query_type": "string"
				  },
				  {
					"script_query": "hostCount",
					"script_query_name": "hostCount",
					"script_query_type": "integer"
				  }
				],
				"skip_execution": false
			  },
			  "object_type": "definition_activity"
			},
			{
			  "unique_name": "definition_activity_01UIQHMO5T56L4jmH6diME32ur7dtTIu3yu",
			  "name": "Set Variables",
			  "title": "Update local variables",
			  "type": "core.set_multiple_variables",
			  "base_type": "activity",
			  "properties": {
				"continue_on_failure": false,
				"display_name": "Update local variables",
				"skip_execution": false,
				"variables_to_update": [
				  {
					"variable_to_update": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC67AK2VL2GFSJhsXp3GS7Ur7E5N$",
					"variable_value_new": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC67AK2VL2GFSJhsXp3GS7Ur7E5N$\n$activity.definition_activity_01UIQBEAUCR8P5MqMzCvt33rFIfD8SSPKZV.output.script_queries.ticketText$"
				  },
				  {
					"variable_to_update": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UIQINEXX7GM1Urys9YrjyEta7S1OEjse0$",
					"variable_value_new": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UIQINEXX7GM1Urys9YrjyEta7S1OEjse0$+$activity.definition_activity_01UIQBEAUCR8P5MqMzCvt33rFIfD8SSPKZV.output.script_queries.hostCount$"
				  }
				]
			  },
			  "object_type": "definition_activity"
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01UEI5LH1D6WV2lMyEMHV944wfX6e1Ei3Qj",
		  "name": "Condition Block",
		  "title": "Were impacted hosts found?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Were impacted hosts found?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01UEI5LITBWBR0vUj0J4wqQ9P7Eh3oCI1cx",
			  "name": "Condition Branch",
			  "title": "Yes",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UIQINEXX7GM1Urys9YrjyEta7S1OEjse0$",
				  "operator": "gt",
				  "right_operand": 0
				},
				"continue_on_failure": false,
				"display_name": "Yes",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UEI5LYAXLMD056xGRqfmXp8Ek8sASJzkF",
				  "name": "Service Now - Create Incident",
				  "title": "Service Now - Create Incident",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Service Now - Create Incident",
					"input": {
					  "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "Hosts Found With Known Indicators of Compromise",
					  "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "Threat enrichment results for $workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$ hash \"$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv$\"",
					  "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 2,
					  "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 1,
					  "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "A SecureX orchestration workflow was executed to search for endpoints impacted by indicators of compromise (IOCs) related to $workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$ file hash \"$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv$\"\n\n[code]\n$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC67AK2VL2GFSJhsXp3GS7Ur7E5N$\n[/code]",
					  "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC5U57787PcVQwnmIEwijZ9YH7AJ$",
					  "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"runonalltargets": false,
						"selectedtargettypes": null,
						"targetgroupid": "",
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "ServiceNow"
							}
						  ]
						},
						"usecriteria": {
						  "choosetargetalgorithm": "",
						  "conditions": null
						}
					  }
					},
					"workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01UEOFQO93LKL5wSp6lR7I5idoliMUEQtKs",
				  "name": "Set Variables",
				  "title": "Set output variable",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set output variable",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.output.variable_workflow_01UEOGYCQN3FU6V6VAdFZx7rVBAMfm0O9pF$",
						"variable_value_new": "$activity.definition_activity_01UEI5LYAXLMD056xGRqfmXp8Ek8sASJzkF.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01UEI5M0QSJNK5BzI92z1LQmCCPBxtyqowr",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UIQINEXX7GM1Urys9YrjyEta7S1OEjse0$",
				  "operator": "eq",
				  "right_operand": 0
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01UIS6K87G8RX1yA3xMDNl3C5FUXjcL34Y7",
				  "name": "Service Now - Create Incident",
				  "title": "Service Now - Create Incident",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Service Now - Create Incident",
					"input": {
					  "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "No Hosts Found With Known Indicators of Compromise",
					  "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "Threat enrichment results for $workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$ hash \"$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv$\"",
					  "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 3,
					  "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 2,
					  "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "A SecureX orchestration workflow was executed to search for endpoints impacted by indicators of compromise (IOCs) related to $workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4MD10paHAZaosQd760hwhtIQ4y$ file hash \"$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.input.variable_workflow_01UEI5FVC4X3W4PjL3c5HiNnmH2cscVgQYv$\"\n\n[code]\n$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC67AK2VL2GFSJhsXp3GS7Ur7E5N$\n[/code]",
					  "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.local.variable_workflow_01UEI5FVC5U57787PcVQwnmIEwijZ9YH7AJ$",
					  "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "override_workflow_target_group_criteria": true,
					  "target_group": {
						"runonalltargets": false,
						"selectedtargettypes": null,
						"targetgroupid": "",
						"use_criteria": {
						  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
						  "conditions": [
							{
							  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
							  "operator": "eqi",
							  "right_operand": "ServiceNow"
							}
						  ]
						},
						"usecriteria": {
						  "choosetargetalgorithm": "",
						  "conditions": null
						}
					  }
					},
					"workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01UEOHQ5D7FIL2AqucLysFzRxel2sFyEkal",
				  "name": "Set Variables",
				  "title": "Set ouput variable",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set ouput variable",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01UEI5FUQIZYJ5orpHy0eh1HURoeWVPqW79.output.variable_workflow_01UEOGYCQN3FU6V6VAdFZx7rVBAMfm0O9pF$",
						"variable_value_new": "$activity.definition_activity_01UIS6K87G8RX1yA3xMDNl3C5FUXjcL34Y7.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		}
	  ],
	  "categories": [
		"category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
	  ]
	},
	"categories": {
	  "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
		"unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
		"name": "response",
		"title": "response",
		"type": "basic.category",
		"base_type": "category",
		"category_type": "custom",
		"object_type": "category"
	  }
	},
	"target_groups": {
	  "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
		"unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
		"name": "Default TargetGroup",
		"title": "Default TargetGroup",
		"type": "generic.target_group",
		"base_type": "target_group",
		"version": "1.0.0",
		"targets": [
		  {
			"data_target_type": "web-service.endpoint",
			"view_target_type": "web-service.endpoint",
			"include_all_targets": true
		  },
		  {
			"data_target_type": "email.smtp_endpoint",
			"view_target_type": "email.smtp_endpoint",
			"include_all_targets": true
		  }
		],
		"object_type": "target_group"
	  }
	},
	"atomic_workflows": [
	  "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
	  "definition_workflow_01PP75MV62DWN0raRr4mKAGgLjQhLnPVlFJ",
	  "definition_workflow_01PP74XXLH4JK5RznBkKvbBUhiBqVm0A35C",
	  "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
	  "definition_workflow_01PP7889QZ7LW3KC8jCPnHzO2hKwjeNWPMi"
	]
  }