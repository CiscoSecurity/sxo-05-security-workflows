{
	"workflow": {
	  "unique_name": "definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W",
	  "name": "0051 - Fortinet - FortiGate - Block URL, IP, or Domain",
	  "title": "0051 - Fortinet - FortiGate - Block URL, IP, or Domain",
	  "type": "generic.workflow",
	  "base_type": "workflow",
	  "variables": [
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Error Messages",
			"type": "datatype.string",
			"description": "Error messages from workflow execution. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Address Group Name",
			"type": "datatype.string",
			"description": "Name of the address group to add IP addresses and domains to",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Web Filter Name",
			"type": "datatype.string",
			"description": "Name of the web filter to add the URL filter list to",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.secure_string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Access Token",
			"type": "datatype.secure_string",
			"description": "Access token for the FortiGate API. This can be generated by creating a new REST API Admin under System > Administrators",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Address Name",
			"type": "datatype.string",
			"description": "Name of the address object to add to the address group. This will be populated automatically",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "local",
			"name": "Policy Name",
			"type": "datatype.string",
			"description": "Name of the firewall policy to add the blocked objects to",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "observable_value",
			"type": "datatype.string",
			"description": "The value of the observable pivoted on",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "observable_type",
			"type": "datatype.string",
			"description": "The type of observable pivoted on. Supported observables: url, ip, domain",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk",
		  "object_type": "variable_workflow"
		}
	  ],
	  "properties": {
		"atomic": {
		  "is_atomic": false
		},
		"delete_workflow_instance": false,
		"description": "This workflow blocks a URL, IP, or domain name in Fortinet FortiGate by adding them to a URL filter or address group and then updating a firewall policy. Supported observables: ip, url, domain\n\nNote: You may need to use a SecureX orchestration remote to communicate with FortiGate if it's on-premises. See: https://cs.co/SXO_remote\n\nTarget Group: Default TargetGroup\n\nTargets: Fortinet FortiGate, Microsoft Teams Webhook\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0051",
		"display_name": "0051 - Fortinet - FortiGate - Block URL, IP, or Domain",
		"runtime_user": {
		  "target_default": true
		},
		"target": {
		  "execute_on_target_group": true,
		  "target_group": {
			"target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
			"run_on_all_targets": false,
			"selected_target_types": [
			  "web-service.endpoint"
			],
			"use_criteria": {
			  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
			  "conditions": [
				{
				  "operator": "eqi",
				  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
				  "right_operand": "Fortinet FortiGate"
				}
			  ]
			}
		  }
		}
	  },
	  "object_type": "definition_workflow",
	  "actions": [
		{
		  "unique_name": "definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm",
		  "name": "Replace String",
		  "title": "Defang observable",
		  "type": "core.replacestring",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Defang observable",
			"input_string": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
			"replace_list": [
			  {
				"replaced_string": ".",
				"replacement_string": "[.]"
			  },
			  {
				"replaced_string": ":",
				"replacement_string": "[:]"
			  },
			  {
				"replaced_string": "http",
				"replacement_string": "hxxp"
			  }
			],
			"skip_execution": false
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4",
		  "name": "Execute Python Script",
		  "title": "Generate timestamps to create unique names",
		  "type": "python3.script",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": false,
			"display_name": "Generate timestamps to create unique names",
			"script": "import time\nfrom sys import argv\n\nprefix = \"SXo\"\n\naddress_name = f\"{prefix}-Address-{int(time.time())}\"\nurl_filter_name = f\"{prefix}-URLFilter-{int(time.time())}\"",
			"script_queries": [
			  {
				"script_query": "address_name",
				"script_query_name": "Address Name",
				"script_query_type": "string"
			  },
			  {
				"script_query": "url_filter_name",
				"script_query_name": "URL Filter Name",
				"script_query_type": "string"
			  }
			],
			"skip_execution": false
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01SP8B0RX254U39S1tyiTkj2YJU8gDfC4W4",
		  "name": "Condition Block",
		  "title": "Is the observable type supported?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Is the observable type supported?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01SP8B0SGIVL717jIUG2j44NzBiqtE1Ytwo",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": {
					"left_operand": {
					  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
					  "operator": "ne",
					  "right_operand": "ip"
					},
					"operator": "and",
					"right_operand": {
					  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
					  "operator": "ne",
					  "right_operand": "domain"
					}
				  },
				  "operator": "and",
				  "right_operand": {
					"left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
					"operator": "ne",
					"right_operand": "url"
				  }
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01SP8XT4AISIM6XPtaorOkFuIITKChMLfZ0",
				  "name": "Set Variables",
				  "title": "Add error to local variable",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Add error to local variable",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
						"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- The observable type \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$\" is not supported by this workflow"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01QXHJIZ26FHZ423VHybsJPWguBGG9M7qlA",
		  "name": "Condition Block",
		  "title": "Was a policy name provided?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was a policy name provided?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01SP8DG5686SU0rvP0I6WZXvuI3tH2O8cfY",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
				  "operator": "eq",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01SP8E8XRSMPQ0c4OqH4VNM4igcZCIGvEpb",
				  "name": "Set Variables",
				  "title": "Add error to local variable",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Add error to local variable",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
						"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- A policy name to update was not provided. You must configure the workflow with the name of a policy"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01QVND6FHZRGU6n8dHiDchlc7ZTfsYGLyqn",
		  "name": "Condition Block",
		  "title": "What are we blocking?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "What are we blocking?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01QVND6K0W0L66rdhyShNZEZPLZiJ1GB3vl",
			  "name": "Condition Branch",
			  "title": "URL (and no errors)",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": {
					"left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
					"operator": "eqi",
					"right_operand": "url"
				  },
				  "operator": "and",
				  "right_operand": {
					"left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
					"operator": "eq",
					"right_operand": ""
				  }
				},
				"continue_on_failure": false,
				"display_name": "URL (and no errors)",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QWIGB3XB54H5w0BTeaSAyUxRFbhI8DbGY",
				  "name": "Condition Block",
				  "title": "Was a web filter provided?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Was a web filter provided?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01QWIGB8M10EQ6zDFI3u3V3UYEwDjCRy9Qc",
					  "name": "Condition Branch",
					  "title": "Yes",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
						  "operator": "ne",
						  "right_operand": ""
						},
						"continue_on_failure": false,
						"display_name": "Yes",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK",
						  "name": "Fortinet - FortiGate - Get Web Filter by Name",
						  "title": "Fortinet - FortiGate - Get Web Filter by Name",
						  "type": "workflow.atomic_workflow",
						  "base_type": "subworkflow",
						  "properties": {
							"continue_on_failure": true,
							"display_name": "Fortinet - FortiGate - Get Web Filter by Name",
							"input": {
							  "variable_workflow_01QTSQI5AOIDP1UVa3tdeyCoxgF8uWnJoc4": "root",
							  "variable_workflow_01QTSQI5AOJY03c8ShvFxa6WGyMzlo9AxMo": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
							  "variable_workflow_01QTSQI5AOMZU4SbT4ozhFODZqKw3438YcU": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$"
							},
							"runtime_user": {
							  "target_default": true
							},
							"skip_execution": false,
							"target": {
							  "use_workflow_target_group": true
							},
							"workflow_id": "definition_workflow_01QTSQI5IY61E0eT05l4mbwyexR2rwtaSYl"
						  },
						  "object_type": "definition_activity"
						},
						{
						  "unique_name": "definition_activity_01QWIZ6AGSDJP5f3BJAiaoLl9GgGjOIgBNQ",
						  "name": "Condition Block",
						  "title": "Was the web filter found?",
						  "type": "logic.if_else",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Was the web filter found?",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "blocks": [
							{
							  "unique_name": "definition_activity_01QWIZ6EU4ZAW1XStWv7z7mPlMrOUn4ihdn",
							  "name": "Condition Branch",
							  "title": "Yes",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.succeeded$",
								  "operator": "eq",
								  "right_operand": true
								},
								"continue_on_failure": false,
								"display_name": "Yes",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw",
								  "name": "JSONPath Query",
								  "title": "Extract URL filter MKey",
								  "type": "corejava.jsonpathquery",
								  "base_type": "activity",
								  "properties": {
									"action_timeout": 180,
									"continue_on_failure": true,
									"display_name": "Extract URL filter MKey",
									"input_json": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.variable_workflow_01QTSQI5AOLGJ1ICiAZAvpDArlZk6MCG80B$",
									"jsonpath_queries": [
									  {
										"jsonpath_query": ".web.urlfilter-table",
										"jsonpath_query_name": "URL Filter Table",
										"jsonpath_query_type": "string"
									  }
									],
									"skip_execution": false
								  },
								  "object_type": "definition_activity"
								},
								{
								  "unique_name": "definition_activity_01QWJ2R4KUIKK1QVe1gdkN3Rau2Gw1jWgsv",
								  "name": "Condition Block",
								  "title": "Extraction sucessful?",
								  "type": "logic.if_else",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Extraction sucessful?",
									"skip_execution": false
								  },
								  "object_type": "definition_activity",
								  "blocks": [
									{
									  "unique_name": "definition_activity_01QWJ2R87BJEY4inzT6bv9EtJfZZSNwtzTk",
									  "name": "Condition Branch",
									  "title": "Yes",
									  "type": "logic.condition_block",
									  "base_type": "activity",
									  "properties": {
										"condition": {
										  "left_operand": {
											"left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.succeeded$",
											"operator": "eq",
											"right_operand": true
										  },
										  "operator": "and",
										  "right_operand": {
											"left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
											"operator": "ne",
											"right_operand": "0"
										  }
										},
										"continue_on_failure": false,
										"display_name": "Yes",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "actions": [
										{
										  "unique_name": "definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI",
										  "name": "Fortinet - FortiGate - Add URL to URL Filter",
										  "title": "Fortinet - FortiGate - Add URL to URL Filter",
										  "type": "workflow.atomic_workflow",
										  "base_type": "subworkflow",
										  "properties": {
											"continue_on_failure": true,
											"display_name": "Fortinet - FortiGate - Add URL to URL Filter",
											"input": {
											  "variable_workflow_01QTTUMDLM9KF4wEdIf0sL0kYyyPYNhFQI4": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
											  "variable_workflow_01QTTUMDLMGGS3YaRczu3vU0AVXA5kBFeQq": "root",
											  "variable_workflow_01QTTUMDLMHVN0vYPl8F6KsDolGDcG4OWKI": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
											  "variable_workflow_01QTTUMDLMJ2N4TMVxTti3VMk7rCcjjWHnc": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$"
											},
											"runtime_user": {
											  "target_default": true
											},
											"skip_execution": false,
											"target": {
											  "use_workflow_target_group": true
											},
											"workflow_id": "definition_workflow_01QTTUMDSUU0L6hykgyzvov9DIbC8YZyISv"
										  },
										  "object_type": "definition_activity"
										},
										{
										  "unique_name": "definition_activity_01RHZ9DRL7H6C78qFHTpVFSAFlbma77sIO2",
										  "name": "Condition Block",
										  "title": "Was the URL added?",
										  "type": "logic.if_else",
										  "base_type": "activity",
										  "properties": {
											"continue_on_failure": false,
											"display_name": "Was the URL added?",
											"skip_execution": false
										  },
										  "object_type": "definition_activity",
										  "blocks": [
											{
											  "unique_name": "definition_activity_01RHZ9DXXH97N4tfQhpCZ8qnIhXSukVqbxT",
											  "name": "Condition Branch",
											  "title": "No",
											  "type": "logic.condition_block",
											  "base_type": "activity",
											  "properties": {
												"condition": {
												  "left_operand": "$activity.definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI.output.succeeded$",
												  "operator": "eq",
												  "right_operand": false
												},
												"continue_on_failure": false,
												"display_name": "No",
												"skip_execution": false
											  },
											  "object_type": "definition_activity",
											  "actions": [
												{
												  "unique_name": "definition_activity_01SP8KAF22ISI1XGJmZSc6KJverIxVaJQfm",
												  "name": "Set Variables",
												  "title": "Add error to local variable",
												  "type": "core.set_multiple_variables",
												  "base_type": "activity",
												  "properties": {
													"continue_on_failure": false,
													"display_name": "Add error to local variable",
													"skip_execution": false,
													"variables_to_update": [
													  {
														"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
														"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to add the URL \"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" to the URL filter for the web filter \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$\""
													  }
													]
												  },
												  "object_type": "definition_activity"
												}
											  ]
											}
										  ]
										}
									  ]
									},
									{
									  "unique_name": "definition_activity_01QZM89Z2XBTK7bttaq590MQ6EbLhxFjDbT",
									  "name": "Condition Branch",
									  "title": "No",
									  "type": "logic.condition_block",
									  "base_type": "activity",
									  "properties": {
										"condition": {
										  "left_operand": {
											"left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.succeeded$",
											"operator": "eq",
											"right_operand": false
										  },
										  "operator": "or",
										  "right_operand": {
											"left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
											"operator": "eq",
											"right_operand": "0"
										  }
										},
										"continue_on_failure": false,
										"display_name": "No",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "actions": [
										{
										  "unique_name": "definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS",
										  "name": "Fortinet - FortiGate - Create URL Filter",
										  "title": "Fortinet - FortiGate - Create URL Filter",
										  "type": "workflow.atomic_workflow",
										  "base_type": "subworkflow",
										  "properties": {
											"continue_on_failure": true,
											"display_name": "Fortinet - FortiGate - Create URL Filter",
											"input": {
											  "variable_workflow_01QPJN9OQP82D67vM88JbpApXHH2HruIR44": "root",
											  "variable_workflow_01QPJN9OQP9XZ7FTwvYnhHFIa5MA8hboqMm": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
											  "variable_workflow_01QPJN9OQPBZ41CQ3IjmqYxxy7u0ltmYktz": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.URL Filter Name$",
											  "variable_workflow_01QPKTY4TNQW91qT9tlWoF4rRvNteWdZJHD": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$"
											},
											"runtime_user": {
											  "target_default": true
											},
											"skip_execution": false,
											"target": {
											  "use_workflow_target_group": true
											},
											"workflow_id": "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb"
										  },
										  "object_type": "definition_activity"
										},
										{
										  "unique_name": "definition_activity_01RHZE20V3IVU1O5dwqr7hwjRDUpwId8jIt",
										  "name": "Condition Block",
										  "title": "Was the URL filter created?",
										  "type": "logic.if_else",
										  "base_type": "activity",
										  "properties": {
											"continue_on_failure": false,
											"display_name": "Was the URL filter created?",
											"skip_execution": false
										  },
										  "object_type": "definition_activity",
										  "blocks": [
											{
											  "unique_name": "definition_activity_01RHZE24EO2FY2oHOl28QGFsOXgM0PXPKS0",
											  "name": "Condition Branch",
											  "title": "Yes",
											  "type": "logic.condition_block",
											  "base_type": "activity",
											  "properties": {
												"condition": {
												  "left_operand": "$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.succeeded$",
												  "operator": "eq",
												  "right_operand": true
												},
												"continue_on_failure": false,
												"display_name": "Yes",
												"skip_execution": false
											  },
											  "object_type": "definition_activity",
											  "actions": [
												{
												  "unique_name": "definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL",
												  "name": "Fortinet - FortiGate - Add URL Filter to Web Filter Profile",
												  "title": "Fortinet - FortiGate - Add URL Filter to Web Filter Profile",
												  "type": "workflow.atomic_workflow",
												  "base_type": "subworkflow",
												  "properties": {
													"continue_on_failure": true,
													"display_name": "Fortinet - FortiGate - Add URL Filter to Web Filter Profile",
													"input": {
													  "variable_workflow_01QDU1FYPFRCK220HdGrQT5E8q5rHtzPQn2": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
													  "variable_workflow_01QDU3BHG0FYX1YM6UUwzdhIYZFTDSLi8At": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
													  "variable_workflow_01QDUQU3ZBY9N7jboIgNoKcZdgUAQi1BtCD": "$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.variable_workflow_01QPJN9OQP3VF5AvZlRFEVyXuoNnuHRGrTI$"
													},
													"runtime_user": {
													  "target_default": true
													},
													"skip_execution": false,
													"target": {
													  "use_workflow_target_group": true
													},
													"workflow_id": "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6"
												  },
												  "object_type": "definition_activity"
												},
												{
												  "unique_name": "definition_activity_01RHZJVIZ46K27NpAS97mSK9jPtmVpqxzAO",
												  "name": "Condition Block",
												  "title": "Was the entry added to the web filter?",
												  "type": "logic.if_else",
												  "base_type": "activity",
												  "properties": {
													"continue_on_failure": false,
													"display_name": "Was the entry added to the web filter?",
													"skip_execution": false
												  },
												  "object_type": "definition_activity",
												  "blocks": [
													{
													  "unique_name": "definition_activity_01RHZJVMJ4I9C01eztKVym0Y0gQRy5pjjqP",
													  "name": "Condition Branch",
													  "title": "No",
													  "type": "logic.condition_block",
													  "base_type": "activity",
													  "properties": {
														"condition": {
														  "left_operand": "$activity.definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL.output.succeeded$",
														  "operator": "eq",
														  "right_operand": false
														},
														"continue_on_failure": false,
														"display_name": "No",
														"skip_execution": false
													  },
													  "object_type": "definition_activity",
													  "actions": [
														{
														  "unique_name": "definition_activity_01SP8M7V4HKD45E9sUOuQYKQw8ZcAy38Ti3",
														  "name": "Set Variables",
														  "title": "Add error to local variable",
														  "type": "core.set_multiple_variables",
														  "base_type": "activity",
														  "properties": {
															"continue_on_failure": false,
															"display_name": "Add error to local variable",
															"skip_execution": false,
															"variables_to_update": [
															  {
																"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
																"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to add the URL filter \"$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.URL Filter Name$\" to the web filter \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$\""
															  }
															]
														  },
														  "object_type": "definition_activity"
														}
													  ]
													}
												  ]
												}
											  ]
											},
											{
											  "unique_name": "definition_activity_01SP8LGRCQ4547Lq8D6mdHyQu2UAnTqANor",
											  "name": "Condition Branch",
											  "title": "No",
											  "type": "logic.condition_block",
											  "base_type": "activity",
											  "properties": {
												"condition": {
												  "left_operand": "$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.succeeded$",
												  "operator": "eq",
												  "right_operand": false
												},
												"continue_on_failure": false,
												"display_name": "No",
												"skip_execution": false
											  },
											  "object_type": "definition_activity",
											  "actions": [
												{
												  "unique_name": "definition_activity_01SP8LGRCQQIQ0WoffO8kSBcAHRhG8MUcdN",
												  "name": "Set Variables",
												  "title": "Add error to local variable",
												  "type": "core.set_multiple_variables",
												  "base_type": "activity",
												  "properties": {
													"continue_on_failure": false,
													"display_name": "Add error to local variable",
													"skip_execution": false,
													"variables_to_update": [
													  {
														"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
														"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to create the URL filter \"$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.URL Filter Name$\""
													  }
													]
												  },
												  "object_type": "definition_activity"
												}
											  ]
											}
										  ]
										}
									  ]
									}
								  ]
								}
							  ]
							},
							{
							  "unique_name": "definition_activity_01RHQ456D2SVT4CjPHB2TJTweTfiKIMLs8j",
							  "name": "Condition Branch",
							  "title": "No",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.succeeded$",
								  "operator": "eq",
								  "right_operand": false
								},
								"continue_on_failure": false,
								"display_name": "No",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01SP8J9ZB8BDG4lif5fXPpSUVjvJIBnNAEh",
								  "name": "Set Variables",
								  "title": "Add error to local variable",
								  "type": "core.set_multiple_variables",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Add error to local variable",
									"skip_execution": false,
									"variables_to_update": [
									  {
										"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
										"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- The web filter \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$\" could not be found"
									  }
									]
								  },
								  "object_type": "definition_activity"
								}
							  ]
							}
						  ]
						}
					  ]
					},
					{
					  "unique_name": "definition_activity_01SDZGEPDYZEB0lmP3qBQ0Rjk5wE5WarjuK",
					  "name": "Condition Branch",
					  "title": "No",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
						  "operator": "eq",
						  "right_operand": ""
						},
						"continue_on_failure": false,
						"display_name": "No",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01SP8IHIZN0R54VEQBbkzKtFyP38lMF2CIk",
						  "name": "Set Variables",
						  "title": "Add error to local variable",
						  "type": "core.set_multiple_variables",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Add error to local variable",
							"skip_execution": false,
							"variables_to_update": [
							  {
								"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
								"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- A web filter was not provided. You must configure the workflow with the name of a web filter"
							  }
							]
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				},
				{
				  "unique_name": "definition_activity_01QYE7616RGZY1VsDZhccONoTGbEOhoLYd4",
				  "name": "Set Variables",
				  "title": "Clear extra inputs if present",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"description": "Clear Address Group if it was set as it not needed",
					"display_name": "Clear extra inputs if present",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
						"variable_value_new": ""
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01QVND6JB8RMQ12hwBW8jieIaneO0tmO3OA",
			  "name": "Condition Branch",
			  "title": "IP Address or Domain (and no errors)",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": {
					"left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
					"operator": "mregex",
					"right_operand": "ip|domain"
				  },
				  "operator": "and",
				  "right_operand": {
					"left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
					"operator": "eq",
					"right_operand": ""
				  }
				},
				"continue_on_failure": false,
				"display_name": "IP Address or Domain (and no errors)",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QXESWS5MMM34TLZgndSuAWl7JX9q2ZOC8",
				  "name": "Condition Block",
				  "title": "Was an address group provided?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Was an address group provided?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01QXESWW1NC9L4wwIjB6YF7n6aFq4w1VHeS",
					  "name": "Condition Branch",
					  "title": "Yes",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
						  "operator": "ne",
						  "right_operand": ""
						},
						"continue_on_failure": false,
						"display_name": "Yes",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7",
						  "name": "Fortinet - FortiGate - Search for Address by Value",
						  "title": "Fortinet - FortiGate - Search for Address by Value",
						  "type": "workflow.atomic_workflow",
						  "base_type": "subworkflow",
						  "properties": {
							"continue_on_failure": true,
							"display_name": "Fortinet - FortiGate - Search for Address by Value",
							"input": {
							  "variable_workflow_01QJMY7E7Z0IB2Ed7caVA90mExOvR277l2a": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
							  "variable_workflow_01QJMY7E7Z34Y31xJWhl8psuGJq9nSwAGQA": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
							  "variable_workflow_01QJNP94KKPAD0OwFo8IB6b8carKE0VVqpl": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
							  "variable_workflow_01QJQEPSZM3BE1GcmTTNciS5QqSczLq11G7": "root"
							},
							"runtime_user": {
							  "target_default": true
							},
							"skip_execution": false,
							"target": {
							  "use_workflow_target_group": true
							},
							"workflow_id": "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05"
						  },
						  "object_type": "definition_activity"
						},
						{
						  "unique_name": "definition_activity_01QXEL2V5S0J54LwkxxJZhMznMjL8qMr98L",
						  "name": "Condition Block",
						  "title": "Was the address found?",
						  "type": "logic.if_else",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Was the address found?",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "blocks": [
							{
							  "unique_name": "definition_activity_01QXEL30NNUL434Tma8iM7ebL42W0ytKMsL",
							  "name": "Condition Branch",
							  "title": "Yes",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.succeeded$",
								  "operator": "eq",
								  "right_operand": true
								},
								"continue_on_failure": false,
								"display_name": "Yes",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01QXEX9MZ18DV0TovkJV6wIHoBtmhoOI4EI",
								  "name": "Set Variables",
								  "title": "Update the local address variable",
								  "type": "core.set_multiple_variables",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Update the local address variable",
									"skip_execution": false,
									"variables_to_update": [
									  {
										"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
										"variable_value_new": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$"
									  }
									]
								  },
								  "object_type": "definition_activity"
								}
							  ]
							},
							{
							  "unique_name": "definition_activity_01QXEWVOTIA3V4j1xAh7og3kFTXjhadYteM",
							  "name": "Condition Branch",
							  "title": "No",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.succeeded$",
								  "operator": "eq",
								  "right_operand": false
								},
								"continue_on_failure": false,
								"display_name": "No",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic",
								  "name": "Fortinet - FortiGate - Create Address",
								  "title": "Fortinet - FortiGate - Create Address",
								  "type": "workflow.atomic_workflow",
								  "base_type": "subworkflow",
								  "properties": {
									"continue_on_failure": true,
									"display_name": "Fortinet - FortiGate - Create Address",
									"input": {
									  "variable_workflow_01Q8Q3G8HFBBV4bCgPNxr8tNZAdaRIhTchP": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
									  "variable_workflow_01Q8QAOJCFJFX2aDEaoWMl8JIaBJeUoywL6": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
									  "variable_workflow_01QCRJI0NZEMB0Pm8zeCVQJSI6QGrjOyakn": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
									  "variable_workflow_01QYDQME2SLKW7lJPgDsK0aMFMMODvnejqs": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Address Name$",
									  "variable_workflow_01QYE15IBF6Q74dRiYe9StNFoRQ1cIEul1M": "root"
									},
									"runtime_user": {
									  "target_default": true
									},
									"skip_execution": false,
									"target": {
									  "use_workflow_target_group": true
									},
									"workflow_id": "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB"
								  },
								  "object_type": "definition_activity"
								},
								{
								  "unique_name": "definition_activity_01RHYPCG7PY3J2otR1hFvT63KliXca2sSof",
								  "name": "Condition Block",
								  "title": "Was the address created?",
								  "type": "logic.if_else",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Was the address created?",
									"skip_execution": false
								  },
								  "object_type": "definition_activity",
								  "blocks": [
									{
									  "unique_name": "definition_activity_01RHYPCMVF7EF5aKOOWYGwPjMWp5TsMD9EV",
									  "name": "Condition Branch",
									  "title": "Yes",
									  "type": "logic.condition_block",
									  "base_type": "activity",
									  "properties": {
										"condition": {
										  "left_operand": "$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.succeeded$",
										  "operator": "eq",
										  "right_operand": true
										},
										"continue_on_failure": false,
										"display_name": "Yes",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "actions": [
										{
										  "unique_name": "definition_activity_01RHOTSDSCNLE5JTIVnMUgktNV95FBfModC",
										  "name": "Set Variables",
										  "title": "Update the local address variable",
										  "type": "core.set_multiple_variables",
										  "base_type": "activity",
										  "properties": {
											"continue_on_failure": false,
											"display_name": "Update the local address variable",
											"skip_execution": false,
											"variables_to_update": [
											  {
												"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
												"variable_value_new": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Address Name$"
											  }
											]
										  },
										  "object_type": "definition_activity"
										}
									  ]
									},
									{
									  "unique_name": "definition_activity_01SP8P2I8H0S63n7rCw9q38l6SPy0IRj54Y",
									  "name": "Condition Branch",
									  "title": "No",
									  "type": "logic.condition_block",
									  "base_type": "activity",
									  "properties": {
										"condition": {
										  "left_operand": "$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.succeeded$",
										  "operator": "eq",
										  "right_operand": false
										},
										"continue_on_failure": false,
										"display_name": "No",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "actions": [
										{
										  "unique_name": "definition_activity_01SP8POH14P7P6QWCsamyhjS49dw8Rab9xw",
										  "name": "Set Variables",
										  "title": "Add error to local variable",
										  "type": "core.set_multiple_variables",
										  "base_type": "activity",
										  "properties": {
											"continue_on_failure": false,
											"display_name": "Add error to local variable",
											"skip_execution": false,
											"variables_to_update": [
											  {
												"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
												"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to create a new address object \"$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Address Name$\""
											  }
											]
										  },
										  "object_type": "definition_activity"
										}
									  ]
									}
								  ]
								}
							  ]
							}
						  ]
						},
						{
						  "unique_name": "definition_activity_01SP8QM9FRUTV3Rt0Uz2sCE3PXHPcaxF2ye",
						  "name": "Condition Block",
						  "title": "Was there an address object?",
						  "type": "logic.if_else",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Was there an address object?",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "blocks": [
							{
							  "unique_name": "definition_activity_01SP8QM9P6Z6O7MrFzEnJ2I524TKolPuehz",
							  "name": "Condition Branch",
							  "title": "Yes",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
								  "operator": "ne",
								  "right_operand": ""
								},
								"continue_on_failure": false,
								"display_name": "Yes",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0",
								  "name": "Fortinet - FortiGate - Add Address to Address Group",
								  "title": "Fortinet - FortiGate - Add Address to Address Group",
								  "type": "workflow.atomic_workflow",
								  "base_type": "subworkflow",
								  "properties": {
									"continue_on_failure": true,
									"display_name": "Fortinet - FortiGate - Add Address to Address Group",
									"input": {
									  "variable_workflow_01QKJSE0EFJ2W31BeDVMJrs1CFizp43DKQr": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
									  "variable_workflow_01QKJSE0EFMPQ4ZousJqguiEM0z7cVkN0z4": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
									  "variable_workflow_01QKJSE0EFQL61FRB1WLGyXTIRetH2ohsE4": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
									  "variable_workflow_01QKM1ZUG7X301PG75jm0VEKR1SrG6holTq": "root"
									},
									"runtime_user": {
									  "target_default": true
									},
									"skip_execution": false,
									"target": {
									  "use_workflow_target_group": true
									},
									"workflow_id": "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV"
								  },
								  "object_type": "definition_activity"
								},
								{
								  "unique_name": "definition_activity_01RHPVTIZADMW2fDt3QN3tT6TPh9bDHNIg9",
								  "name": "Condition Block",
								  "title": "Was the address added?",
								  "type": "logic.if_else",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Was the address added?",
									"skip_execution": false
								  },
								  "object_type": "definition_activity",
								  "blocks": [
									{
									  "unique_name": "definition_activity_01RHPVTMOKDM61T9L6CTYiPZEkh0tSAI2QO",
									  "name": "Condition Branch",
									  "title": "No",
									  "type": "logic.condition_block",
									  "base_type": "activity",
									  "properties": {
										"condition": {
										  "left_operand": "$activity.definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0.output.succeeded$",
										  "operator": "eq",
										  "right_operand": false
										},
										"continue_on_failure": false,
										"display_name": "No",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "actions": [
										{
										  "unique_name": "definition_activity_01SP8RS0AAK4H5SGSJ3rRx6L7vDssYxh6Z9",
										  "name": "Set Variables",
										  "title": "Add error to local variable",
										  "type": "core.set_multiple_variables",
										  "base_type": "activity",
										  "properties": {
											"continue_on_failure": false,
											"display_name": "Add error to local variable",
											"skip_execution": false,
											"variables_to_update": [
											  {
												"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
												"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to add address object \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$\" to address group \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$\""
											  }
											]
										  },
										  "object_type": "definition_activity"
										}
									  ]
									}
								  ]
								}
							  ]
							},
							{
							  "unique_name": "definition_activity_01SP8QM9YYJCU0FYMqVJIpqSLaebnHyICdN",
							  "name": "Condition Branch",
							  "title": "No",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
								  "operator": "eq",
								  "right_operand": ""
								},
								"continue_on_failure": false,
								"display_name": "No",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01SP8RA0Y8LCL66AvgDvEsC7f1V01ksK8yB",
								  "name": "Set Variables",
								  "title": "Add error to local variable",
								  "type": "core.set_multiple_variables",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Add error to local variable",
									"skip_execution": false,
									"variables_to_update": [
									  {
										"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
										"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- An address object was either not found or failed to be created (so it can't be added to the address group)"
									  }
									]
								  },
								  "object_type": "definition_activity"
								}
							  ]
							}
						  ]
						}
					  ]
					},
					{
					  "unique_name": "definition_activity_01SDZ7ID8R2OZ6B56AMxLwUwHFARq8GN78W",
					  "name": "Condition Branch",
					  "title": "No",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
						  "operator": "eq",
						  "right_operand": ""
						},
						"continue_on_failure": false,
						"display_name": "No",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01SP8NI11QTGM2G8ojIeB75Kyb7whO9bmi0",
						  "name": "Set Variables",
						  "title": "Add error to local variable",
						  "type": "core.set_multiple_variables",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Add error to local variable",
							"skip_execution": false,
							"variables_to_update": [
							  {
								"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
								"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- An address group to add addresses to was not provided. You must configure the workflow with the name of an address group"
							  }
							]
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				},
				{
				  "unique_name": "definition_activity_01QYE5WFSJBFT3hcwqqCKWmVU78Xlx38dIu",
				  "name": "Set Variables",
				  "title": "Clear extra inputs if present",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Clear extra inputs if present",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
						"variable_value_new": ""
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01SP8FS4YNLN86m7q7BTt4UFeGhjXBJZtou",
		  "name": "Condition Block",
		  "title": "Have there been errors so far?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Have there been errors so far?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01SP8FS5BL25W3CIO3Gas748Pbm63m5GbEv",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
				  "operator": "eq",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ",
				  "name": "Fortinet - FortiGate - Get Policy by Name",
				  "title": "Fortinet - FortiGate - Get Policy by Name",
				  "type": "workflow.atomic_workflow",
				  "base_type": "subworkflow",
				  "properties": {
					"continue_on_failure": true,
					"display_name": "Fortinet - FortiGate - Get Policy by Name",
					"input": {
					  "variable_workflow_01QIUK02DI1IF4L5JSfJ1dW6v53vUb5sKrd": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
					  "variable_workflow_01QIUK02DI2PR41Jf3FNKjTlsvabn7pRwAJ": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
					  "variable_workflow_01QZ7S20AIWUG4syV8kHuL1uInjCRVDLDJs": "root"
					},
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "use_workflow_target_group": true
					},
					"workflow_id": "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf"
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01QXHU2KX5ZBA6zhgKIkyPjsRilD3A7D5Xv",
				  "name": "Condition Block",
				  "title": "Was a policy found?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Was a policy found?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01QXHU2RE0NWY7ffYrem1923BGy0UOcZpkm",
					  "name": "Condition Branch",
					  "title": "Yes",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.succeeded$",
						  "operator": "eq",
						  "right_operand": true
						},
						"continue_on_failure": false,
						"display_name": "Yes",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01SP98LUH0KDK5dPIWuNmGp2SZusabWurKb",
						  "name": "Execute Python Script",
						  "title": "Generate policy action",
						  "type": "python3.script",
						  "base_type": "activity",
						  "properties": {
							"action_timeout": 180,
							"continue_on_failure": false,
							"display_name": "Generate policy action",
							"script": "from sys import argv\nobservable_type = argv[1]\naction = \"deny\"\nif observable_type == \"url\":\n   action = \"accept\"",
							"script_arguments": [
							  "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$"
							],
							"script_queries": [
							  {
								"script_query": "action",
								"script_query_name": "action",
								"script_query_type": "string"
							  }
							],
							"skip_execution": false
						  },
						  "object_type": "definition_activity"
						},
						{
						  "unique_name": "definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA",
						  "name": "Fortinet - FortiGate - Update Firewall Policy",
						  "title": "Fortinet - FortiGate - Update Firewall Policy",
						  "type": "workflow.atomic_workflow",
						  "base_type": "subworkflow",
						  "properties": {
							"continue_on_failure": true,
							"display_name": "Fortinet - FortiGate - Update Firewall Policy",
							"input": {
							  "variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.variable_workflow_01QIUK02DI7JL4sgSk2xE8cVHVvCv30Hgas$",
							  "variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.variable_workflow_01QIUK02DHUFV5m3AAJ9VSfPBXcC36ZMSTB$",
							  "variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq": "",
							  "variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
							  "variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK": "root",
							  "variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
							  "variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
							  "variable_workflow_01SOKPX0NFW0L464aL9t0vEyBowlnCQjman": "$activity.definition_activity_01SP98LUH0KDK5dPIWuNmGp2SZusabWurKb.output.script_queries.action$",
							  "variable_workflow_01SOKQ5CWNBD70J1ywhGt6lYQlQmK7KVnDX": ""
							},
							"runtime_user": {
							  "target_default": true
							},
							"skip_execution": false,
							"target": {
							  "use_workflow_target_group": true
							},
							"workflow_id": "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO"
						  },
						  "object_type": "definition_activity"
						},
						{
						  "unique_name": "definition_activity_01RHWB6TEOH2N6jsJFjjv6zUL6epYlktdgw",
						  "name": "Condition Block",
						  "title": "Was the firewall policy updated?",
						  "type": "logic.if_else",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Was the firewall policy updated?",
							"skip_execution": false
						  },
						  "object_type": "definition_activity",
						  "blocks": [
							{
							  "unique_name": "definition_activity_01SP8TF85S3N07KgzwzADz7Cp1uLR9wPP9z",
							  "name": "Condition Branch",
							  "title": "Yes",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.succeeded$",
								  "operator": "eq",
								  "right_operand": true
								},
								"continue_on_failure": false,
								"display_name": "Yes",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f",
								  "name": "Fortinet - FortiGate - Move Policy To Top of Policy List",
								  "title": "Fortinet - FortiGate - Move Policy To Top of Policy List",
								  "type": "workflow.atomic_workflow",
								  "base_type": "subworkflow",
								  "properties": {
									"continue_on_failure": true,
									"display_name": "Fortinet - FortiGate - Move Policy To Top of Policy List",
									"input": {
									  "variable_workflow_01RL0ZYDSSTEA1H5YdUxbC5WZf3PGU31zBk": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
									  "variable_workflow_01RL0ZYDST2F13RUNFmIaNqBBtT4MtsXvlX": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
									  "variable_workflow_01RL0ZYDST3YY33jZNgUsLBKnkFoRa7Vgcs": "root"
									},
									"runtime_user": {
									  "target_default": true
									},
									"skip_execution": false,
									"target": {
									  "use_workflow_target_group": true
									},
									"workflow_id": "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX"
								  },
								  "object_type": "definition_activity"
								},
								{
								  "unique_name": "definition_activity_01RQZBGJDELEO7KQSv8NcaPr60gWqAPN50k",
								  "name": "Condition Block",
								  "title": "Was the policy reordering successful?",
								  "type": "logic.if_else",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Was the policy reordering successful?",
									"skip_execution": false
								  },
								  "object_type": "definition_activity",
								  "blocks": [
									{
									  "unique_name": "definition_activity_01RQZBGJDF5YT6CkZbn0ffYd6n43p7zmlEi",
									  "name": "Condition Branch",
									  "title": "No",
									  "type": "logic.condition_block",
									  "base_type": "activity",
									  "properties": {
										"condition": {
										  "left_operand": "$activity.definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f.output.succeeded$",
										  "operator": "eq",
										  "right_operand": false
										},
										"continue_on_failure": false,
										"display_name": "No",
										"skip_execution": false
									  },
									  "object_type": "definition_activity",
									  "actions": [
										{
										  "unique_name": "definition_activity_01SP8U5UYJ6A452JaqDZnSMNcJ2uARdBRqf",
										  "name": "Set Variables",
										  "title": "Add error to local variable",
										  "type": "core.set_multiple_variables",
										  "base_type": "activity",
										  "properties": {
											"continue_on_failure": false,
											"display_name": "Add error to local variable",
											"skip_execution": false,
											"variables_to_update": [
											  {
												"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
												"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to move the updated firewall policy to the top of the policy list"
											  }
											]
										  },
										  "object_type": "definition_activity"
										}
									  ]
									}
								  ]
								}
							  ]
							},
							{
							  "unique_name": "definition_activity_01RHWB6X72SYM28PcD2AKPcnju9sMUegA70",
							  "name": "Condition Branch",
							  "title": "No",
							  "type": "logic.condition_block",
							  "base_type": "activity",
							  "properties": {
								"condition": {
								  "left_operand": "$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.succeeded$",
								  "operator": "eq",
								  "right_operand": false
								},
								"continue_on_failure": false,
								"display_name": "No",
								"skip_execution": false
							  },
							  "object_type": "definition_activity",
							  "actions": [
								{
								  "unique_name": "definition_activity_01SP8U3X9UKTP2NrMlYn8puMiy3TQMJhLkc",
								  "name": "Set Variables",
								  "title": "Add error to local variable",
								  "type": "core.set_multiple_variables",
								  "base_type": "activity",
								  "properties": {
									"continue_on_failure": false,
									"display_name": "Add error to local variable",
									"skip_execution": false,
									"variables_to_update": [
									  {
										"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
										"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to update the firewall policy \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$\""
									  }
									]
								  },
								  "object_type": "definition_activity"
								}
							  ]
							}
						  ]
						}
					  ]
					},
					{
					  "unique_name": "definition_activity_01RHUY007S6VH5IUz6MrOkPcChdUtTJiZLA",
					  "name": "Condition Branch",
					  "title": "No",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.succeeded$",
						  "operator": "eq",
						  "right_operand": false
						},
						"continue_on_failure": false,
						"display_name": "No",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01SP8SRB6QZTU1NaZBALT6jmB2IokP7vp4N",
						  "name": "Set Variables",
						  "title": "Add error to local variable",
						  "type": "core.set_multiple_variables",
						  "base_type": "activity",
						  "properties": {
							"continue_on_failure": false,
							"display_name": "Add error to local variable",
							"skip_execution": false,
							"variables_to_update": [
							  {
								"variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$",
								"variable_value_new": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$\n- Failed to fetch the firewall policy \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$\""
							  }
							]
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01QYED09JUF4607UQWwkS6Sr9Z42wQk3eSy",
		  "name": "Execute Python Script",
		  "title": "Prepare summary message",
		  "type": "python3.script",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": false,
			"display_name": "Prepare summary message",
			"script": "import sys\n\nobservable_type = sys.argv[1]\nobservable_value = sys.argv[2]\naddressName = sys.argv[3]\naddressGroupName = sys.argv[4]\nwebFilterName = sys.argv[5]\npolicyName = sys.argv[6]\nerrors = sys.argv[7]\n\ndelimeter = ('-' * 20)\n\nresult = 'successfully' if len(errors) == 0 else 'unsuccessfully'\nmessageBody = [ f'## {observable_type} \"{observable_value}\" blocked in FortiGate {result}' ]\n\nif observable_type == \"url\":\n    messageBody += [ f\"**Web Filter Name**: {webFilterName}\" ]\nelse:\n    messageBody += [ f\"**Address Name**: {addressName}\", f\"**Address Group Name**: {addressGroupName}\" ]\n\nmessageBody += [ f\"**Policy Name**: {policyName}\" ]\n\nif len(errors) > 0:\n    messageBody += [ delimeter, '**There were errors during workflow execution:**' ] + errors.split('\\n')\n\nteamsMessage = '\\n'.join(messageBody)",
			"script_arguments": [
			  "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
			  "$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$",
			  "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
			  "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
			  "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
			  "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
			  "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01SP8EY1RES7Z6maNBYGRY5dQiWgoe5VMXJ$"
			],
			"script_queries": [
			  {
				"script_query": "teamsMessage",
				"script_query_name": "teamsMessage",
				"script_query_type": "string"
			  }
			],
			"skip_execution": false
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01QZLP0NPIBNF4hqpFbSW9ThQ99eStbUnHU",
		  "name": "Microsoft Teams - Post Message via Webhook",
		  "title": "Microsoft Teams - Post Message via Webhook",
		  "type": "workflow.atomic_workflow",
		  "base_type": "subworkflow",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Microsoft Teams - Post Message via Webhook",
			"input": {
			  "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "Message from Fortinet - FortiGate - Block URL, IP, or Domain",
			  "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "$activity.definition_activity_01QYED09JUF4607UQWwkS6Sr9Z42wQk3eSy.output.script_queries.teamsMessage$",
			  "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
			},
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "override_workflow_target_group_criteria": true,
			  "target_group": {
				"run_on_all_targets": false,
				"use_criteria": {
				  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
				  "conditions": [
					{
					  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
					  "operator": "eqi",
					  "right_operand": "Microsoft Teams Webhook"
					}
				  ]
				}
			  }
			},
			"workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
		  },
		  "object_type": "definition_activity"
		}
	  ],
	  "categories": [
		"category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
	  ]
	},
	"categories": {
	  "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
		"unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
		"name": "response",
		"title": "response",
		"type": "basic.category",
		"base_type": "category",
		"category_type": "custom",
		"object_type": "category"
	  }
	},
	"target_groups": {
	  "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
		"unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
		"name": "Default TargetGroup",
		"title": "Default TargetGroup",
		"type": "generic.target_group",
		"base_type": "target_group",
		"version": "1.0.0",
		"targets": [
		  {
			"data_target_type": "web-service.endpoint",
			"view_target_type": "web-service.endpoint",
			"include_all_targets": true
		  },
		  {
			"data_target_type": "email.smtp_endpoint",
			"view_target_type": "email.smtp_endpoint",
			"include_all_targets": true
		  }
		],
		"object_type": "target_group"
	  }
	},
	"atomic_workflows": [
	  "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV",
	  "definition_workflow_01QTTUMDSUU0L6hykgyzvov9DIbC8YZyISv",
	  "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05",
	  "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO",
	  "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX",
	  "definition_workflow_01QTSQI5IY61E0eT05l4mbwyexR2rwtaSYl",
	  "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf",
	  "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6",
	  "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB",
	  "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr",
	  "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb"
	]
  }