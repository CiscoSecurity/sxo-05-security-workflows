{
  "workflow": {
    "unique_name": "definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa",
    "name": "0011 - Talos - SolarWinds Investigation",
    "title": "0011 - Talos - SolarWinds Investigation",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Sightings",
          "type": "datatype.string",
          "description": "Placeholder for a list of sightings from your Threat Response modules. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7N4E44QQrR7T7ZiBrpIxLXuea3N",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Slack Token",
          "type": "datatype.secure_string",
          "description": "The API token to use when accessing Slack. Information about creating a Slack app can be found here: https://api.slack.com/authentication/basics",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7NHC54z1GyNQIsr2wJtZSSy1aY5",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Slack Channel",
          "type": "datatype.string",
          "description": "The name of the Slack channel to post messages to. If you don't want to use Slack, leave this blank",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7NFA53LeWYM0XIDGYR88m9OCoIM",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "someone@company.com",
          "scope": "local",
          "name": "Email Addresses to Notify",
          "type": "datatype.string",
          "description": "A list of email addresses to notify when the workflow conducts an investigation and sightings are found. These should be either comma separated or each on their own line",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7N6LJ4D2fvk8fqFR4Ufgdvqp3c3",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Secure Endpoint Module ID",
          "type": "datatype.string",
          "description": "Placeholder for the instance ID of your Secure Endpoint\n module from Threat Response. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7NGBB54aYNtHzu1k3WgZbA48VAJ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Non-Clean Observables",
          "type": "datatype.string",
          "description": "A JSON-formatted list of observables that have a disposition of unknown, suspicious, or malicious. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7N0ZQ5yh05yjpFd1QJPphky11Tc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the Threat Response environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "SecureX Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the SecureX environment being used. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Targets",
          "type": "datatype.string",
          "description": "Placeholder for a list of targets from your Threat Response module sightings. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7NB162pOsKvh0MYscpUAdDCmsAu",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Remediation Text",
          "type": "datatype.string",
          "description": "Placeholder used to assemble information about the remediation actions taken. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Umbrella Module ID",
          "type": "datatype.string",
          "description": "Placeholder for the instance ID of your Umbrella module from Threat Response. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7MWX051majkqz4KodFSdK8BRJNZ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "mycompany.service-now.com",
          "scope": "local",
          "name": "ServiceNow Instance URL",
          "type": "datatype.string",
          "description": "The URL of your ServiceNow instance. For example: mycompany.service-now.com",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7N8QT7PLkRLBev75d0XTL3nIW9o",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7N9U008BtkYC6UOqkypo4MfD4IG",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://blog.talosintelligence.com/2020/12/solarwinds-supplychain-coverage.html",
          "scope": "local",
          "name": "Blog Post URL",
          "type": "datatype.string",
          "description": "The URL of the blog post to investigate. In this workflow, we hard-code this to the post about the SolarWinds supply chain attack",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LQA3KM7NC2U361aXK4jC2A22tI9NKsLN5",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow uses a Talos blog post about the SolarWinds supply chain attack as a source of intelligence. Using observables extracted from the blog post, it conducts an investigation and looks for sightings within your environment. If there are sightings, actions are taken including creating a Cisco SecureX incident and casebook, creating a ServiceNow incident, sending a Webex message, sending a message on Slack, and sending an email. The workflow also supports automated remediation (with approval). If the resulting approval task is approved, unknown or suspicious file hashes and domains are blocked using Cisco Secure Endpoint and Umbrella respectively. If there are any target endpoints, Cisco Orbital is used to take a forensic snapshot and Secure Endpoint is used to enable host isolation.\n\nNote: This workflow has been updated to support SecureX Token account keys. See the workflow documentation for more information.\n\nDocumentation: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0011",
      "display_name": "0011 - Talos - SolarWinds Investigation",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint",
            "email.smtp_endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01LQA3LEM00UR56rGwy7hktOpRYmFvARTiW",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch global variables",
          "skip_execution": true
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA3LLNJRTF20t7gBOgVv4piZEmFMZPwi",
            "name": "Set Variables",
            "title": "Fetch global variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch global variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N9U008BtkYC6UOqkypo4MfD4IG$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NHC54z1GyNQIsr2wJtZSSy1aY5$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA3LVOAUD626uw0yfl3IpqxuV9LtIJev",
        "name": "Condition Block",
        "title": "Set the environment URL",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set the environment URL",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LQA3M23IU2F2yidm7otUfSVEx2EoU4QMy",
            "name": "Condition Branch",
            "title": "PROD-NAM",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-nam"
              },
              "continue_on_failure": false,
              "display_name": "PROD-NAM",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA3MAK0Y6H1D7VMi0SZ9qD0lEGpAQccE",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$",
                      "variable_value_new": "securex-ao.us.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$",
                      "variable_value_new": "visibility.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQA3MHP475F0uJUucDVDAob1iHorXYWpk",
            "name": "Condition Branch",
            "title": "PROD-EU",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-eu"
              },
              "continue_on_failure": false,
              "display_name": "PROD-EU",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA3MOBT0G91LsiLEKKF6qVxAPR6P72NY",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$",
                      "variable_value_new": "securex-ao.eu.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$",
                      "variable_value_new": "visibility.eu.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQA3MV5U1RZ24K9qb5g9KiAhpT1SMx4EL",
            "name": "Condition Branch",
            "title": "PROD-APJC",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-apjc"
              },
              "continue_on_failure": false,
              "display_name": "PROD-APJC",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA3N1CXA8C7TJvDawhe1wmMxOP5V8SVV",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$",
                      "variable_value_new": "securex-ao.apjc.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$",
                      "variable_value_new": "visibility.apjc.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA3NON4AVX4AAlcbQe0BhiYyjKVGQ09p",
        "name": "Group",
        "title": "Fetch and process blog post",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch and process blog post",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9",
            "name": "Execute Python Script",
            "title": "Fetch and clean blog post",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch and clean blog post",
              "script": "import sys,re,requests\n\n# Get the blog post URL from the script input\nblogUrl = sys.argv[1]\n\n# Request the content of the blog post\nblogRequest = requests.get(blogUrl, headers={ 'User-Agent': 'SecureX/definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa' })\n\n# Make sure the request was successful\nif not blogRequest.status_code == 200:\n    sys.exit(\"Unable to fetch blog content. HTTP code \" + blogRequest.status_code)\n\n# Extract the HTML of the blog post\nblogHtml = blogRequest.text\n\n# Default the blog post to being unavailable in case we can't find it\npostTitle = \"Post Title Unavailable\"\n\n# Attempt to extract the blog post title from the HTML\ntitleMatches = re.search(r'\u003ctitle\u003e([^\u003c]+)\u003c\\/title\u003e', blogHtml, re.MULTILINE)\nif titleMatches:\n    # We found a \u003ctitle\u003e tag, so use that as the title\n    postTitle = titleMatches.group(1)\n    postTitle = postTitle[(postTitle.find(\":\") + 2):]\n    postTitle = postTitle.replace(\"\\\"\", \"'\")\n\n# Strip \u003cscript /\u003e tags\nblogHtml = re.sub(r'\u003cscript\\b[^\u003c]*(?:(?!\u003c\\/script\u003e)\u003c[^\u003c]*)*\u003c\\/script\u003e', '', str(blogHtml), flags=re.DOTALL)\n\n# Strip \u003cstyle /\u003e tags\nblogHtml = re.sub(r'\u003cstyle\\b[^\u003c]*(?:(?!\u003c\\/style\u003e)\u003c[^\u003c]*)*\u003c\\/style\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Strip other HTML\nblogHtml = re.sub(r'\u003c[^\u003c]+?\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Replace new lines with a space\nblogHtml = blogHtml.replace(\"\\n\", \" \")",
              "script_arguments": [
                "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NC2U361aXK4jC2A22tI9NKsLN5$"
              ],
              "script_queries": [
                {
                  "script_query": "blogHtml",
                  "script_query_name": "blogHtml",
                  "script_query_type": "string"
                },
                {
                  "script_query": "postTitle",
                  "script_query_name": "postTitle",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA3O2EF9KT5qdYJ2VMUXRttR81bFmxFi",
            "name": "Condition Block",
            "title": "Were we able to fetch and clean the blog post?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were we able to fetch and clean the blog post?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LQA3O83FKL23bWY6XFXqjyS5y5PXoSK86",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQA3OF3VM1Q3caAaXfnqophxinhMUT4fp",
                    "name": "Completed",
                    "title": "Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Failed",
                      "result_message": "Failed to fetch and/or clean the blog post content\n\nPython result: $activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.response_body$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA3OKBAYC95yRmcqLNictFsbsQbOxtgE",
        "name": "Group",
        "title": "Inspect the blog  content",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Inspect the blog  content",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA3PGOF1ZM5iMIryG1R8maaxUm6kEHFQ",
            "name": "Threat Response - Inspect for Observables",
            "title": "Threat Response - Inspect for Observables",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Inspect for Observables",
              "input": {
                "variable_workflow_01PP7586F8ITB1sT6OpDzEF79wnWVOJk1N5": "",
                "variable_workflow_01PP7586F8MQB2tFYbNgQC7xGbC7ZoXrOxR": "$activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.script_queries.blogHtml$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target_group": true
              },
              "workflow_id": "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
              "workflow_name": "Threat Response - Inspect for Observables"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA3POW3J0B6sJQ4FRaAeM0a8U4r4JvRb",
            "name": "JSONPath Query",
            "title": "Test for results",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Test for results",
              "input_json": "$activity.definition_activity_01LQA3PGOF1ZM5iMIryG1R8maaxUm6kEHFQ.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.[0].value",
                  "jsonpath_query_name": "inspectTest",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA3PX7ICFY4pmanAJjJmZbD3umNNJWaj",
            "name": "Condition Block",
            "title": "Were there any observables?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were there any observables?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LQA3Q33UZMM3esjyIDM5lY6UvjA4wjozp",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01LQA3POW3J0B6sJQ4FRaAeM0a8U4r4JvRb.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQA3QACJG055wrng2U0RtySlRMGcehPQE",
                    "name": "Completed",
                    "title": "Nothing to investigate",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Nothing to investigate",
                      "result_message": "The blog post \"$activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.script_queries.postTitle$\" was inspected but no observables to investigate were found",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQA3QG2Q3YJ4jovQDzGqxjJWnNllYkqmT",
            "name": "Read Table from JSON",
            "title": "Convert list of observables to table",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Convert list of observables to table",
              "input_json": "$activity.definition_activity_01LQA3PGOF1ZM5iMIryG1R8maaxUm6kEHFQ.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
              "jsonpath_query": "$.*",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "type",
                  "column_type": "string"
                },
                {
                  "column_name": "value",
                  "column_type": "string"
                },
                {
                  "column_name": "disposition",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA3QQ8I19C59TadUXV8H379QdPLOsQYw",
        "name": "Group",
        "title": "Deliberate the observables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Deliberate the observables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA3QY4M5341k2MkGBmoAP64JkxuOtdBd",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01LQA3QG2Q3YJ4jovQDzGqxjJWnNllYkqmT.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA3RAAE9J52yk8w4sWVmtN7bMq67yvEc",
                "name": "Threat Response - Deliberate Observable",
                "title": "Threat Response - Deliberate Observable",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response - Deliberate Observable",
                  "input": {
                    "variable_workflow_01PP77MLJ2S465LuOvU8mlP8mbbcgy9uTXN": "$activity.definition_activity_01LQA3QY4M5341k2MkGBmoAP64JkxuOtdBd.input.source_array[@].type$",
                    "variable_workflow_01PP77MLJ2XIE1H3D67PjcsCuGBsKCCBxLI": "",
                    "variable_workflow_01PP77MLJ2ZVU1C4VxEfKYh2tlFk9iTx69p": "$activity.definition_activity_01LQA3QY4M5341k2MkGBmoAP64JkxuOtdBd.input.source_array[@].value$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
                  "workflow_name": "Threat Response - Deliberate Observable"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LQA3SZ1ASEI4ktIz0eRwvxIFDALXZSza3",
                "name": "Update Row in Table",
                "title": "Update observable table with disposition",
                "type": "core.updaterowintable",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "columns": [
                    {
                      "column_name": "disposition",
                      "column_type": "string"
                    }
                  ],
                  "continue_on_failure": false,
                  "display_name": "Update observable table with disposition",
                  "input_table": "$activity.definition_activity_01LQA3QG2Q3YJ4jovQDzGqxjJWnNllYkqmT.output.read_table_from_json$",
                  "row": [
                    {
                      "key": "disposition",
                      "type": "string",
                      "value": "$activity.definition_activity_01LQA3RAAE9J52yk8w4sWVmtN7bMq67yvEc.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$"
                    }
                  ],
                  "rows": {
                    "rows_matching_criteria": true,
                    "where_clause": "type == '$activity.definition_activity_01LQA3QY4M5341k2MkGBmoAP64JkxuOtdBd.input.source_array[@].type$' AND value == '$activity.definition_activity_01LQA3QY4M5341k2MkGBmoAP64JkxuOtdBd.input.source_array[@].value$'"
                  },
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LQA3T8VA0PZ3rRrebNhdbtKNngzk2IFuB",
                "name": "Condition Block",
                "title": "Was this observable clean?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was this observable clean?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LQA3TFO7MXY05HDp7hiBgnLegmUmEJ0LO",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LQA3RAAE9J52yk8w4sWVmtN7bMq67yvEc.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$",
                        "operator": "ne",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LQA3TRTOBUO3ZDwsK0RZdA7pUL92bQeHA",
                        "name": "Execute Python Script",
                        "title": "Append this observable to the observable JSON",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Append this observable to the observable JSON",
                          "script": "import sys,json\n\n# Parse the existing list of observables\nexisting = json.loads(sys.argv[1])\n\n# Get the new observable information\nnewType = sys.argv[2]\nnewValue = sys.argv[3]\nnewDisposition = sys.argv[4]\n\n# Append the new observable to the list\nexisting.append( { \"type\": newType, \"value\": newValue, \"disposition\": newDisposition } )\n\n# Build the new JSON\nnewJson = json.dumps(existing)",
                          "script_arguments": [
                            "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N0ZQ5yh05yjpFd1QJPphky11Tc$",
                            "$activity.definition_activity_01LQA3QY4M5341k2MkGBmoAP64JkxuOtdBd.input.source_array[@].type$",
                            "$activity.definition_activity_01LQA3QY4M5341k2MkGBmoAP64JkxuOtdBd.input.source_array[@].value$",
                            "$activity.definition_activity_01LQA3RAAE9J52yk8w4sWVmtN7bMq67yvEc.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$"
                          ],
                          "script_queries": [
                            {
                              "script_query": "newJson",
                              "script_query_name": "newJson",
                              "script_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LQA3U1M2RB6471ZCKg2IKwwQ9Y0dEWQcf",
                        "name": "Set Variables",
                        "title": "Update local observable variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Update local observable variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N0ZQ5yh05yjpFd1QJPphky11Tc$",
                              "variable_value_new": "$activity.definition_activity_01LQA3TRTOBUO3ZDwsK0RZdA7pUL92bQeHA.output.script_queries.newJson$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQA3U9ODICP7kJaJuLQcrqdaQvdi6zfWc",
            "name": "Condition Block",
            "title": "Were all of the observables clean?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were all of the observables clean?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LQA3UFJKU842vzgJuh438QmYdt8jw3IUE",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N0ZQ5yh05yjpFd1QJPphky11Tc$",
                    "operator": "eq",
                    "right_operand": "[]"
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQA3ULOUJN51G6im24Vlj0G5bNzuPnMyG",
                    "name": "Completed",
                    "title": "No suspicious observables",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "No suspicious observables",
                      "result_message": "The blog post \"$activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.script_queries.postTitle$\" was investigated but all of the observables were clean",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA3UR5J0PQ5cF9u3uOGKWsHqJxPSnyag",
        "name": "Group",
        "title": "Enrich the observables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Enrich the observables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA3UZ0IKHZ6KR5r6G3dO7JyQ3azcTeWV",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01LQA3QG2Q3YJ4jovQDzGqxjJWnNllYkqmT.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA3V9GNFAQ1jph2F1jZE2oRNK3CVA2Wq",
                "name": "Condition Block",
                "title": "Is this observable clean?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Is this observable clean?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LQA3VF8XHHH6lCf9iMS6UY6e3uJVuMP72",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LQA3UZ0IKHZ6KR5r6G3dO7JyQ3azcTeWV.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LQA3VNBITVV35HvvVVvZISSYxChJ3CMfU",
                        "name": "Continue",
                        "title": "Skip this observable",
                        "type": "logic.continue",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Skip this observable",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LQA3X9O2IP61ODR3M9NkGuzJB13C0i53Y",
                "name": "Threat Response - Enrich Observable",
                "title": "Threat Response - Enrich Observable",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response - Enrich Observable",
                  "input": {
                    "variable_workflow_01PP78TYDTQ2L5AWh7XpLPkXldkBYssq6SC": "$activity.definition_activity_01LQA3UZ0IKHZ6KR5r6G3dO7JyQ3azcTeWV.input.source_array[@].value$",
                    "variable_workflow_01PP78TYDTTUQ6Qtv47uK5sgOFSbJ4b4Cno": "$activity.definition_activity_01LQA3UZ0IKHZ6KR5r6G3dO7JyQ3azcTeWV.input.source_array[@].type$",
                    "variable_workflow_01PP78TYDTV5R5JK6DtYaS5E95bWbZBstS5": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
                  "workflow_name": "Threat Response - Enrich Observable"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LQA3XJ90I8A2njBKG5qqEhUSdoWr2H4g2",
                "name": "Read Table from JSON",
                "title": "Convert list of enrichments to table",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Convert list of enrichments to table",
                  "input_json": "$activity.definition_activity_01LQA3X9O2IP61ODR3M9NkGuzJB13C0i53Y.output.variable_workflow_01PP78TYDTWG01QGHDq5uwDKdvEqS9CdcYg$",
                  "jsonpath_query": "$.data[*]",
                  "persist_output": false,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "module",
                      "column_type": "string"
                    },
                    {
                      "column_name": "module_type",
                      "column_type": "string"
                    },
                    {
                      "column_name": "data",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LQA3XUARZ0Y2rrJMbjlhb8jlIf4tnD6wT",
                "name": "Condition Block",
                "title": "Were we able to convert the results to a table?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were we able to convert the results to a table?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LQA3Y1QD13T4511cZwzbsBvJau5WgpuH8",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LQA3XJ90I8A2njBKG5qqEhUSdoWr2H4g2.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LQA3Y9GOUGW6kvgq4IpSSuZwviQ33hJA2",
                        "name": "Continue",
                        "title": "Skip this observable",
                        "type": "logic.continue",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Skip this observable",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LQA3YF6WSF65tjGAd0lNnrB1boj9HzY7A",
                "name": "For Each",
                "title": "For each enriched module",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For each enriched module",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_01LQA3XJ90I8A2njBKG5qqEhUSdoWr2H4g2.output.read_table_from_json$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQA3YQM4HQP4nvqOsW7484eDMr898SmUF",
                    "name": "JSONPath Query",
                    "title": "Extract sightings",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract sightings",
                      "input_json": "$activity.definition_activity_01LQA3YF6WSF65tjGAd0lNnrB1boj9HzY7A.input.source_array[@].data$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.sightings.count",
                          "jsonpath_query_name": "sightingCount",
                          "jsonpath_query_type": "string"
                        },
                        {
                          "jsonpath_query": "$.sightings.docs",
                          "jsonpath_query_name": "sightingData",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LQA3YZEQ0P73Wuc8h0btW7IkDjyFfpmC7",
                    "name": "Condition Block",
                    "title": "Do we care about this module?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Do we care about this module?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01LQA3Z5AWL4N5XGoOmi2gSKNwNPkdEy5kZ",
                        "name": "Condition Branch",
                        "title": "No sightings, skip it",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01LQA3YQM4HQP4nvqOsW7484eDMr898SmUF.output.succeeded$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "No sightings, skip it",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LQA3ZDYU5HZ1bN5j63kLhZkhAkKVSbV41",
                            "name": "Continue",
                            "title": "Skip this module",
                            "type": "logic.continue",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Skip this module",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LQA3ZJNC5SO6o9x0fX978RKUseaiY1vFg",
                    "name": "Execute Python Script",
                    "title": "Extract sightings and targets",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Extract sightings and targets",
                      "script": "import sys,json\n\n# Get the name of the module being investigated\nmoduleName = sys.argv[1]\n\n# Parse the existing list of sightings and targets\nexistingSightings = json.loads(sys.argv[3])\nexistingTargets = json.loads(sys.argv[4])\n\n# Parse the new sightings\nnewSightings = json.loads(sys.argv[2])\n\n# Loop through each sighting\nfor sighting in newSightings:\n\tsighting[\"module_name\"] = moduleName\n\t\n\t# Append this sighting to the master list\n\texistingSightings.append(sighting)\n\t\n\t# Check if this sighting has any targets\n\tif \"targets\" in sighting.keys() and len(sighting[\"targets\"]) \u003e 0:\n\t\t# Loop through each target\n\t\tfor target in sighting[\"targets\"]:\n\t\t\t# Check if this target is an endpoint\n\t\t\tif target[\"type\"] == \"endpoint\":\n\t\t\t\t# Loop through each observable\n\t\t\t\tfor observable in target[\"observables\"]:\n\t\t\t\t\tif observable[\"type\"] == \"amp_computer_guid\" and not observable in existingTargets:\n\t\t\t\t\t\texistingTargets.append(observable)\n\n# Build the new JSON\nnewSightings = json.dumps(existingSightings)\nnewTargets = json.dumps(existingTargets)",
                      "script_arguments": [
                        "$activity.definition_activity_01LQA3YF6WSF65tjGAd0lNnrB1boj9HzY7A.input.source_array[@].module$",
                        "$activity.definition_activity_01LQA3YQM4HQP4nvqOsW7484eDMr898SmUF.output.jsonpath_queries.sightingData$",
                        "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N4E44QQrR7T7ZiBrpIxLXuea3N$",
                        "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NB162pOsKvh0MYscpUAdDCmsAu$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "newSightings",
                          "script_query_name": "newSightings",
                          "script_query_type": "string"
                        },
                        {
                          "script_query": "newTargets",
                          "script_query_name": "newTargets",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LQA3ZSX10LC7cpIlgurYyfuUFk2Bm7Zl2",
                    "name": "Set Variables",
                    "title": "Update local variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update local variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N4E44QQrR7T7ZiBrpIxLXuea3N$",
                          "variable_value_new": "$activity.definition_activity_01LQA3ZJNC5SO6o9x0fX978RKUseaiY1vFg.output.script_queries.newSightings$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NB162pOsKvh0MYscpUAdDCmsAu$",
                          "variable_value_new": "$activity.definition_activity_01LQA3ZJNC5SO6o9x0fX978RKUseaiY1vFg.output.script_queries.newTargets$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA401FUF4B6X2T9PuExD6mu2NA723G64",
        "name": "Group",
        "title": "Generate summaries",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Generate summaries",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA408F7H271QaFpQsehnziJjWgPmrUjk",
            "name": "Execute Python Script",
            "title": "Convert sighting data to usable text for messaging",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Convert sighting data to usable text for messaging",
              "script": "import sys,json\n\n# Get and parse the sighting data\nsightings = json.loads(sys.argv[1])\n\n# Placeholders for output\nsightingCounts = {}\nmoduleNames = []\ntargets = []\n\n# Loop through each sighting\nfor sighting in sightings:\n\t# If there aren't any targets, initialize that array index to an empty list\n\tif not \"targets\" in sighting:\n\t\tsighting[\"targets\"] = []\n\t\t\n\t# Loop through each target\n\ttargetCount = 0\n\tfor target in sighting[\"targets\"]:\n\t\t# Remove the observed time (so two of the same target aren't considered different)\n\t\tdel target[\"observed_time\"]\n\t\t\n\t\t# Add this target to our master list if it's not already in the list (and count it)\n\t\tif not target in targets:\n\t\t\ttargetCount += 1\n\t\t\ttargets.append(target)\n\t\n\t# Is this module already in our count array?\n\tif sighting[\"module_name\"] in sightingCounts.keys():\n\t\t# Yes, so increment the counts\n\t\tsightingCounts[sighting[\"module_name\"]][\"count\"] += 1\n\t\tsightingCounts[sighting[\"module_name\"]][\"targets\"] += targetCount\n\telse:\n\t\t# No, so add it and its counts\n\t\tsightingCounts[sighting[\"module_name\"]] = {\n\t\t\t\"count\": 1,\n\t\t\t\"targets\": targetCount\n\t\t}\n\t\tmoduleNames.append(sighting[\"module_name\"])\n\n# Placeholders for output\nhtmlSummary = \"\"\nhtmlTruncated = False\nmarkdownSummary = \"\"\nmarkdownTruncated = False\nmrkdwnSummary = \"\"\nmrkdwnTruncated = False\n\n# Loop through the sighting counts\nfor module in moduleNames:\n\t# Make sure the HTML summary (for email and ServiceNow) isn't already too long\n\tif len(htmlSummary.encode(\"utf-8\")) \u003e 4000 and not htmlTruncated:\n\t\t# It's getting too long, so mark the message as truncated (and we'll add a warning later)\n\t\thtmlTruncated = True\n\telif not htmlTruncated:\n\t\t# The message isn't too long, so append this module\n\t\thtmlSummary = htmlSummary + \"\u003cli\u003eModule \u003cstrong\u003e\" + module + \"\u003c/strong\u003e returned \u003cstrong\u003e\" + str(sightingCounts[module][\"count\"]) + \" sightings\u003c/strong\u003e with a total of \u003cstrong\u003e\" + str(sightingCounts[module][\"targets\"]) + \" targets\u003c/strong\u003e\u003c/li\u003e\"\n\t\n\t# Make sure the markdown summary (for Threat Response and Webex) isn't already too long\n\tif len(markdownSummary.encode(\"utf-8\")) \u003e 4000 and not markdownTruncated:\n\t\t# It's getting too long, so add a message indicating that the text was truncated\n\t\tmarkdownSummary = markdownSummary + \"\\n\\n Additional information was available but truncated due to message length\"\n\t\tmarkdownTruncated = True\n\telif not markdownTruncated:\n\t\t# The message isn't too long, so append this module\n\t\tmarkdownSummary = markdownSummary + (\"\\n\" if len(markdownSummary) \u003e 0 else \"\") + \"* Module **\" + module + \"** returned **\" + str(sightingCounts[module][\"count\"]) + \" sightings** with a total of **\" + str(sightingCounts[module][\"targets\"]) + \" targets**\"\n\t\n\t# Make sure the mrkdwn summary (for Slack) isn't already too long\n\tif len(mrkdwnSummary.encode(\"utf-8\")) \u003e 4000 and not mrkdwnTruncated:\n\t\t# It's getting too long, so add a message indicating that the text was truncated\n\t\tmrkdwnSummary = mrkdwnSummary + \"\\n\\n Additional information was available but truncated due to message length\"\n\t\tmrkdwnTruncated = True\n\telif not mrkdwnTruncated:\n\t\t# The message isn't too long, so append this module\n\t\tmrkdwnSummary = mrkdwnSummary + (\"\\n\" if len(mrkdwnSummary) \u003e 0 else \"\") + \"- Module *\" + module + \"* returned *\" + str(sightingCounts[module][\"count\"]) + \" sightings* with a total of *\" + str(sightingCounts[module][\"targets\"]) + \" targets*\"\n\t\n# Finish the HTML summary\nhtmlSummary = \"\u003cul\u003e\" + htmlSummary + \"\u003c/ul\u003e\"\n\nif htmlTruncated:\n\thtmlSummary = htmlSummary + \"\u003cbr /\u003e\u003cbr /\u003e\u003cstrong\u003eAdditional information was available but truncated due to message length\u003c/strong\u003e\"\n\n# Convert the targets to a JSON list\ntargetJson = json.dumps(targets)",
              "script_arguments": [
                "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N4E44QQrR7T7ZiBrpIxLXuea3N$"
              ],
              "script_queries": [
                {
                  "script_query": "htmlSummary",
                  "script_query_name": "htmlSummary",
                  "script_query_type": "string"
                },
                {
                  "script_query": "markdownSummary",
                  "script_query_name": "markdownSummary",
                  "script_query_type": "string"
                },
                {
                  "script_query": "targetJson",
                  "script_query_name": "targetJson",
                  "script_query_type": "string"
                },
                {
                  "script_query": "mrkdwnSummary",
                  "script_query_name": "mrkdwnSummary",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA40FKYFSB4zYnC6a7PRWrkfTdzN02rc",
            "name": "Execute Python Script",
            "title": "Strip observable dispositions",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Strip observable dispositions",
              "script": "import sys,json\n\n# Parse the list of observables\nobservables = json.loads(sys.argv[1])\n\n# Placeholder for output\nplainObservables = []\n\n# Build a new list of plain observables (only type and value fields)\nfor observable in observables:\n\tplainObservables.append({ \"type\": observable[\"type\"], \"value\": observable[\"value\"] })\n\t\nplainObservableJson = json.dumps(plainObservables)",
              "script_arguments": [
                "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N0ZQ5yh05yjpFd1QJPphky11Tc$"
              ],
              "script_queries": [
                {
                  "script_query": "plainObservableJson",
                  "script_query_name": "plainObservableJson",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA40N6B43K7RFbEXg5FxnrmDta9BcnsS",
        "name": "Group",
        "title": "Create ITSM ticket",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Create ITSM ticket",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv",
            "name": "ServiceNow - Create Incident",
            "title": "ServiceNow - Create Incident",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "ServiceNow - Create Incident",
              "input": {
                "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "Talos - SolarWinds Investigation",
                "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "An automated investigation into observables related to the SolarWinds supply chain attack was conducted by SecureX orchestration.",
                "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 2,
                "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 1,
                "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "[code]\u003ca href=\"https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/orch-ui/workflows/$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.output.instance_id$\" target=\"_blank\"\u003eView Workflow\u003c/a\u003e\u003cbr /\u003e\u003cbr /\u003e\u003cu\u003eSighting Summary\u003c/u\u003e:\u003cbr /\u003e$activity.definition_activity_01LQA408F7H271QaFpQsehnziJjWgPmrUjk.output.script_queries.htmlSummary$[/code]",
                "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "securex-orchestration",
                "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "ServiceNow"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
              "workflow_name": "ServiceNow - Create Incident"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA419GNK7V0G3jYow7fnDFPuqkPJn9jV",
        "name": "Group",
        "title": "Create Threat Response objects",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Create Threat Response objects",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA41JOI611360w26PVvf2LUzoKdlj3qA",
            "name": "Threat Response - Create Casebook",
            "title": "Threat Response - Create Casebook",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Create Casebook",
              "input": {
                "variable_workflow_01PP75X6NM0AY6YDlJckkMg6hCbMEMGO72O": "$activity.definition_activity_01LQA40FKYFSB4zYnC6a7PRWrkfTdzN02rc.output.script_queries.plainObservableJson$",
                "variable_workflow_01PP75X6NM1M46Jjob8LUKg8R3yRRVOvu9q": "",
                "variable_workflow_01PP75X6NM2V27Or3EssfIABNZiE45Ddziu": "amber",
                "variable_workflow_01PP75X6NM4123PBwUedJ5QqeBr8G1sefjQ": "Talos - SolarWinds Investigation",
                "variable_workflow_01PP75X6NM54W5qTbpCb1h6bTTrp7eFQjaq": "Casebook generated from a Talos blog post",
                "variable_workflow_01PP75X6NM7FE4BmQ3AKIykyWFDSV9umy02": "This casebook was generated by SecureX orchestration from a Talos blog post about the SolarWinds supply chain attack.\n\n[Click here]($workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NC2U361aXK4jC2A22tI9NKsLN5$) to view the blog post.\n[Click here](https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N8QT7PLkRLBev75d0XTL3nIW9o$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$) to view the ServiceNow incident ticket.\n\n_Sighting Summary_:\n$activity.definition_activity_01LQA408F7H271QaFpQsehnziJjWgPmrUjk.output.script_queries.markdownSummary$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
              "workflow_name": "Threat Response - Create Casebook"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA42677HA90Kd6O8uxVsng1tTMRkjdyD",
            "name": "Threat Response - Create Incident",
            "title": "Threat Response - Create Incident",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Create Incident",
              "input": {
                "variable_workflow_01PP773PC153N1sUPzhFqV9bCbaxsz3yDwH": "",
                "variable_workflow_01PP773PC19C57fpPyxEFzuX0kP8dAqdVoQ": "This incident was generated by SecureX orchestration from a Talos blog post about the SolarWinds supply chain attack.\n\n[Click here]($workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NC2U361aXK4jC2A22tI9NKsLN5$) to view the blog post.\n[Click here](https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N8QT7PLkRLBev75d0XTL3nIW9o$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$) to view the ServiceNow incident ticket.\n\n_Sighting Summary_:\n$activity.definition_activity_01LQA408F7H271QaFpQsehnziJjWgPmrUjk.output.script_queries.markdownSummary$",
                "variable_workflow_01PP773PC1ALV47FYVyDKQsPCuKzTZwYeyv": "New",
                "variable_workflow_01PP773PC1DZZ2rpbgvgD3IRrMsngkGxWkK": "Talos - SolarWinds Investigation",
                "variable_workflow_01PP773PC1F547IibuvGX89UFFJE9ZNlHgb": "amber",
                "variable_workflow_01PP773PC1G7V6ZMj5IyCTQcEPiVhQm1fYO": "High"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01PP773PI1X3Y1YQWhirIL8Uy40Thd6ND7r",
              "workflow_name": "Threat Response - Create Incident"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA42HWTPKT5F9ms2oIecj1VrgPpUhNnv",
            "name": "Threat Response - Create Relationship",
            "title": "Threat Response - Create Relationship",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Create Relationship",
              "input": {
                "variable_workflow_01PP78LVV8JKR6NKKuym8RA2VYFgUJrR4qU": "$activity.definition_activity_01LQA41JOI611360w26PVvf2LUzoKdlj3qA.output.variable_workflow_01PP75X6NM6A27cUzf6oC7zeZQTz0YxT8J0$",
                "variable_workflow_01PP78LVV8NS94TRyx07G3ajwZ5eE5oWZ36": "",
                "variable_workflow_01PP78LVV8P3X5wkMhrcIXTnToxb6HxuLpk": "",
                "variable_workflow_01PP78LVV8QB314gJIqe5PQHoWnRTMtwhK4": "amber",
                "variable_workflow_01PP78LVV8RLZ02Yzy68Uz59X8kInnUomdU": "",
                "variable_workflow_01PP78LVV8SVF31gxGXEVhu26vewW98cJxO": "$activity.definition_activity_01LQA42677HA90Kd6O8uxVsng1tTMRkjdyD.output.variable_workflow_01PP773PC1BPV1bDuA5gxMPKC5vx4EJTYXw$",
                "variable_workflow_01PP78LVV8V4B28e1wJKo9WReVhIZ3bvM6f": "related-to"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01PP78LW2WNY80aDM6OHNiRu2VPG4BrR8bq",
              "workflow_name": "Threat Response - Create Relationship"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA42S860FC2VSF3WETTUQNP7DOJxaBRw",
        "name": "Group",
        "title": "Update ITSM Ticket",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Update ITSM Ticket",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA431Y41Q73IYMv4fd4am3oX9yof6Hdd",
            "name": "ServiceNow - Add Work Note to Incident",
            "title": "ServiceNow - Add Work Note to Incident",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "ServiceNow - Add Work Note to Incident",
              "input": {
                "variable_workflow_01FMQTASNW19F198DyWHV14WHmkxNhmxaQu": "[code]\u003ca href=\"https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$/incidents?q=id:$activity.definition_activity_01LQA42677HA90Kd6O8uxVsng1tTMRkjdyD.output.variable_workflow_01PP773PC1CVM3SzJJrvuZfEsO3Nbw7IO7S$\" target=\"_blank\"\u003eView Threat Response Incident\u003c/a\u003e\u003cbr /\u003e\u003ca href=\"https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$/investigate?spid=$activity.definition_activity_01LQA41JOI611360w26PVvf2LUzoKdlj3qA.output.variable_workflow_01PP75X6NLWYO1BiZbBFEXJyqmmfiQcqId3$\" target=\"_blank\"\u003eInvestigate in Threat Response\u003c/a\u003e[/code]",
                "variable_workflow_01FMQTASNW78T0tgvbFoES84str3rrkOfBq": "v2",
                "variable_workflow_01FMQVGD9LTQK0vkSN3y7c0YHxc5cWQnVRt": "$activity.definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv.output.variable_workflow_01C0F7F9L7IYM3YXHCizJhunwKtPlSJWEWM$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "ServiceNow"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01FMQTAT3H5VC4NVbonulAhVztfqidbUGlJ",
              "workflow_name": "ServiceNow - Add Work Note to Incident"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA43CQL8KO346jmAYd1QjZ7WlXTMxbGH",
        "name": "Group",
        "title": "Create remediation approval",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Create remediation approval",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA43KSVHGK3J81zNfN8g3nqVqUC0lddw",
            "name": "Execute Python Script",
            "title": "Generate approval text message",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Generate approval text message",
              "script": "import sys,json\n\n# Parse the observables and targets\nobservables = json.loads(sys.argv[1])\ntargets = json.loads(sys.argv[2])\n\n# Placeholders for output\napprovalText = \"\"\n\n# Loop through each non-clean observable\nfor observable in observables:\n\t# Is this suspicious or unknown?\n\tif not observable[\"disposition\"] in [\"Unknown\", \"Suspicious\"]:\n\t\tcontinue\n\t\n\tapprovalText = approvalText + \"\\n\" + (observable[\"value\"].replace(\".\", \"[.]\") if observable[\"type\"] in [\"domain\", \"url\"] else observable[\"value\"]) + \" (\" + observable[\"type\"] + \")\"\n\n# Are there targets?\nif len(targets) \u003e 0:\n\tapprovalText = approvalText + \"\\n\\nThe following targets will have a forensic snapshot taken and be isolated:\"\n\t\n\t# Loop through each target\n\tfor target in targets:\n\t\tapprovalText = approvalText + \"\\n\" + target[\"value\"] + \" (\" + target[\"type\"] + \")\"",
              "script_arguments": [
                "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N0ZQ5yh05yjpFd1QJPphky11Tc$",
                "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NB162pOsKvh0MYscpUAdDCmsAu$"
              ],
              "script_queries": [
                {
                  "script_query": "approvalText",
                  "script_query_name": "approvalText",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA43RTMQJQ05Xi07j6uV7fWHYTtekbXy",
            "name": "Condition Block",
            "title": "Is remediation necessary?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is remediation necessary?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LQA43XIVL2V553wtq1ptvbz2OV9pnyNnZ",
                "name": "Condition Branch",
                "title": "Nothing to act on",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01LQA43KSVHGK3J81zNfN8g3nqVqUC0lddw.output.script_queries.approvalText$",
                      "operator": "eq",
                      "right_operand": ""
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NB162pOsKvh0MYscpUAdDCmsAu$",
                      "operator": "eq",
                      "right_operand": "[]"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Nothing to act on",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQCYKXEU1RI6w82rex7vHVZYJdQXSvmTJ",
                    "name": "Completed",
                    "title": "Completed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Completed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQA44CUSIXP25QKcE6uzQu4XuT5KuTN8A",
            "name": "Create Approval Request",
            "title": "SolarWinds remediation approval",
            "type": "task.approval_request",
            "base_type": "activity",
            "properties": {
              "approval_choices": [
                "Approve",
                "Reject"
              ],
              "assignees": [
                "assignee@company,com"
              ],
              "continue_on_failure": false,
              "display_name": "SolarWinds remediation approval",
              "due_date": {
                "is_relative_time": true,
                "is_specified_date": false,
                "relative_time": {
                  "duration": 2,
                  "time_units": "hours"
                },
                "set_due_date": true
              },
              "expiration_date": {
                "is_relative_time": true,
                "is_specified_date": false,
                "relative_time": {
                  "duration": 2,
                  "time_units": "hours"
                }
              },
              "expiration_status": "Expired",
              "minimum_approvals": 1,
              "priority": "high",
              "skip_execution": false,
              "subject_line": "SolarWinds Investigation Remediation",
              "task_message": "An investigation into SolarWinds supply chain attack intelligence resulted in sightings within your environment. If you approve this task, automated remediation will be performed (based on the workflow configuration) for the observables listed below. If you reject this task, no further action will be taken.\n$activity.definition_activity_01LQA43KSVHGK3J81zNfN8g3nqVqUC0lddw.output.script_queries.approvalText$",
              "task_owner": "owner@company.com",
              "task_requestor": "requestor@company.com"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA44LH4ISP7WaywHsFYpfqRbBONRkAz7",
        "name": "Parallel Block",
        "title": "Send notifications",
        "type": "logic.parallel",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Send notifications",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LQA44QAK1NC2IwaSBgb2zASCLtiCxYboE",
            "name": "Parallel Branch",
            "title": "Send Webex message",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send Webex message",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA44Y5977A6p2AAhYs9Cqh5o0qT7JTIu",
                "name": "Condition Block",
                "title": "Was a Webex room provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was a Webex room provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LQA454ICEHS0unIMiiIJJlkY3LiLBPqLR",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NGBB54aYNtHzu1k3WgZbA48VAJ$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LQA45E79XK50pZovz52Z7OuK06H8JOzzu",
                        "name": "Webex - Search for Room",
                        "title": "Webex - Search for Room",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Webex - Search for Room",
                          "input": {
                            "variable_workflow_01PP790MCX1DN3EitpQebkUyJS65DbwS3nU": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N9U008BtkYC6UOqkypo4MfD4IG$",
                            "variable_workflow_01PP790MCXB392D3R8pxh9fgOTjTde2bcMW": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NGBB54aYNtHzu1k3WgZbA48VAJ$",
                            "variable_workflow_01PP790MCXHP55YE6ylOEITWsWbUFJeyWGv": "",
                            "variable_workflow_01PP790MCXM9W1MUwo85y8iNRCoQuQ4RGNa": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Webex Teams"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
                          "workflow_name": "Webex - Search for Room"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LQA45MQ5P7A6TZ5gjuQZ4DGLrj77Y2E80",
                        "name": "Condition Block",
                        "title": "Did we find the room?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Did we find the room?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01LQA45T3FCLH7M6dxrDYDISAo0CalpjsxQ",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LQA45E79XK50pZovz52Z7OuK06H8JOzzu.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LQA464CIP2B3kKaTodOAVgrdy02l8A4r1",
                                "name": "Webex - Post Message to Room",
                                "title": "Webex - Post Message to Room",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Webex - Post Message to Room",
                                  "input": {
                                    "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01LQA45E79XK50pZovz52Z7OuK06H8JOzzu.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
                                    "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N9U008BtkYC6UOqkypo4MfD4IG$",
                                    "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "A Threat Response incident has been created for the blog post [$activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.script_queries.postTitle$]($workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NC2U361aXK4jC2A22tI9NKsLN5$) from Talos. [Click here](https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/incidents?q=id:$activity.definition_activity_01LQA42677HA90Kd6O8uxVsng1tTMRkjdyD.output.variable_workflow_01PP773PC1CVM3SzJJrvuZfEsO3Nbw7IO7S$) to view the incident or [click here](https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/investigate?spid=$activity.definition_activity_01LQA41JOI611360w26PVvf2LUzoKdlj3qA.output.variable_workflow_01PP75X6NLWYO1BiZbBFEXJyqmmfiQcqId3$) to investigate.\n[Click here](https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/orch-ui/tasks/$activity.definition_activity_01LQA44CUSIXP25QKcE6uzQu4XuT5KuTN8A.output.task_id$) to approve automated remediation.\n[Click here](https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N8QT7PLkRLBev75d0XTL3nIW9o$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$) to view the ServiceNow incident.\n_Sighting Summary_:\n$activity.definition_activity_01LQA408F7H271QaFpQsehnziJjWgPmrUjk.output.script_queries.markdownSummary$",
                                    "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                                    "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Webex Teams"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                                  "workflow_name": "Webex - Post Message to Room"
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQA46GA0K5X2cQjNHL2YvB3bjfywJ6JO5",
            "name": "Parallel Branch",
            "title": "Send Slack message",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send Slack message",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA46M4RXHP6MfZybRZvyvUUcSR7NARNn",
                "name": "Condition Block",
                "title": "Was a Slack channel provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was a Slack channel provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LQA46S7JEMU1pMxIqjEwyDfzob6qNf35X",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NFA53LeWYM0XIDGYR88m9OCoIM$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LQA478PJSAF0iKsl11hbmadj4tZiUUsVB",
                        "name": "Slack - Send Message to Channel",
                        "title": "Slack - Send Message to Channel",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Slack - Send Message to Channel",
                          "input": {
                            "variable_workflow_01HQNZKTLIV8Z5287vTq4qKrS29IMFD3g7H": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NFA53LeWYM0XIDGYR88m9OCoIM$",
                            "variable_workflow_01HQOXVG5Y94H1B55vC2dK9RzxZSEDLMGkg": "A SecureX incident has been created for the blog post \u003c$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NC2U361aXK4jC2A22tI9NKsLN5$|$activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.script_queries.postTitle$\u003e from Talos. \u003chttps://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$/incidents?q=id:$activity.definition_activity_01LQA42677HA90Kd6O8uxVsng1tTMRkjdyD.output.variable_workflow_01PP773PC1CVM3SzJJrvuZfEsO3Nbw7IO7S$|Click here\u003e to view the incident or \u003chttps://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$/investigate?spid=$activity.definition_activity_01LQA41JOI611360w26PVvf2LUzoKdlj3qA.output.variable_workflow_01PP75X6NLWYO1BiZbBFEXJyqmmfiQcqId3$|click here\u003e to investigate.\n\u003chttps://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/orch-ui/tasks/$activity.definition_activity_01LQA44CUSIXP25QKcE6uzQu4XuT5KuTN8A.output.task_id$|Click here\u003e to approve automated remediation.\n\u003chttps://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N8QT7PLkRLBev75d0XTL3nIW9o$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$|Click here\u003e to view the ServiceNow incident.\n_Sighting Summary_:\n$activity.definition_activity_01LQA408F7H271QaFpQsehnziJjWgPmrUjk.output.script_queries.mrkdwnSummary$",
                            "variable_workflow_01HRF4D5938OI4mcYJ4JF2tkjIAztrs1c2z": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NHC54z1GyNQIsr2wJtZSSy1aY5$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Slack"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01HQNWMZ0DF0F1hMGyE56KyjIltjC5jQuIY",
                          "workflow_name": "Slack - Send Message to Channel"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQA47Q0PA3W3c37u0lnMghRnMwlLbAxFW",
            "name": "Parallel Branch",
            "title": "Send email",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send email",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQA47XSI2SP1XS5vFSHrySnclKrtI2Pcs",
                "name": "Send Email",
                "title": "Send Email",
                "type": "email.smtp_send_email",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "body": "A SecureX incident has been created for the blog post \u003ca href=\"$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NC2U361aXK4jC2A22tI9NKsLN5$\"\u003e$activity.definition_activity_01LQA3NW9YXAR54vSsJE7BprwY6HaX5r3t9.output.script_queries.postTitle$\u003c/a\u003e from Talos.\u003cbr /\u003e\n\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$/incidents?q=id:$activity.definition_activity_01LQA42677HA90Kd6O8uxVsng1tTMRkjdyD.output.variable_workflow_01PP773PC1CVM3SzJJrvuZfEsO3Nbw7IO7S$\"\u003eClick here\u003c/a\u003e to view the incident.\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7ND6U6I8MfIQxnmWNMQtwf9dvPk$/investigate?spid=$activity.definition_activity_01LQA41JOI611360w26PVvf2LUzoKdlj3qA.output.variable_workflow_01PP75X6NLWYO1BiZbBFEXJyqmmfiQcqId3$\"\u003eClick here\u003c/a\u003e to investigate.\u003cbr /\u003e\n\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N8QT7PLkRLBev75d0XTL3nIW9o$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$\"\u003eClick here\u003c/a\u003e to view the ServiceNow incident\u003cbr /\u003e\n\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/orch-ui/tasks/$activity.definition_activity_01LQA44CUSIXP25QKcE6uzQu4XuT5KuTN8A.output.task_id$\"\u003eClick here\u003c/a\u003e to approve automated remediation.\u003cbr /\u003e\n\u003cbr /\u003e\n$activity.definition_activity_01LQA408F7H271QaFpQsehnziJjWgPmrUjk.output.script_queries.htmlSummary$",
                  "continue_if_one_address_valid": false,
                  "continue_on_failure": false,
                  "display_name": "Send Email",
                  "html": true,
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "subject": "SolarWinds Investigation Results",
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "Email Endpoint"
                          }
                        ]
                      }
                    }
                  },
                  "to": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N6LJ4D2fvk8fqFR4Ufgdvqp3c3$"
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LQA487EZ4022jTV1bH1kETu0eTnNWX2cf",
        "name": "Group",
        "title": "Wait for approval and remediate",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Wait for approval and remediate",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LQA48G4BZFC0UCul81QKGubOoQuYkl74c",
            "name": "Wait For Event",
            "title": "Wait for approval",
            "type": "task.wait_for_event",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Wait for approval",
              "event_info": {
                "add_event": true,
                "event_definition": {
                  "conditions": {
                    "left_operand": "$output.task_id$",
                    "operator": "eq",
                    "right_operand": "$activity.definition_activity_01LQA44CUSIXP25QKcE6uzQu4XuT5KuTN8A.output.task_id$"
                  }
                }
              },
              "event_timeout": 2580000,
              "event_type": "approval_task.event",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01LQA48P29Y9A5FgJTKBSaWaRimarFsSPbw",
            "name": "Condition Block",
            "title": "Was the request approved?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Was the request approved?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LQA48UNM8HL5xcpzu0hohxhs57UGm0LK6",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01LQA48G4BZFC0UCul81QKGubOoQuYkl74c.output.response$",
                    "operator": "eqi",
                    "right_operand": "Approve"
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQA49DI7YFY0AvqEeOXYNxBlFEZacBw2a",
                    "name": "Parallel Block",
                    "title": "Get Threat Response module IDs",
                    "type": "logic.parallel",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Get Threat Response module IDs",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01LQA49IY6WR45I1go8U445VpaosKEmjfqU",
                        "name": "Parallel Branch",
                        "title": "Get Secure Endpoint module ID",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Get Secure Endpoint module ID",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LQA49RB1ODW4INIgtYUiIERilUoOfLxCy",
                            "name": "Threat Response - List Response Actions",
                            "title": "Threat Response - List Response Actions",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Threat Response - List Response Actions",
                              "input": {
                                "variable_workflow_01PP74F8NFMVL1nunnh0tHmJ6q93eKENUIo": "",
                                "variable_workflow_01PP74F8NFSAR6gmDctGdu1ipiminc8zxQ9": "ee4ec2a1d909afe0feaffadfef2d9785e447a48217c573c9fd9543743d4fd0da",
                                "variable_workflow_01PP74F8NFTHL23oJ81CQyQ3RzEdWnabkIB": "sha256"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
                              "workflow_name": "Threat Response - List Response Actions"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LQA4A2FFOUT2wAAQvVh5dUY2iHtZdUhpi",
                            "name": "Condition Block",
                            "title": "Were actions available?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were actions available?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01LQA4A8NRZKD6YVqouBozVtn9WJVBB1ZMh",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01LQA49RB1ODW4INIgtYUiIERilUoOfLxCy.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01LQA4AI3O0OZ7Gx3I7C2Kdv89wuIYzSnpZ",
                                    "name": "JSONPath Query",
                                    "title": "Extract Secure Endpoint actions",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": true,
                                      "display_name": "Extract Secure Endpoint actions",
                                      "input_json": " $activity.definition_activity_01LQA49RB1ODW4INIgtYUiIERilUoOfLxCy.output.variable_workflow_01PP74F8NFQWX7VN6IXaZIyIoHTzy3tJDxa$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[?(@.module=='AMP for Endpoints')]",
                                          "jsonpath_query_name": "ampActions",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01LQA4ARKX80I3JDx0ndtJIdmeZwlSNWlN2",
                                    "name": "Condition Block",
                                    "title": "Are there Secure Endpoint actions?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Are there Secure Endpoint actions?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01LQA4AXSB2YQ67CegSYzWhyDVElOunLrkF",
                                        "name": "Condition Branch",
                                        "title": "Yes",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01LQA4AI3O0OZ7Gx3I7C2Kdv89wuIYzSnpZ.output.succeeded$",
                                            "operator": "eq",
                                            "right_operand": true
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "Yes",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01LQA4B6W3YMV4fQZXuKDeapBK4qOMLHkOU",
                                            "name": "JSONPath Query",
                                            "title": "Extract the module ID",
                                            "type": "corejava.jsonpathquery",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": true,
                                              "display_name": "Extract the module ID",
                                              "input_json": "$activity.definition_activity_01LQA4AI3O0OZ7Gx3I7C2Kdv89wuIYzSnpZ.output.jsonpath_queries.ampActions$",
                                              "jsonpath_queries": [
                                                {
                                                  "jsonpath_query": "$.[0].module_instance_id",
                                                  "jsonpath_query_name": "moduleInstanceId",
                                                  "jsonpath_query_type": "string"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01LQJD7KGZRC03qRVocoqhBYZET9yUhd4N1",
                                            "name": "Condition Block",
                                            "title": "Did that work?",
                                            "type": "logic.if_else",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Did that work?",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01LQJD7OWWIG32uYkbTPZAxxbuRcmY4qgpH",
                                                "name": "Condition Branch",
                                                "title": "Yes",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LQA4B6W3YMV4fQZXuKDeapBK4qOMLHkOU.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": true
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "Yes",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LQA4BI4CD222iiQuSviSYaIED418QwhIg",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                                          "variable_value_new": "$activity.definition_activity_01LQA4B6W3YMV4fQZXuKDeapBK4qOMLHkOU.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01LQJD7QPF2IP1qLB9xY2ak9zdKmDL0uRLr",
                                                "name": "Condition Branch",
                                                "title": "No",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LQA4B6W3YMV4fQZXuKDeapBK4qOMLHkOU.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": false
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "No",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LQJDXG5NTAU35Dv5X0npNDMZmgqdFIQsf",
                                                    "name": "JSONPath Query",
                                                    "title": "Extract the module ID a different way",
                                                    "type": "corejava.jsonpathquery",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "action_timeout": 180,
                                                      "continue_on_failure": false,
                                                      "display_name": "Extract the module ID a different way",
                                                      "input_json": "$activity.definition_activity_01LQA4AI3O0OZ7Gx3I7C2Kdv89wuIYzSnpZ.output.jsonpath_queries.ampActions$",
                                                      "jsonpath_queries": [
                                                        {
                                                          "jsonpath_query": "$.module_instance_id",
                                                          "jsonpath_query_name": "moduleInstanceId",
                                                          "jsonpath_query_type": "string"
                                                        }
                                                      ],
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01LQJE0X4OM4E5RXG2xGutKP5ecdIuPM0xT",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                                          "variable_value_new": "$activity.definition_activity_01LQJDXG5NTAU35Dv5X0npNDMZmgqdFIQsf.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01LQA4BRFJYSY0hzDUbZkmxrrB60ajo92OL",
                        "name": "Parallel Branch",
                        "title": "Get Umbrella module ID",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Get Umbrella module ID",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LQA4C38UMEN5uy4JnQFN6iUa6mfAobXoS",
                            "name": "Threat Response - List Response Actions",
                            "title": "Threat Response - List Response Actions",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Threat Response - List Response Actions",
                              "input": {
                                "variable_workflow_01PP74F8NFMVL1nunnh0tHmJ6q93eKENUIo": "",
                                "variable_workflow_01PP74F8NFSAR6gmDctGdu1ipiminc8zxQ9": "cisco.com",
                                "variable_workflow_01PP74F8NFTHL23oJ81CQyQ3RzEdWnabkIB": "domain"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
                              "workflow_name": "Threat Response - List Response Actions"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LQA4CJQC43R6nidLQyUUwYCqtEcpdist9",
                            "name": "Condition Block",
                            "title": "Were actions available?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were actions available?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01LQA4CR5OJCX5HB2wORURm8zAp4zXPCerN",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01LQA4C38UMEN5uy4JnQFN6iUa6mfAobXoS.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01LQA4D24KKL67DpV9dDBQeSjaLKNIN54fW",
                                    "name": "JSONPath Query",
                                    "title": "Extract Umbrella actions",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": true,
                                      "display_name": "Extract Umbrella actions",
                                      "input_json": " $activity.definition_activity_01LQA4C38UMEN5uy4JnQFN6iUa6mfAobXoS.output.variable_workflow_01PP74F8NFQWX7VN6IXaZIyIoHTzy3tJDxa$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[?(@.module=='Umbrella')]",
                                          "jsonpath_query_name": "umbrellaActions",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01LQA4DC41AQN2M8qH3RBxThqgw9KARHdmo",
                                    "name": "Condition Block",
                                    "title": "Are there Umbrella actions?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Are there Umbrella actions?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01LQA4DIPJC1S3fgn5yahSYuyOY5H85yYp8",
                                        "name": "Condition Branch",
                                        "title": "Yes",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01LQA4D24KKL67DpV9dDBQeSjaLKNIN54fW.output.succeeded$",
                                            "operator": "eq",
                                            "right_operand": true
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "Yes",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01LQA4DTEFJBB0GQ2I1afXxQvVYMQ4tvJDx",
                                            "name": "JSONPath Query",
                                            "title": "Extract the module ID",
                                            "type": "corejava.jsonpathquery",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": true,
                                              "display_name": "Extract the module ID",
                                              "input_json": "$activity.definition_activity_01LQA4D24KKL67DpV9dDBQeSjaLKNIN54fW.output.jsonpath_queries.umbrellaActions$",
                                              "jsonpath_queries": [
                                                {
                                                  "jsonpath_query": "$.[0].module_instance_id",
                                                  "jsonpath_query_name": "moduleInstanceId",
                                                  "jsonpath_query_type": "string"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01LQJEE31DW9S6HCFZ61lldxwTUO0KDBQKo",
                                            "name": "Condition Block",
                                            "title": "Did that work?",
                                            "type": "logic.if_else",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Did that work?",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01LQJEE6LRHLB0Nwt6AcWT7vMM4GKmur3JV",
                                                "name": "Condition Branch",
                                                "title": "Yes",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LQA4DTEFJBB0GQ2I1afXxQvVYMQ4tvJDx.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": true
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "Yes",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LQA4E3AMU9N3hFs6bUxK6AENT8kPMmxvB",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7MWX051majkqz4KodFSdK8BRJNZ$",
                                                          "variable_value_new": "$activity.definition_activity_01LQA4DTEFJBB0GQ2I1afXxQvVYMQ4tvJDx.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01LQJEVF4Q8UQ4pvUIXqMyH3bsoXW7bzmLk",
                                                "name": "Condition Branch",
                                                "title": "No",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LQA4DTEFJBB0GQ2I1afXxQvVYMQ4tvJDx.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": false
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "No",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LQJF2PYW53S1DkOQbGnRZBpYIJm0621Eb",
                                                    "name": "JSONPath Query",
                                                    "title": "Extract the module ID a different way",
                                                    "type": "corejava.jsonpathquery",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "action_timeout": 180,
                                                      "continue_on_failure": false,
                                                      "display_name": "Extract the module ID a different way",
                                                      "input_json": "$activity.definition_activity_01LQA4D24KKL67DpV9dDBQeSjaLKNIN54fW.output.jsonpath_queries.umbrellaActions$",
                                                      "jsonpath_queries": [
                                                        {
                                                          "jsonpath_query": "$.module_instance_id",
                                                          "jsonpath_query_name": "moduleInstanceId",
                                                          "jsonpath_query_type": "string"
                                                        }
                                                      ],
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01LQJEVHYP6BR1ePpefKdoc8ZvG4rUPK2p9",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7MWX051majkqz4KodFSdK8BRJNZ$",
                                                          "variable_value_new": "$activity.definition_activity_01LQJF2PYW53S1DkOQbGnRZBpYIJm0621Eb.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LQA4ECSZYCH45xUVWDcHwHxVVfZQtQVmb",
                    "name": "Read Table from JSON",
                    "title": "Convert the observables to a table",
                    "type": "corejava.read_table_from_json",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Convert the observables to a table",
                      "input_json": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N0ZQ5yh05yjpFd1QJPphky11Tc$",
                      "jsonpath_query": "$.",
                      "persist_output": false,
                      "populate_columns": false,
                      "skip_execution": false,
                      "table_columns": [
                        {
                          "column_name": "type",
                          "column_type": "string"
                        },
                        {
                          "column_name": "value",
                          "column_type": "string"
                        },
                        {
                          "column_name": "disposition",
                          "column_type": "string"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LQC9SB06XFL4apNyUZocmODvDYtTB0oVA",
                    "name": "Set Variables",
                    "title": "Update remediation text",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update remediation text",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                          "variable_value_new": "**Automated remediation approved by $activity.definition_activity_01LQA48G4BZFC0UCul81QKGubOoQuYkl74c.output.assignee_responses[0].assignee$ for workflow instance: https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/orch-ui/runs/$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.output.instance_id$**\n* Secure Endpoint Module ID: $workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$\n* Umbrella Module ID: $workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7MWX051majkqz4KodFSdK8BRJNZ$\n* Processing $activity.definition_activity_01LQA4ECSZYCH45xUVWDcHwHxVVfZQtQVmb.output.row_count$ observables"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo",
                    "name": "For Each",
                    "title": "For each observable",
                    "type": "logic.for_each",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "For each observable",
                      "skip_execution": false,
                      "source_array": "$activity.definition_activity_01LQA4ECSZYCH45xUVWDcHwHxVVfZQtQVmb.output.read_table_from_json$"
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LQA4EZSYS8G5BlmRUWBZVUGVCb6l6a0Y9",
                        "name": "Condition Block",
                        "title": "Is this observable unknown or suspicious?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Is this observable unknown or suspicious?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01LQA4F63CTS43nzg77iiubFfpCZDqaTl41",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].disposition$",
                                  "operator": "ne",
                                  "right_operand": "Unknown"
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].disposition$",
                                  "operator": "ne",
                                  "right_operand": "Suspicious"
                                }
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LQA4FFVI2BO0WDBKXmORaeypR2plEXgra",
                                "name": "Continue",
                                "title": "Skip this observable",
                                "type": "logic.continue",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Skip this observable",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01LQA4FLOQAAO56Bc8qNKE0VtKH8ieIc126",
                        "name": "Condition Block",
                        "title": "Remediate based on observable type",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Remediate based on observable type",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01LQA4FRJOWD17VCwNR5Bzd8FRt5Xqv6LaE",
                            "name": "Condition Branch",
                            "title": "sha256",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].type$",
                                "operator": "eqi",
                                "right_operand": "sha256"
                              },
                              "continue_on_failure": false,
                              "display_name": "sha256",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LQA4G0CVEDY28zzTScWLnMqfBYBOQ5bPs",
                                "name": "Condition Block",
                                "title": "Do we have a Secure Endpoint module ID?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Do we have a Secure Endpoint module ID?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LQA4G5UWSPC6U2mLaMfzBl2P294mUcWyR",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                        "operator": "ne",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LQCBFSZQ8IY3rPOH0P7e5Dqqp8UoJ62TF",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                              "variable_value_new": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$\n* Triggering Secure Endpoint response action for sha256 hash: $activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].value$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LQA4GFBIZ286mCiSxnbrTY7CMlXfK1OEX",
                                        "name": "Threat Response - Trigger Response Action",
                                        "title": "Threat Response - Trigger Response Action",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Threat Response - Trigger Response Action",
                                          "input": {
                                            "variable_workflow_01PP78A5DV9V56KZdyeivoLTMkTbz5ekKij": "",
                                            "variable_workflow_01PP78A5DVEZD4w3lMF930OCo7g09iIEXaA": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].type$",
                                            "variable_workflow_01PP78A5DVG8Z4DyPKNPwN8vRnZZjPMX6Kv": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].value$",
                                            "variable_workflow_01PP78A5DVHGO154mbjdWl8LrFNbWQh1BLW": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                            "variable_workflow_01PP78A5DVINP4cS0HN9ZngNtE0GuQBPVBv": "amp-add-sha256-scd"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
                                          "workflow_name": "Threat Response - Trigger Response Action"
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LQCCD56CSLI1A86qRMMGEupSWy6aidyNb",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                        "operator": "eq",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LQCCN4B8BK06JCYIzb5XlrCTGEuhod3T6",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                              "variable_value_new": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$\n* Unable to trigger Secure Endpoint response action for sha256 hash: $activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].value$ (no Secure Endpoint module detected)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LQA4GSIE3HJ0TfmFw61WutGJortwtCJbK",
                            "name": "Condition Branch",
                            "title": "Domain",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].type$",
                                "operator": "eqi",
                                "right_operand": "domain"
                              },
                              "continue_on_failure": false,
                              "display_name": "Domain",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LQCDL0POZD163ZRKCG3J7ZvT9rhIZrBdU",
                                "name": "Replace String",
                                "title": "Sanitize the domain",
                                "type": "core.replacestring",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Sanitize the domain",
                                  "input_string": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].value$",
                                  "replace_list": [
                                    {
                                      "replaced_string": ".",
                                      "replacement_string": "[.]"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LQA4H0O8GPD7IxpsgIEHlRlfK3LSFdqFo",
                                "name": "Condition Block",
                                "title": "Do we have an Umbrella module ID?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Do we have an Umbrella module ID?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LQA4H6GA4232357UjnJa8mPzOMHu3yZtv",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7MWX051majkqz4KodFSdK8BRJNZ$",
                                        "operator": "ne",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LQCD7X4MWA537UB74xHyW6SUtEc6Yc6Ls",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                              "variable_value_new": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$\n* Triggering Umbrella response action for domain: $activity.definition_activity_01LQCDL0POZD163ZRKCG3J7ZvT9rhIZrBdU.output.result_string$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LQA4HH25W3G6UROkUDjGDWwYjWDV4U7Eh",
                                        "name": "Threat Response - Trigger Response Action",
                                        "title": "Threat Response - Trigger Response Action",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Threat Response - Trigger Response Action",
                                          "input": {
                                            "variable_workflow_01PP78A5DV9V56KZdyeivoLTMkTbz5ekKij": "",
                                            "variable_workflow_01PP78A5DVEZD4w3lMF930OCo7g09iIEXaA": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].type$",
                                            "variable_workflow_01PP78A5DVG8Z4DyPKNPwN8vRnZZjPMX6Kv": "$activity.definition_activity_01LQA4EMTKKD22Fy3AtCJxymDu9m6Jc1dVo.input.source_array[@].value$",
                                            "variable_workflow_01PP78A5DVHGO154mbjdWl8LrFNbWQh1BLW": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7MWX051majkqz4KodFSdK8BRJNZ$",
                                            "variable_workflow_01PP78A5DVINP4cS0HN9ZngNtE0GuQBPVBv": "block"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
                                          "workflow_name": "Threat Response - Trigger Response Action"
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LQCCZ387VXZ0yAUDrcUIrOakMqFyEljq6",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7MWX051majkqz4KodFSdK8BRJNZ$",
                                        "operator": "eq",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LQCD2VOPH2658lIjYwrnjyduTu25yrbQK",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                              "variable_value_new": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$\n* Unable to trigger Umbrella response action for domain: $activity.definition_activity_01LQCDL0POZD163ZRKCG3J7ZvT9rhIZrBdU.output.result_string$ (no Umbrella module detected)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LQA4HTXQQWI2PFQejnkG5D6zNPQdZjv55",
                    "name": "Read Table from JSON",
                    "title": "Convert the targets to a table",
                    "type": "corejava.read_table_from_json",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Convert the targets to a table",
                      "input_json": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NB162pOsKvh0MYscpUAdDCmsAu$",
                      "jsonpath_query": "$.",
                      "persist_output": false,
                      "populate_columns": false,
                      "skip_execution": false,
                      "table_columns": [
                        {
                          "column_name": "type",
                          "column_type": "string"
                        },
                        {
                          "column_name": "value",
                          "column_type": "string"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LQA4I3REVQG1C1roYCM09a7vjx0bYnUhi",
                    "name": "Condition Block",
                    "title": "Are there any endpoints to process?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Are there any endpoints to process?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01LQA4I9OG67N353qQUV15gs6FL8iiEyeIj",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01LQA4HTXQQWI2PFQejnkG5D6zNPQdZjv55.output.row_count$",
                            "operator": "gt",
                            "right_operand": 0
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LQA4ILM1S2J5R1Z4r2miqBUBkkoJ6mTOu",
                            "name": "Threat Response - Generate Orbital Access Token",
                            "title": "Threat Response - Generate Orbital Access Token",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response - Generate Orbital Access Token",
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Orbital_For_Access_Token"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                              "workflow_name": "Threat Response - Generate Access Token"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj",
                            "name": "For Each",
                            "title": "For each target",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "For each target",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01LQA4HTXQQWI2PFQejnkG5D6zNPQdZjv55.output.read_table_from_json$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LQA4J9D4EGE5Ki4Gkq7uYyQOq3WDoEVyQ",
                                "name": "Orbital - Query Endpoint",
                                "title": "Orbital - Query Endpoint",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Orbital - Query Endpoint",
                                  "input": {
                                    "variable_workflow_01PQ89Y78TFQW6l81VWArKdsXi6aTo6ttQ0": "forensic-snapshot-windows-0.0.6",
                                    "variable_workflow_01PQ89Y78TJW122COMKV4v5IaRfd0rHmKya": 5,
                                    "variable_workflow_01PQ89Y78TL4S4gpTXEcizKNehfpT57GFfH": "",
                                    "variable_workflow_01PQ89Y78TNHZ1ejIRsg03CgWYqamCUu6fr": "$activity.definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj.input.source_array[@].value$",
                                    "variable_workflow_01PQ89Y78TQXF6sxdOzpuMy2ywJ5cfMO7tJ": "",
                                    "variable_workflow_01PQ89Y78TS3M5dh6fdlDmbg7Le3dYWSgik": "",
                                    "variable_workflow_01PQ89Y78TT7A5llxo9E9lASXTaGfke42en": "",
                                    "variable_workflow_01PQ89Y78TUBI7FD5G2DozkMtabDoLrOKty": "SolarWinds - Snapshot for $activity.definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj.input.source_array[@].value$",
                                    "variable_workflow_01PQ89Y78TVI01vdmVFTvVgvkyDjRy3dqcR": false,
                                    "variable_workflow_01PQ89Y78TWRE5UDFeOBcXf0IXKBD4SMiNb": "",
                                    "variable_workflow_01PQ89Y78TZDC3GfT8KI2vHAVvZgDEtWRpC": "$activity.definition_activity_01LQA4ILM1S2J5R1Z4r2miqBUBkkoJ6mTOu.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$",
                                    "variable_workflow_01SW18ZLIVG2F3McJVhYbPQo4Zb3U6isvgV": "0",
                                    "variable_workflow_01SW1C83X3NZY2YAbLNighlSpRdpMlD6Knq": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Orbital_Target"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01PQ89Y7GHRYN1Po7FXaw3jvoMHv5VaAlG1",
                                  "workflow_name": "Orbital - Query Endpoint"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LQA4JM5D0J11CK23B1t5Plt201vtmZawN",
                                "name": "Condition Block",
                                "title": "Do we have a Secure Endpoint module ID?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Do we have a Secure Endpoint module ID?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LQA4JRQVTKE6vZToK66FzXXjEJ2okNwM7",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                        "operator": "ne",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LQCECYAZ5IU7ArI42gpYfVX1uKqPC9vny",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                              "variable_value_new": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$\n* Executing forensic snapshot and Secure Endpoint host isolation for GUID: $activity.definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj.input.source_array[@].value$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LQA4K1G6Q5S4xISfEUVjPz6SuBHohMgHQ",
                                        "name": "Threat Response - Trigger Response Action",
                                        "title": "Threat Response - Trigger Response Action",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Threat Response - Trigger Response Action",
                                          "input": {
                                            "variable_workflow_01PP78A5DV9V56KZdyeivoLTMkTbz5ekKij": "",
                                            "variable_workflow_01PP78A5DVEZD4w3lMF930OCo7g09iIEXaA": "$activity.definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj.input.source_array[@].type$",
                                            "variable_workflow_01PP78A5DVG8Z4DyPKNPwN8vRnZZjPMX6Kv": "$activity.definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj.input.source_array[@].value$",
                                            "variable_workflow_01PP78A5DVHGO154mbjdWl8LrFNbWQh1BLW": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                            "variable_workflow_01PP78A5DVINP4cS0HN9ZngNtE0GuQBPVBv": "amp-start-isolation-amp-computer-guid"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
                                          "workflow_name": "Threat Response - Trigger Response Action"
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LQCFDE9WS912l9aEN3PsRdm9ZjhtH0mTq",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N2782rAj75kNVVS1dkh5ZfKEEn$",
                                        "operator": "eq",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LQCFN4EO0YP3qU9V51u4ITSESoJgMR3uY",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                              "variable_value_new": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$\n* Triggered forensic snapshot for GUID: $activity.definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj.input.source_array[@].value$\n* Unable to trigger Secure Endpoint host isolation for GUID: $activity.definition_activity_01LQA4ITUGNBO1pYPuzjEGNMeFq8ctmsDIj.input.source_array[@].value$ (no Secure Endpoint module detected)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LQCQRVJ981B6aP3J4rv1XOs0NzgLYRCh8",
                "name": "Condition Branch",
                "title": "Rejected",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01LQA48G4BZFC0UCul81QKGubOoQuYkl74c.output.response$",
                    "operator": "eqi",
                    "right_operand": "Reject"
                  },
                  "continue_on_failure": false,
                  "display_name": "Rejected",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQCRKZV9KL70Kkf0tFjSzzps8IXnEtNyN",
                    "name": "Set Variables",
                    "title": "Update remediation text",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update remediation text",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                          "variable_value_new": "**Automated remediation was rejected by $activity.definition_activity_01LQA48G4BZFC0UCul81QKGubOoQuYkl74c.output.assignee_responses[0].assignee$ for workflow instance: https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/orch-ui/runs/$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.output.instance_id$**"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LQCT2IVX2ZD6XbJw4jcpGQRgfi7aVohmh",
                "name": "Condition Branch",
                "title": "Something else",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01LQA48G4BZFC0UCul81QKGubOoQuYkl74c.output.response$",
                      "operator": "ne",
                      "right_operand": "Approve"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01LQA48G4BZFC0UCul81QKGubOoQuYkl74c.output.response$",
                      "operator": "ne",
                      "right_operand": "Reject"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Something else",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQCT2LLFEE72Sj3AeTHbxtDIYgPlrIApx",
                    "name": "Set Variables",
                    "title": "Update remediation text",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update remediation text",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                          "variable_value_new": "**The approval task for automated SolarWinds investigation remediation was not acted on for workflow instance: https://$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NE8X4BL0sVq1TGXb38LXv7GO0y$/orch-ui/runs/$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.output.instance_id$**"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQI9VX1HANX3lOiMVv6OyGEZ94kF4yuai",
            "name": "Group",
            "title": "Update ITSM Ticket",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Update ITSM Ticket",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LQI9W22HQGO7EJ6jVFOh6QpYteZQ5DLc7",
                "name": "ServiceNow - Add Work Note to Incident",
                "title": "ServiceNow - Add Work Note to Incident",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "ServiceNow - Add Work Note to Incident",
                  "input": {
                    "variable_workflow_01FMQTASNW19F198DyWHV14WHmkxNhmxaQu": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                    "variable_workflow_01FMQTASNW78T0tgvbFoES84str3rrkOfBq": "v2",
                    "variable_workflow_01FMQVGD9LTQK0vkSN3y7c0YHxc5cWQnVRt": "$activity.definition_activity_01LQA40ZQMYE70xj5Cp53kDZLSBiJKRjxZv.output.variable_workflow_01C0F7F9L7IYM3YXHCizJhunwKtPlSJWEWM$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "ServiceNow"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01FMQTAT3H5VC4NVbonulAhVztfqidbUGlJ",
                  "workflow_name": "ServiceNow - Add Work Note to Incident"
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LQCGIJUKXB15BknqqR7JHAb1WkpbqAVq0",
            "name": "Parallel Block",
            "title": "Send notifications",
            "type": "logic.parallel",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send notifications",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LQCGINI5KLK7KsPZIvSMhhK4ammpmf739",
                "name": "Parallel Branch",
                "title": "Send Webex message",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Send Webex message",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQCGIP8IZGS4gv1vVySRxTWx2JDIJjwoj",
                    "name": "Condition Block",
                    "title": "Was a Webex room provided?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was a Webex room provided?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01LQCGIR390JQ42JX0B881Bhzap40HO0hWQ",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NGBB54aYNtHzu1k3WgZbA48VAJ$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LQCGIT3BSRH48GGCa3jLbhuxVhNoTto3m",
                            "name": "Webex - Search for Room",
                            "title": "Webex - Search for Room",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Webex - Search for Room",
                              "input": {
                                "variable_workflow_01PP790MCX1DN3EitpQebkUyJS65DbwS3nU": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N9U008BtkYC6UOqkypo4MfD4IG$",
                                "variable_workflow_01PP790MCXB392D3R8pxh9fgOTjTde2bcMW": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NGBB54aYNtHzu1k3WgZbA48VAJ$",
                                "variable_workflow_01PP790MCXHP55YE6ylOEITWsWbUFJeyWGv": "",
                                "variable_workflow_01PP790MCXM9W1MUwo85y8iNRCoQuQ4RGNa": ""
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Webex Teams"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
                              "workflow_name": "Webex - Search for Room"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LQCGIVZ4FKM4deKETSpORpSKvSrwiseuS",
                            "name": "Condition Block",
                            "title": "Did we find the room?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Did we find the room?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01LQCGIY5LP7S4eurY0jQw2ZmR2YO9HLWXr",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01LQCGIT3BSRH48GGCa3jLbhuxVhNoTto3m.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01LQCGJ0E0P714yrUobbTFyX8zg3QGcCvqv",
                                    "name": "Webex - Post Message to Room",
                                    "title": "Webex - Post Message to Room",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Webex - Post Message to Room",
                                      "input": {
                                        "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01LQCGIT3BSRH48GGCa3jLbhuxVhNoTto3m.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
                                        "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7N9U008BtkYC6UOqkypo4MfD4IG$",
                                        "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                        "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                                        "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "Webex Teams"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                                      "workflow_name": "Webex - Post Message to Room"
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LQCGJ3V2IRQ601eiUa5Md0xoEM8Y973EM",
                "name": "Parallel Branch",
                "title": "Send Slack message",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Send Slack message",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LQCGJ60IZ4I2NzdOA4cIgS7THfSbatkz7",
                    "name": "Condition Block",
                    "title": "Was a Slack channel provided?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was a Slack channel provided?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01LQCGJ7Y0IQN1idbLDHkAqFFPyyLVz3LWn",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NFA53LeWYM0XIDGYR88m9OCoIM$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LQCGJA0KBDY1Cq2AQWsuUE6Cvnbkb4mMr",
                            "name": "Slack - Send Message to Channel",
                            "title": "Slack - Send Message to Channel",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Slack - Send Message to Channel",
                              "input": {
                                "variable_workflow_01HQNZKTLIV8Z5287vTq4qKrS29IMFD3g7H": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NFA53LeWYM0XIDGYR88m9OCoIM$",
                                "variable_workflow_01HQOXVG5Y94H1B55vC2dK9RzxZSEDLMGkg": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQC9H7M8IQL34YBcsXA3Wt2NHkqNohzeX$",
                                "variable_workflow_01HRF4D5938OI4mcYJ4JF2tkjIAztrs1c2z": "$workflow.definition_workflow_01LQA3KMNO5FO3ikAlUvOc3cLoXQQo6GwUa.local.variable_workflow_01LQA3KM7NHC54z1GyNQIsr2wJtZSSy1aY5$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Slack"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01HQNWMZ0DF0F1hMGyE56KyjIltjC5jQuIY",
                              "workflow_name": "Slack - Send Message to Channel"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
    "definition_workflow_01HQNWMZ0DF0F1hMGyE56KyjIltjC5jQuIY",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
    "definition_workflow_01PP78LW2WNY80aDM6OHNiRu2VPG4BrR8bq",
    "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
    "definition_workflow_01FMQTAT3H5VC4NVbonulAhVztfqidbUGlJ",
    "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
    "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
    "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
    "definition_workflow_01PQ89Y7GHRYN1Po7FXaw3jvoMHv5VaAlG1",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01PP773PI1X3Y1YQWhirIL8Uy40Thd6ND7r",
    "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
    "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
    "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML"
  ],
  "dependent_workflows": [
    "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
    "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
    "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
    "definition_workflow_01PP773PI1X3Y1YQWhirIL8Uy40Thd6ND7r",
    "definition_workflow_01PP78LW2WNY80aDM6OHNiRu2VPG4BrR8bq",
    "definition_workflow_01FMQTAT3H5VC4NVbonulAhVztfqidbUGlJ",
    "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
    "definition_workflow_01HQNWMZ0DF0F1hMGyE56KyjIltjC5jQuIY",
    "definition_workflow_01PP74F8V7XK02YLxMMHUqVt4JVetzJhR9D",
    "definition_workflow_01PP78A5LQXZA7PavA44Ex35KroriQgIjvH",
    "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
    "definition_workflow_01PQ89Y7GHRYN1Po7FXaw3jvoMHv5VaAlG1"
  ]
}