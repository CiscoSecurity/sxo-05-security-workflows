{
  "workflow": {
      "unique_name": "definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo",
      "name": "0007 - SCA - Handle AWS SSH Quarantine Approvals",
      "title": "0007 - SCA - Handle AWS SSH Quarantine Approvals",
      "type": "generic.workflow",
      "base_type": "workflow",
      "variables": [
          {
              "schema_id": "datatype.string",
              "properties": {
                  "value": "",
                  "scope": "local",
                  "name": "Webex Text",
                  "type": "datatype.string",
                  "description": "Placeholder for the text to send via Webex. This will be populated automatically",
                  "is_required": false,
                  "is_invisible": false
              },
              "unique_name": "variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju",
              "object_type": "variable_workflow"
          },
          {
              "schema_id": "datatype.string",
              "properties": {
                  "value": "eu-north-1",
                  "scope": "local",
                  "name": "AWS Region",
                  "type": "datatype.string",
                  "description": "The name of your AWS region",
                  "is_required": false,
                  "is_invisible": false
              },
              "unique_name": "variable_workflow_01KB894O8KM853yOTR8E2xkq5GAFPI0OFN7",
              "object_type": "variable_workflow"
          },
          {
              "schema_id": "datatype.string",
              "properties": {
                  "value": "",
                  "scope": "local",
                  "name": "Webex Room Name",
                  "type": "datatype.string",
                  "description": "The name of the Webex room to post messages to. If you'd rather provide a room ID, leave this blank and set the \"Webex Room ID\" local variable instead",
                  "is_required": false,
                  "is_invisible": false
              },
              "unique_name": "variable_workflow_01KBBUONF9SLZ3PK99uhnivtucQnq8gZFUN",
              "object_type": "variable_workflow"
          },
          {
              "schema_id": "datatype.string",
              "properties": {
                  "value": "",
                  "scope": "local",
                  "name": "Webex Room ID",
                  "type": "datatype.string",
                  "description": "The ID of the Webex room to post messages to. If you'd rather provide a room name, leave this blank and set the \"Webex Room Name\" local variable instead",
                  "is_required": false,
                  "is_invisible": false
              },
              "unique_name": "variable_workflow_01KB7IIMP5C0Z2MWSxCLUXaDnw5z38vrLBS",
              "object_type": "variable_workflow"
          },
          {
              "schema_id": "datatype.secure_string",
              "properties": {
                  "value": "",
                  "scope": "local",
                  "name": "Webex Access Token",
                  "type": "datatype.secure_string",
                  "description": "The access token to use to authenticate to the Webex API. Information about using a bot, which is what we recommend, can be found here: https:\/\/developer.webex.com\/docs\/bots",
                  "is_required": false,
                  "is_invisible": false
              },
              "unique_name": "variable_workflow_01KB7IIMP5FRC0Vj1EBWArdcclVxbFoMP60",
              "object_type": "variable_workflow"
          }
      ],
      "properties": {
          "atomic": {
              "is_atomic": false
          },
          "delete_workflow_instance": false,
          "description": "This workflow is triggered when an Approval Task generated by the \"Quarantine AWS Instances from Alerts\" workflow is approved, denied, or expires. If approved, SSH quarantine restrictions are removed from the Amazon Web Services (AWS) security group.\n\nDocumentation: https:\/\/ciscosecurity.github.io\/sxo-05-security-workflows\/workflows\/0007\n\nTarget Group: Default TargetGroup\n\nTargets: Amazon Web Services, Webex Teams\n\nSteps:\n[] Extract the AWS instance ID from the Approval Task\n[] If a Webex room name was provided, get the room ID\n[] Make sure we got an instance ID (if not, post an error)\n[] Check the approval result. If the user selected to leave the instance quarantined or the task expired, do nothing. If they want to remove quarantine:\n[]> Get information about the instance from AWS and extract its security group\n[]> Restore normal SSH access\n[]> Send a Webex notification",
          "display_name": "0007 - SCA - Handle AWS SSH Quarantine Approvals",
          "runtime_user": {
              "override_target_runtime_user": false,
              "specify_on_workflow_start": false,
              "target_default": true
          },
          "target": {
              "execute_on_target_group": true,
              "target_group": {
                  "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
                  "run_on_all_targets": false,
                  "selected_target_types": [
                      "web-service.endpoint",
                      "aws.endpoint"
                  ],
                  "use_criteria": {
                      "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                      "conditions": [
                          {
                              "operator": "eqi",
                              "left_operand": "$targetgroup.aws endpoint.input.display_name$",
                              "right_operand": "Amazon Web Services"
                          }
                      ]
                  }
              }
          }
      },
      "object_type": "definition_workflow",
      "actions": [
          {
              "unique_name": "definition_activity_01KB7IJECJWX02W1GjZRFlumhvgnccAdiC4",
              "name": "Group",
              "title": "Fetch global variables",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                  "continue_on_failure": false,
                  "display_name": "Fetch global variables",
                  "skip_execution": true
              },
              "object_type": "definition_activity",
              "actions": [
                  {
                      "unique_name": "definition_activity_01KB7IJMIK5PS5O1Bz2gClN1MR4FXo56lsm",
                      "name": "Set Variables",
                      "title": "Fetch global variables",
                      "type": "core.set_multiple_variables",
                      "base_type": "activity",
                      "properties": {
                          "continue_on_failure": false,
                          "display_name": "SFetch global variables",
                          "skip_execution": false,
                          "variables_to_update": [
                              {
                                  "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB7IIMP5FRC0Vj1EBWArdcclVxbFoMP60$",
                                  "variable_value_new": ""
                              }
                          ]
                      },
                      "object_type": "definition_activity"
                  }
              ]
          },
          {
              "unique_name": "definition_activity_01KB8POKU03XA0yvPbo2yIP4c7frxP6F2GD",
              "name": "Set Variables",
              "title": "Set Webex text",
              "type": "core.set_multiple_variables",
              "base_type": "activity",
              "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Webex text",
                  "skip_execution": false,
                  "variables_to_update": [
                      {
                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                          "variable_value_new": "Response received for Secure Cloud Analytics AWS quarantine event. Response: **$trigger.triggerevent_01KB7KXSJ7BQT5MCFZxIH5Ra8akzcB1yJi2.output.response$**"
                      }
                  ]
              },
              "object_type": "definition_activity"
          },
          {
              "unique_name": "definition_activity_01KB7K919QB7L7QDvAxtvcnDD74aN6UHiQv",
              "name": "Match Regex",
              "title": "Extract instance ID",
              "type": "core.matchregex",
              "base_type": "activity",
              "properties": {
                  "continue_on_failure": true,
                  "display_name": "Extract instance ID",
                  "input_regex": "Instance ID: ([a-zA-Z0-9\\-]+)",
                  "input_string": "$trigger.triggerevent_01KB7KXSJ7BQT5MCFZxIH5Ra8akzcB1yJi2.output.task_message$",
                  "skip_execution": false
              },
              "object_type": "definition_activity"
          },
          {
              "unique_name": "definition_activity_01KBBU4FD4INW0jI34Tc6CbRtL43wplsaxV",
              "name": "Condition Block",
              "title": "Was a Webex room name provided?",
              "type": "logic.if_else",
              "base_type": "activity",
              "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was a Webex room name provided?",
                  "skip_execution": false
              },
              "object_type": "definition_activity",
              "blocks": [
                  {
                      "unique_name": "definition_activity_01KBBU4OEU25U7AHYvnulyeRkezSY9UthDt",
                      "name": "Condition Branch",
                      "title": "Yes",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                          "condition": {
                              "left_operand": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KBBUONF9SLZ3PK99uhnivtucQnq8gZFUN$",
                              "operator": "ne",
                              "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                          {
                              "unique_name": "definition_activity_01KBBUZIHTPV80zgv23YUQeEuEUqVxo2oFh",
                              "name": "Webex - Search for Room",
                              "title": "Webex - Search for Room",
                              "type": "workflow.atomic_workflow",
                              "base_type": "subworkflow",
                              "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Webex - Search for Room",
                                  "input": {
                                      "variable_workflow_01PP790MCX1DN3EitpQebkUyJS65DbwS3nU": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB7IIMP5FRC0Vj1EBWArdcclVxbFoMP60$",
                                      "variable_workflow_01PP790MCXB392D3R8pxh9fgOTjTde2bcMW": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KBBUONF9SLZ3PK99uhnivtucQnq8gZFUN$",
                                      "variable_workflow_01PP790MCXHP55YE6ylOEITWsWbUFJeyWGv": "",
                                      "variable_workflow_01PP790MCXM9W1MUwo85y8iNRCoQuQ4RGNa": ""
                                  },
                                  "runtime_user": {
                                      "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                      "override_workflow_target_group_criteria": true,
                                      "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                              "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                              "conditions": [
                                                  {
                                                      "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                      "operator": "eqi",
                                                      "right_operand": "Webex Teams"
                                                  }
                                              ]
                                          }
                                      }
                                  },
                                  "workflow_id": "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
                                  "workflow_name": "Webex - Search for Room"
                              },
                              "object_type": "definition_activity"
                          },
                          {
                              "unique_name": "definition_activity_01KBBVH08KP700yhzV2OvNJgFei0CrQ8WnP",
                              "name": "Set Variables",
                              "title": "Set room ID variable",
                              "type": "core.set_multiple_variables",
                              "base_type": "activity",
                              "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set room ID variable",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                      {
                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB7IIMP5C0Z2MWSxCLUXaDnw5z38vrLBS$",
                                          "variable_value_new": "$activity.definition_activity_01KBBUZIHTPV80zgv23YUQeEuEUqVxo2oFh.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$"
                                      }
                                  ]
                              },
                              "object_type": "definition_activity"
                          }
                      ]
                  }
              ]
          },
          {
              "unique_name": "definition_activity_01KB86MR0HMKW0R7nDs999I61mO6O2VkAT4",
              "name": "Condition Block",
              "title": "Did we get the instance ID?",
              "type": "logic.if_else",
              "base_type": "activity",
              "properties": {
                  "continue_on_failure": false,
                  "display_name": "Did we get the instance ID?",
                  "skip_execution": false
              },
              "object_type": "definition_activity",
              "blocks": [
                  {
                      "unique_name": "definition_activity_01KB86MZZ5ISJ2o3icHjBSLBl8kud1uIHVu",
                      "name": "Condition Branch",
                      "title": "No",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                          "condition": {
                              "left_operand": {
                                  "left_operand": "$activity.definition_activity_01KB7K919QB7L7QDvAxtvcnDD74aN6UHiQv.output.succeeded$",
                                  "operator": "eq",
                                  "right_operand": false
                              },
                              "operator": "or",
                              "right_operand": {
                                  "left_operand": "$activity.definition_activity_01KB7K919QB7L7QDvAxtvcnDD74aN6UHiQv.output.has_match$",
                                  "operator": "eq",
                                  "right_operand": false
                              }
                          },
                          "continue_on_failure": false,
                          "display_name": "No",
                          "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                          {
                              "unique_name": "definition_activity_01KB87BTYJPUF0padYuhvMzVYPto2NGkoJh",
                              "name": "Webex - Post Message to Room",
                              "title": "Webex - Post Message to Room",
                              "type": "workflow.atomic_workflow",
                              "base_type": "subworkflow",
                              "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Webex - Post Message to Room",
                                  "input": {
                                      "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB7IIMP5C0Z2MWSxCLUXaDnw5z38vrLBS$",
                                      "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB7IIMP5FRC0Vj1EBWArdcclVxbFoMP60$",
                                      "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$\\n **Failed to get the instance ID from the approval message**",
                                      "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                                      "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                                  },
                                  "runtime_user": {
                                      "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                      "override_workflow_target_group_criteria": true,
                                      "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                              "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                              "conditions": [
                                                  {
                                                      "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                      "operator": "eqi",
                                                      "right_operand": "Webex Teams"
                                                  }
                                              ]
                                          }
                                      }
                                  },
                                  "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                                  "workflow_name": "Webex - Post Message to Room"
                              },
                              "object_type": "definition_activity"
                          },
                          {
                              "unique_name": "definition_activity_01KBC1PHUXL4P6duSCeNaE0WDIgECQt02d2",
                              "name": "Completed",
                              "title": "End the workflow",
                              "type": "logic.completed",
                              "base_type": "activity",
                              "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "End the workflow",
                                  "result_message": "Failed to extract instance ID from approval task message",
                                  "skip_execution": false
                              },
                              "object_type": "definition_activity"
                          }
                      ]
                  }
              ]
          },
          {
              "unique_name": "definition_activity_01KB7IQFGEWH90vy4RCBmkSiuKC9PI0hZ5e",
              "name": "Condition Block",
              "title": "What was the result?",
              "type": "logic.if_else",
              "base_type": "activity",
              "properties": {
                  "continue_on_failure": false,
                  "display_name": "What was the result?",
                  "skip_execution": false
              },
              "object_type": "definition_activity",
              "blocks": [
                  {
                      "unique_name": "definition_activity_01KB7IQMNB8RT5hOGV67WepMtmwd26hd80B",
                      "name": "Condition Branch",
                      "title": "Disable quarantine",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                          "condition": {
                              "left_operand": "$trigger.triggerevent_01KB7KXSJ7BQT5MCFZxIH5Ra8akzcB1yJi2.output.response$",
                              "operator": "eqi",
                              "right_operand": "Disable Quarantine"
                          },
                          "continue_on_failure": false,
                          "display_name": "Disable quarantine",
                          "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                          {
                              "unique_name": "definition_activity_01KB8D7J865B86aBBs76ld86QJYeLc97gEO",
                              "name": "JSONPath Query",
                              "title": "Extract instance ID from JSON",
                              "type": "corejava.jsonpathquery",
                              "base_type": "activity",
                              "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": false,
                                  "display_name": "Extract instance ID from JSON",
                                  "input_json": "$activity.definition_activity_01KB7K919QB7L7QDvAxtvcnDD74aN6UHiQv.output.match_groups$",
                                  "jsonpath_queries": [
                                      {
                                          "jsonpath_query": "$.[0].Group1",
                                          "jsonpath_query_name": "instanceId",
                                          "jsonpath_query_type": "string"
                                      }
                                  ],
                                  "skip_execution": false
                              },
                              "object_type": "definition_activity"
                          },
                          {
                              "unique_name": "definition_activity_01KB8QR8U7TFF1ews7kpYXGtHLylgfsrM0H",
                              "name": "Set Variables",
                              "title": "Set Webex text",
                              "type": "core.set_multiple_variables",
                              "base_type": "activity",
                              "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Webex text",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                      {
                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                                          "variable_value_new": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$  \\n Removing SSH restrictions from security group for instance `$activity.definition_activity_01KB8D7J865B86aBBs76ld86QJYeLc97gEO.output.jsonpath_queries.instanceId$`"
                                      }
                                  ]
                              },
                              "object_type": "definition_activity"
                          },
                          {
                              "unique_name": "definition_activity_01KB7IMVQHNMH0YPoVrDNZDK1t1bVke7uDv",
                              "name": "Generic AWS API Request",
                              "title": "Get instance information from AWS",
                              "type": "aws.api_request",
                              "base_type": "activity",
                              "properties": {
                                  "action_timeout": 180,
                                  "api_call_method": "ec2",
                                  "api_url": "https:\/\/ec2.$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB894O8KM853yOTR8E2xkq5GAFPI0OFN7$.amazonaws.com\/?Action=DescribeInstances&InstanceId.1=$activity.definition_activity_01KB8D7J865B86aBBs76ld86QJYeLc97gEO.output.jsonpath_queries.instanceId$&Version=2016-11-15",
                                  "continue_on_failure": true,
                                  "display_name": "Get instance information from AWS",
                                  "runtime_user": {
                                      "override_target_runtime_user": false,
                                      "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                      "use_workflow_target_group": true
                                  }
                              },
                              "object_type": "definition_activity"
                          },
                          {
                              "unique_name": "definition_activity_01KB7IN3M31TM4MVL3VjCDZFoVVDbWjd7TM",
                              "name": "Condition Block",
                              "title": "Did we get instance information?",
                              "type": "logic.if_else",
                              "base_type": "activity",
                              "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Did we get instance information?",
                                  "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "blocks": [
                                  {
                                      "unique_name": "definition_activity_01KB7INB2DXX64RkIPapWAh4NDHXwnjbvKl",
                                      "name": "Condition Branch",
                                      "title": "Yes",
                                      "type": "logic.condition_block",
                                      "base_type": "activity",
                                      "properties": {
                                          "condition": {
                                              "left_operand": "$activity.definition_activity_01KB7IMVQHNMH0YPoVrDNZDK1t1bVke7uDv.output.succeeded$",
                                              "operator": "eq",
                                              "right_operand": true
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "Yes",
                                          "skip_execution": false
                                      },
                                      "object_type": "definition_activity",
                                      "actions": [
                                          {
                                              "unique_name": "definition_activity_01KB7INOVOPRL2bEBOx7q6Dq8ImyBl9dpo2",
                                              "name": "XPath Query",
                                              "title": "Extract security group",
                                              "type": "core.xpathquery",
                                              "base_type": "activity",
                                              "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Extract security group",
                                                  "input_xml": "$activity.definition_activity_01KB7IMVQHNMH0YPoVrDNZDK1t1bVke7uDv.output.response_body$",
                                                  "skip_execution": false,
                                                  "xpath_queries": [
                                                      {
                                                          "xpath_query": "\/DescribeInstancesResponse\/reservationSet\/item[1]\/instancesSet\/item[1]\/groupSet\/item[1]\/groupName",
                                                          "xpath_query_name": "groupName",
                                                          "xpath_query_type": "string"
                                                      },
                                                      {
                                                          "xpath_query": "\/DescribeInstancesResponse\/reservationSet\/item[1]\/instancesSet\/item[1]\/groupSet\/item[1]\/groupId",
                                                          "xpath_query_name": "groupId",
                                                          "xpath_query_type": "string"
                                                      }
                                                  ]
                                              },
                                              "object_type": "definition_activity"
                                          },
                                          {
                                              "unique_name": "definition_activity_01KB8RH65881D6jtRKFNNx8AxvlSAnj0N3L",
                                              "name": "Set Variables",
                                              "title": "Set Webex text",
                                              "type": "core.set_multiple_variables",
                                              "base_type": "activity",
                                              "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Set Webex text",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                      {
                                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                                                          "variable_value_new": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$  \\n Security group for instance: `$activity.definition_activity_01KB7INOVOPRL2bEBOx7q6Dq8ImyBl9dpo2.output.xpath_queries.groupName$ ($activity.definition_activity_01KB7INOVOPRL2bEBOx7q6Dq8ImyBl9dpo2.output.xpath_queries.groupId$)`"
                                                      }
                                                  ]
                                              },
                                              "object_type": "definition_activity"
                                          },
                                          {
                                              "unique_name": "definition_activity_01KB7IQRXSSE30U7faaIO6JcruiJTm0QcDl",
                                              "name": "Generic AWS API Request",
                                              "title": "Restore SSH access",
                                              "type": "aws.api_request",
                                              "base_type": "activity",
                                              "properties": {
                                                  "action_timeout": 180,
                                                  "api_call_method": "ec2",
                                                  "api_url": "https:\/\/ec2.$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB894O8KM853yOTR8E2xkq5GAFPI0OFN7$.amazonaws.com\/?Action=AuthorizeSecurityGroupIngress&GroupName.1=$activity.definition_activity_01KB7INOVOPRL2bEBOx7q6Dq8ImyBl9dpo2.output.xpath_queries.groupName$&Version=2016-11-15&IpPermissions.1.IpProtocol=tcp&IpPermissions.1.FromPort=22&IpPermissions.1.ToPort=22&IpPermissions.1.IpRanges.1.CidrIp=0.0.0.0\/0",
                                                  "continue_on_failure": true,
                                                  "display_name": "Restore SSH access",
                                                  "runtime_user": {
                                                      "override_target_runtime_user": false,
                                                      "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                      "use_workflow_target_group": true
                                                  }
                                              },
                                              "object_type": "definition_activity"
                                          },
                                          {
                                              "unique_name": "definition_activity_01KB7IR0I7QU87478Vz6o7lpPaMD1QyjRcQ",
                                              "name": "Condition Block",
                                              "title": "Was restoration successful?",
                                              "type": "logic.if_else",
                                              "base_type": "activity",
                                              "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Was restoration successful?",
                                                  "skip_execution": false
                                              },
                                              "object_type": "definition_activity",
                                              "blocks": [
                                                  {
                                                      "unique_name": "definition_activity_01KB7IR7YZWLA3Hw3R55HuLXiXpI0edC9le",
                                                      "name": "Condition Branch",
                                                      "title": "Yes",
                                                      "type": "logic.condition_block",
                                                      "base_type": "activity",
                                                      "properties": {
                                                          "condition": {
                                                              "left_operand": "$activity.definition_activity_01KB7IQRXSSE30U7faaIO6JcruiJTm0QcDl.output.succeeded$",
                                                              "operator": "eq",
                                                              "right_operand": true
                                                          },
                                                          "continue_on_failure": false,
                                                          "display_name": "Yes",
                                                          "skip_execution": false
                                                      },
                                                      "object_type": "definition_activity",
                                                      "actions": [
                                                          {
                                                              "unique_name": "definition_activity_01KBBRPYK3G5131SHcXVLpdPPYQv9Mx3iOY",
                                                              "name": "Set Variables",
                                                              "title": "Set Webex text",
                                                              "type": "core.set_multiple_variables",
                                                              "base_type": "activity",
                                                              "properties": {
                                                                  "continue_on_failure": false,
                                                                  "display_name": "Set Webex text",
                                                                  "skip_execution": false,
                                                                  "variables_to_update": [
                                                                      {
                                                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                                                                          "variable_value_new": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$  \\n Service restored successfully!"
                                                                      }
                                                                  ]
                                                              },
                                                              "object_type": "definition_activity"
                                                          }
                                                      ]
                                                  },
                                                  {
                                                      "unique_name": "definition_activity_01KB7IRQLCV504t4NIHoO1CrKyWzOPDtrZX",
                                                      "name": "Condition Branch",
                                                      "title": "No",
                                                      "type": "logic.condition_block",
                                                      "base_type": "activity",
                                                      "properties": {
                                                          "condition": {
                                                              "left_operand": "$activity.definition_activity_01KB7IQRXSSE30U7faaIO6JcruiJTm0QcDl.output.succeeded$",
                                                              "operator": "eq",
                                                              "right_operand": false
                                                          },
                                                          "continue_on_failure": false,
                                                          "display_name": "No",
                                                          "skip_execution": false
                                                      },
                                                      "object_type": "definition_activity",
                                                      "actions": [
                                                          {
                                                              "unique_name": "definition_activity_01KBBSD01BNLY04vq1vbJt2FQSyhYHCa2Z6",
                                                              "name": "Set Variables",
                                                              "title": "Set Webex text",
                                                              "type": "core.set_multiple_variables",
                                                              "base_type": "activity",
                                                              "properties": {
                                                                  "continue_on_failure": false,
                                                                  "display_name": "Set Webex text",
                                                                  "skip_execution": false,
                                                                  "variables_to_update": [
                                                                      {
                                                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                                                                          "variable_value_new": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$  \\n **Failed to restore service!**"
                                                                      }
                                                                  ]
                                                              },
                                                              "object_type": "definition_activity"
                                                          }
                                                      ]
                                                  }
                                              ]
                                          }
                                      ]
                                  },
                                  {
                                      "unique_name": "definition_activity_01KB7IUASW1G01GpRPI735qHIoPncOCOioR",
                                      "name": "Condition Branch",
                                      "title": "No",
                                      "type": "logic.condition_block",
                                      "base_type": "activity",
                                      "properties": {
                                          "condition": {
                                              "left_operand": "$activity.definition_activity_01KB7IMVQHNMH0YPoVrDNZDK1t1bVke7uDv.output.succeeded$",
                                              "operator": "eq",
                                              "right_operand": false
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "No",
                                          "skip_execution": false
                                      },
                                      "object_type": "definition_activity",
                                      "actions": [
                                          {
                                              "unique_name": "definition_activity_01KBBRBVCIWEL3314jj6HxpvsAn6o8aRtdY",
                                              "name": "Set Variables",
                                              "title": "Set Webex text",
                                              "type": "core.set_multiple_variables",
                                              "base_type": "activity",
                                              "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Set Webex text",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                      {
                                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                                                          "variable_value_new": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$  \\n **Failed to fetch instance information from AWS**"
                                                      }
                                                  ]
                                              },
                                              "object_type": "definition_activity"
                                          }
                                      ]
                                  }
                              ]
                          }
                      ]
                  },
                  {
                      "unique_name": "definition_activity_01KB7IS9R769J0cPCj0GmX5Ydlq8jWgLDQ1",
                      "name": "Condition Branch",
                      "title": "Leave quarantined",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                          "condition": {
                              "left_operand": "$trigger.triggerevent_01KB7KXSJ7BQT5MCFZxIH5Ra8akzcB1yJi2.output.response$",
                              "operator": "eqi",
                              "right_operand": "Leave Quarantined"
                          },
                          "continue_on_failure": false,
                          "display_name": "Leave quarantined",
                          "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                          {
                              "unique_name": "definition_activity_01KBBSVAKKLGC0xdvDN25eifFzSYxWLMk0P",
                              "name": "Set Variables",
                              "title": "Set Webex text",
                              "type": "core.set_multiple_variables",
                              "base_type": "activity",
                              "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Webex text",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                      {
                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                                          "variable_value_new": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$  \\n **No action will be taken**"
                                      }
                                  ]
                              },
                              "object_type": "definition_activity"
                          }
                      ]
                  },
                  {
                      "unique_name": "definition_activity_01KB7ISSLR6762MYtLTpdO0qiIYVEekbrcJ",
                      "name": "Condition Branch",
                      "title": "Expired",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                          "condition": {
                              "left_operand": "$trigger.triggerevent_01KB7KXSJ7BQT5MCFZxIH5Ra8akzcB1yJi2.output.response$",
                              "operator": "eqi",
                              "right_operand": "Expired"
                          },
                          "continue_on_failure": false,
                          "display_name": "Expired",
                          "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                          {
                              "unique_name": "definition_activity_01KBBSYVTY72K0cjQaS22x84AQZeyNkHRgi",
                              "name": "Set Variables",
                              "title": "Set Webex text",
                              "type": "core.set_multiple_variables",
                              "base_type": "activity",
                              "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Webex text",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                      {
                                          "variable_to_update": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                                          "variable_value_new": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$  \\n **No action will be taken**"
                                      }
                                  ]
                              },
                              "object_type": "definition_activity"
                          }
                      ]
                  }
              ]
          },
          {
              "unique_name": "definition_activity_01KB7RJ7IADUL4FHNmy3oR4Mf9MGbnDdzBY",
              "name": "Webex - Post Message to Room",
              "title": "Webex - Post Message to Room",
              "type": "workflow.atomic_workflow",
              "base_type": "subworkflow",
              "properties": {
                  "continue_on_failure": false,
                  "display_name": "Webex - Post Message to Room",
                  "input": {
                      "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB7IIMP5C0Z2MWSxCLUXaDnw5z38vrLBS$",
                      "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB7IIMP5FRC0Vj1EBWArdcclVxbFoMP60$",
                      "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "$workflow.definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo.local.variable_workflow_01KB8PM8NFGJB5SAVlXhBPwtmvUwtiy7Eju$",
                      "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                      "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                  },
                  "runtime_user": {
                      "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                      "override_workflow_target_group_criteria": true,
                      "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                              "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                              "conditions": [
                                  {
                                      "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                      "operator": "eqi",
                                      "right_operand": "Webex Teams"
                                  }
                              ]
                          }
                      }
                  },
                  "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                  "workflow_name": "Webex - Post Message to Room"
              },
              "object_type": "definition_activity"
          }
      ],
      "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
      ]
  },
  "triggers": {
      "triggerevent_01KB7KXSJ7BQT5MCFZxIH5Ra8akzcB1yJi2": {
          "workflow_id": "definition_workflow_01KB7IIMZN9BP0qtnpiqeNnkg14mgEjiILo",
          "name": "Handle AWS Quarantine Approvals",
          "title": "",
          "lowercase_name": "event.handle_aws_quarantine_approvals",
          "type": "event",
          "base_type": "trigger",
          "ref_id": "event_01KB7IEFMO1Y95J8s8TFfVnbPNrGQHaJdRX",
          "version": "1.0.0",
          "disabled": false,
          "unique_name": "triggerevent_01KB7KXSJ7BQT5MCFZxIH5Ra8akzcB1yJi2",
          "object_type": "triggerevent"
      }
  },
  "events": {
      "event_01KB7IEFMO1Y95J8s8TFfVnbPNrGQHaJdRX": {
          "name": "0007 - Handle AWS Quarantine Approvals",
          "title": "0007 - Handle AWS Quarantine Approvals",
          "type": "approval_task.event",
          "base_type": "event",
          "object_type": "event",
          "target_id": "",
          "webhook_id": "",
          "version": "1.0.0",
          "properties": {
              "conditions": {
                  "left_operand": {
                      "left_operand": "$output.subject_line$",
                      "operator": "eqi",
                      "right_operand": "Disable SSH Quarantine for AWS Instance"
                  },
                  "operator": "and",
                  "right_operand": {
                      "left_operand": "$output.response$",
                      "operator": "mregex",
                      "right_operand": ".{2,}$"
                  }
              },
              "display_name": "Handle AWS quarantine approvals",
              "title": "0007 - Handle AWS Quarantine Approvals"
          },
          "unique_name": "event_01KB7IEFMO1Y95J8s8TFfVnbPNrGQHaJdRX"
      }
  },
  "target_groups": {
      "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
          "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "name": "Default TargetGroup",
          "title": "Default TargetGroup",
          "type": "generic.target_group",
          "base_type": "target_group",
          "version": "1.0.0",
          "targets": [
              {
                  "data_target_type": "web-service.endpoint",
                  "view_target_type": "web-service.endpoint",
                  "include_all_targets": true
              },
              {
                  "data_target_type": "email.smtp_endpoint",
                  "view_target_type": "email.smtp_endpoint",
                  "include_all_targets": true
              },
              {
                  "data_target_type": "aws.endpoint",
                  "view_target_type": "aws.endpoint",
                  "include_all_targets": true
              }
          ],
          "object_type": "target_group"
      }
  },
  "atomic_workflows": [
      "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
      "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
  ],
  "dependent_workflows": [
      "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
      "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
  ]
}