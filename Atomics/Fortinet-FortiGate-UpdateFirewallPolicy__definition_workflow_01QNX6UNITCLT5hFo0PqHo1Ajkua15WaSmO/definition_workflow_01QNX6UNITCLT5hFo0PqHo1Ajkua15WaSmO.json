{
	"workflow": {
	  "unique_name": "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO",
	  "name": "Fortinet - FortiGate - Update Firewall Policy",
	  "title": "Fortinet - FortiGate - Update Firewall Policy",
	  "type": "generic.workflow",
	  "base_type": "workflow",
	  "variables": [
		{
		  "schema_id": "datatype.secure_string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Access Token",
			"type": "datatype.secure_string",
			"description": "Access token for the FortiGate API. This can be generated by creating a new REST API Admin under System > Administrators",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Destination Address",
			"type": "datatype.string",
			"description": "Destination address or address group name",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Policy JSON",
			"type": "datatype.string",
			"description": "JSON of the existing firewall policy. If this is provided, it will be used during the policy update. If not, the policy's JSON will be fetched",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Web Filter",
			"type": "datatype.string",
			"description": "Name of an existing web filter profile. This can only be used when the policy action is \"Allow\"",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "root",
			"scope": "input",
			"name": "VDOM",
			"type": "datatype.string",
			"description": "The virtual domain (VDOM) to query. Sample values:\nroot (Single VDOM)\nvdom1,vdom2 (Multiple VDOMs)\n* (All VDOMs)",
			"is_required": true,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Action",
			"type": "datatype.string",
			"description": "The action to apply to the matching traffic. Valid values include: Deny, Accept",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01SOKPX0NFW0L464aL9t0vEyBowlnCQjman",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Policy ID",
			"type": "datatype.string",
			"description": "ID of the firewall policy to update",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Source Address",
			"type": "datatype.string",
			"description": "Source address or address group name",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "input",
			"name": "Service",
			"type": "datatype.string",
			"description": "Service or service group name",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01SOKQ5CWNBD70J1ywhGt6lYQlQmK7KVnDX",
		  "object_type": "variable_workflow"
		},
		{
		  "schema_id": "datatype.string",
		  "properties": {
			"value": "",
			"scope": "output",
			"name": "Output Policy JSON",
			"type": "datatype.string",
			"description": "The updated policy in JSON format",
			"is_required": false,
			"is_invisible": false
		  },
		  "unique_name": "variable_workflow_01QNX6UNA0Y233D5aY7DqEsToofrpirMWyD",
		  "object_type": "variable_workflow"
		}
	  ],
	  "properties": {
		"atomic": {
		  "atomic_group": "Fortinet FortiGate",
		  "is_atomic": true
		},
		"delete_workflow_instance": false,
		"description": "Adds an address, address group, and/or web filter to a firewall policy. If a policy's JSON is provided, that will be used for the update. If a policy's ID is provided, the policy JSON will be fetched.\n\nNote: You may need to use a SecureX Orchestration Remote to communicate with FortiGate Firewall if it's on-premise. See: https://cs.co/SXO_remote\n\nTarget: HTTP Endpoint for your FortiGate instance with a path of \"api/\"\n\nAccount Key: None (uses an access token)\n\nSteps:\n[] Validate input data (if validation fails, return an error)\n[] If a policy ID is provided:\n[]> Fetch the firewall policy's JSON\n[] If policy JSON is provided, extract the policy ID\n[] Prepare the updated policy JSON\n[] If no updates are required, end the workflow\n[] Update the firewall policy\n[] Check if the request was successful:\n[]> If it was, set the output variables\n[]> If it wasn't, return an error\n\nMore information about this API: https://fndn.fortinet.net/index.php?/fortiapi/1-fortios/1018/1/firewall/",
		"display_name": "Fortinet - FortiGate - Update Firewall Policy",
		"runtime_user": {
		  "target_default": true
		},
		"target": {
		  "target_type": "web-service.endpoint",
		  "specify_on_workflow_start": true
		}
	  },
	  "object_type": "definition_workflow",
	  "actions": [
		{
		  "unique_name": "definition_activity_01QO29DXWEI0F2EFXjbGNWB0oOSzYzPCnw2",
		  "name": "Execute Python Script",
		  "title": "Validate input data",
		  "type": "python3.script",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": false,
			"display_name": "Validate input data",
			"script": "from sys import argv\nerror = None\npolicy_id, policy_json = argv[1:3]\nsrcaddr, dstaddr, webfilter = argv[3:6]\nif not (policy_id or policy_json):\n  error = \"A policy JSON or ID is required to put an update\"\nif not (srcaddr or dstaddr or webfilter):\n  error = \"A Destination Address, Source Address or Web Filter is required to put an update.\"",
			"script_arguments": [
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB$"
			],
			"script_queries": [
			  {
				"script_query": "error",
				"script_query_name": "Error",
				"script_query_type": "string"
			  }
			],
			"skip_execution": false
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01QNX6V261A2H0Y1IclkdsM1idCd5GU1fB2",
		  "name": "Condition Block",
		  "title": "Input data valid?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Input data valid?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01QNX6V6MGBF44EWPVDs6hfpsy3VPejgEOB",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01QO29DXWEI0F2EFXjbGNWB0oOSzYzPCnw2.output.script_queries.Error$",
				  "operator": "ne",
				  "right_operand": "None"
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QNX6V8SW1HG5fJ5v1gJ0iphb3grAu66q3",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "Input validation for the firewall policy update failed:\n$activity.definition_activity_01QO29DXWEI0F2EFXjbGNWB0oOSzYzPCnw2.output.script_queries.Error$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01QNX6VD9Y4F21bDxqqOLeBfygVEYh70TTG",
		  "name": "Condition Block",
		  "title": "Was policy JSON or ID provided?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was policy JSON or ID provided?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01QNX6VHIKG772dNfNgPjtGQWYnTFKiT5O7",
			  "name": "Condition Branch",
			  "title": "Policy ID",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC$",
				  "operator": "ne",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": "Policy ID",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QNX6VJJ7GLG3AUamy2bBaDbA4Yq3a2PZH",
				  "name": "HTTP Request",
				  "title": "Fetch full policy",
				  "type": "web-service.http_request",
				  "base_type": "activity",
				  "properties": {
					"accept": "application/json",
					"action_timeout": 180,
					"allow_auto_redirect": true,
					"continue_on_error_status_code": true,
					"continue_on_failure": false,
					"display_name": "Fetch full policy",
					"method": "GET",
					"relative_url": "/v2/cmdb/firewall/policy/$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC$/?access_token=$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25$&vdom=$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK$",
					"runtime_user": {
					  "target_default": true
					},
					"skip_execution": false,
					"target": {
					  "use_workflow_target": true
					}
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01QNX6VNZCJ7M10dw0oKStdYy0NPAbhvxtt",
				  "name": "Condition Block",
				  "title": "Was the request successful?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Was the request successful?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01QNX6VZ845DE0zw27zeSCvg9PyA2osHei0",
					  "name": "Condition Branch",
					  "title": "No",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$activity.definition_activity_01QNX6VJJ7GLG3AUamy2bBaDbA4Yq3a2PZH.output.status_code$",
						  "operator": "ne",
						  "right_operand": 200
						},
						"continue_on_failure": false,
						"display_name": "No",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01QNX6W1G6VON04N3dBu1qOFFvd3ahMIPRi",
						  "name": "Completed",
						  "title": "Failed",
						  "type": "logic.completed",
						  "base_type": "activity",
						  "properties": {
							"completion_type": "failed-completed",
							"continue_on_failure": false,
							"display_name": "Failed",
							"result_message": "Failed to fetch the firewall policy JSON\n\nStatus code: $activity.definition_activity_01QNX6VJJ7GLG3AUamy2bBaDbA4Yq3a2PZH.output.status_code$\nResponse body: $activity.definition_activity_01QNX6VJJ7GLG3AUamy2bBaDbA4Yq3a2PZH.output.response_body$",
							"skip_execution": false
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				},
				{
				  "unique_name": "definition_activity_01QNX6W5ZUGD35KRSLnZDppm8I0ELMPrIvv",
				  "name": "Set Variables",
				  "title": "Update policy JSON variable",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Update policy JSON variable",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC$",
						"variable_value_new": "$activity.definition_activity_01QNX6VJJ7GLG3AUamy2bBaDbA4Yq3a2PZH.output.response_body$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01QNX6WAXA3NI25Ht4seiTdejQY8kTv3TwC",
			  "name": "Condition Branch",
			  "title": " Policy JSON",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC$",
				  "operator": "ne",
				  "right_operand": ""
				},
				"continue_on_failure": false,
				"display_name": " Policy JSON",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QNX6WCXPOZJ6kaf37OJv5lKk5sAQyQyNQ",
				  "name": "JSONPath Query",
				  "title": "Extract policy ID",
				  "type": "corejava.jsonpathquery",
				  "base_type": "activity",
				  "properties": {
					"action_timeout": 180,
					"continue_on_failure": true,
					"display_name": "Extract policy ID",
					"input_json": "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC$",
					"jsonpath_queries": [
					  {
						"jsonpath_query": "$.results[0].policyid",
						"jsonpath_query_name": "Policy ID",
						"jsonpath_query_type": "string"
					  }
					],
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				},
				{
				  "unique_name": "definition_activity_01QNX6WHH0X9O28RHGcmKGwL4tio2U1tFQX",
				  "name": "Condition Block",
				  "title": "Extraction succeeded?",
				  "type": "logic.if_else",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Extraction succeeded?",
					"skip_execution": false
				  },
				  "object_type": "definition_activity",
				  "blocks": [
					{
					  "unique_name": "definition_activity_01QNX6WMITOL52SwwVvZDA9UeriE8xXNBvT",
					  "name": "Condition Branch",
					  "title": "No",
					  "type": "logic.condition_block",
					  "base_type": "activity",
					  "properties": {
						"condition": {
						  "left_operand": "$activity.definition_activity_01QNX6WCXPOZJ6kaf37OJv5lKk5sAQyQyNQ.output.succeeded$",
						  "operator": "eq",
						  "right_operand": false
						},
						"continue_on_failure": false,
						"display_name": "No",
						"skip_execution": false
					  },
					  "object_type": "definition_activity",
					  "actions": [
						{
						  "unique_name": "definition_activity_01QNX6WP0OAC15Tkrtaq5QNDg7t5qtxifqM",
						  "name": "Completed",
						  "title": "Failed",
						  "type": "logic.completed",
						  "base_type": "activity",
						  "properties": {
							"completion_type": "failed-completed",
							"continue_on_failure": false,
							"display_name": "Failed",
							"result_message": "Failed to extract policy ID from JSON provided",
							"skip_execution": false
						  },
						  "object_type": "definition_activity"
						}
					  ]
					}
				  ]
				},
				{
				  "unique_name": "definition_activity_01QNX6WTLVIOS08EGbTLWMTQ7ylQaYnqKHv",
				  "name": "Set Variables",
				  "title": "Update policy ID variable",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Update policy ID variable",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC$",
						"variable_value_new": "$activity.definition_activity_01QNX6WCXPOZJ6kaf37OJv5lKk5sAQyQyNQ.output.jsonpath_queries.Policy ID$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01QNX6WYNTGV42A6sym6cdQDdcPfY2048kR",
		  "name": "Execute Python Script",
		  "title": "Prepare policy update",
		  "type": "python3.script",
		  "base_type": "activity",
		  "properties": {
			"action_timeout": 180,
			"continue_on_failure": true,
			"display_name": "Prepare policy update",
			"script": "import json\nfrom sys import argv\n\n\npolicy = json.loads(argv[1])[\"results\"][0]\nsrcaddr, dstaddr, webfilter, service, action = argv[2:7]\nput_body = {}\n\ndef is_object_in_policy(obj_type, obj):\n    return any(d['name'] == obj for d in policy[obj_type])\n\nif action:\n    put_body[\"action\"] = action.lower() \n\nif srcaddr and not is_object_in_policy(\"srcaddr\", srcaddr):\n    policy[\"srcaddr\"].append({\"name\": srcaddr})\n    put_body[\"srcaddr\"] = policy[\"srcaddr\"]\n\nif dstaddr and not is_object_in_policy(\"dstaddr\", dstaddr):\n    policy[\"dstaddr\"].append({\"name\": dstaddr})\n    put_body[\"dstaddr\"] = policy[\"dstaddr\"]\n\nif service and not is_object_in_policy(\"service\", service):\n    policy[\"service\"].append({\"name\": service})\n    put_body[\"service\"] = policy[\"service\"]\n\nif webfilter:\n    updates = {\n        \"webfilter-profile\": {\n            \"q_origin_key\": webfilter\n        },\n        \"ssl-ssh-profile\": {\n            \"q_origin_key\": \"certificate-inspection\"\n        },\n        \"utm-status\": \"enable\"\n    }\n    put_body.update(updates)\nput_body = json.dumps(put_body)",
			"script_arguments": [
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01SOKQ5CWNBD70J1ywhGt6lYQlQmK7KVnDX$",
			  "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01SOKPX0NFW0L464aL9t0vEyBowlnCQjman$"
			],
			"script_queries": [
			  {
				"script_query": "put_body",
				"script_query_name": "PUT Body",
				"script_query_type": "string"
			  }
			],
			"skip_execution": false
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01QO0ALMK62FS7efpivlIziNP9AqNlXNPKG",
		  "name": "Condition Block",
		  "title": "Are updates required?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Are updates required?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01QO0ALSYC4J56cGMmAK4xNC9P6YQCZJhTf",
			  "name": "Condition Branch",
			  "title": "No",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01QNX6WYNTGV42A6sym6cdQDdcPfY2048kR.output.script_queries.PUT Body$",
				  "operator": "eq",
				  "right_operand": "{}"
				},
				"continue_on_failure": false,
				"display_name": "No",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QO0BAE9IYKR129CGyT0DEBccFxG01D0sy",
				  "name": "Completed",
				  "title": "Succeeded",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "succeeded",
					"continue_on_failure": false,
					"display_name": "Succeeded",
					"result_message": "Policy already contains given objects",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		},
		{
		  "unique_name": "definition_activity_01QNX6XEBJ5ML5CFLCru8HoOTsveZMWeePq",
		  "name": "HTTP Request",
		  "title": "Request policy update",
		  "type": "web-service.http_request",
		  "base_type": "activity",
		  "properties": {
			"accept": "application/json",
			"action_timeout": 180,
			"allow_auto_redirect": true,
			"body": "$activity.definition_activity_01QNX6WYNTGV42A6sym6cdQDdcPfY2048kR.output.script_queries.PUT Body$",
			"content_type": "application/json",
			"continue_on_error_status_code": true,
			"continue_on_failure": false,
			"display_name": "Request policy update",
			"method": "PUT",
			"relative_url": "/v2/cmdb/firewall/policy/$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC$/?access_token=$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25$&vdom=$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.input.variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK$",
			"runtime_user": {
			  "target_default": true
			},
			"skip_execution": false,
			"target": {
			  "use_workflow_target": true
			}
		  },
		  "object_type": "definition_activity"
		},
		{
		  "unique_name": "definition_activity_01QNX6XJ6EA2Z0RGij53YW9xW81wCb8KSGJ",
		  "name": "Condition Block",
		  "title": "Was the request successful?",
		  "type": "logic.if_else",
		  "base_type": "activity",
		  "properties": {
			"continue_on_failure": false,
			"display_name": "Was the request successful?",
			"skip_execution": false
		  },
		  "object_type": "definition_activity",
		  "blocks": [
			{
			  "unique_name": "definition_activity_01QNX6XU53BSN0aFndM6pITei0Lwy56j71j",
			  "name": "Condition Branch",
			  "title": "200/Success",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01QNX6XEBJ5ML5CFLCru8HoOTsveZMWeePq.output.status_code$",
				  "operator": "eq",
				  "right_operand": 200
				},
				"continue_on_failure": false,
				"display_name": "200/Success",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01QNX6Y0Y9N7N09AHuTOTzIjqVnj5ZXRj7P",
				  "name": "Set Variables",
				  "title": "Set output variable",
				  "type": "core.set_multiple_variables",
				  "base_type": "activity",
				  "properties": {
					"continue_on_failure": false,
					"display_name": "Set output variable",
					"skip_execution": false,
					"variables_to_update": [
					  {
						"variable_to_update": "$workflow.definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO.output.variable_workflow_01QNX6UNA0Y233D5aY7DqEsToofrpirMWyD$",
						"variable_value_new": "$activity.definition_activity_01QNX6XEBJ5ML5CFLCru8HoOTsveZMWeePq.output.response_body$"
					  }
					]
				  },
				  "object_type": "definition_activity"
				}
			  ]
			},
			{
			  "unique_name": "definition_activity_01RVKEHIBCRK549Gv3WYcfTuDRNyEKugms5",
			  "name": "Condition Branch",
			  "title": "Anything else",
			  "type": "logic.condition_block",
			  "base_type": "activity",
			  "properties": {
				"condition": {
				  "left_operand": "$activity.definition_activity_01QNX6XEBJ5ML5CFLCru8HoOTsveZMWeePq.output.status_code$",
				  "operator": "ne",
				  "right_operand": 200
				},
				"continue_on_failure": false,
				"display_name": "Anything else",
				"skip_execution": false
			  },
			  "object_type": "definition_activity",
			  "actions": [
				{
				  "unique_name": "definition_activity_01RVKEHIBDBXC43w2Cait9k6VqvlO398Jy1",
				  "name": "Completed",
				  "title": "Failed",
				  "type": "logic.completed",
				  "base_type": "activity",
				  "properties": {
					"completion_type": "failed-completed",
					"continue_on_failure": false,
					"display_name": "Failed",
					"result_message": "Firewall policy update failed\n\nStatus code: $activity.definition_activity_01QNX6XEBJ5ML5CFLCru8HoOTsveZMWeePq.output.status_code$\nResponse body: $activity.definition_activity_01QNX6XEBJ5ML5CFLCru8HoOTsveZMWeePq.output.response_body$",
					"skip_execution": false
				  },
				  "object_type": "definition_activity"
				}
			  ]
			}
		  ]
		}
	  ],
	  "categories": [
		"category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
	  ]
	}
  }